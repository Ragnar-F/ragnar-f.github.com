<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>SoundSet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>SoundSet</h1>

<p>Ändert diverse Einstellungen eines Audiogeräts (Stummschalten, Gesamtlautstärke usw.)</p>

<pre class="Syntax">SoundSet, Einstellung [, Komponententyp, Kontrolltyp, Gerätenummer]</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td width="15%">Einstellung</td>
    <td width="85%"><p>Eine Prozentzahl zwischen -100 und 100 (kann auch eine Fließkommazahl oder ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein). Wenn die Zahl mit einem Plus- oder Minuszeichen beginnt, dann wird die <strong>aktuelle Einstellung</strong> mit der angegebenen Menge nach oben oder nach unten reguliert. Andernfalls wird die <em>Einstellung</em> direkt gesetzt.</p>
      <p>Bei <em>Kontrolltypen</em> mit nur zwei möglichen Einstellungen (nämlich ONOFF, MUTE, MONO, LOUDNESS, STEREOENH und BASSBOOST) wird die Einstellung mit einer positiven Zahl aktiviert und mit einer Null deaktiviert. Wenn die Zahl allerdings mit einem Plus- oder Minuszeichen beginnt, dann wird die Einstellung umgeschaltet (jeweils auf dem entgegengesetzten Zustand).</p></td>
  </tr>
  <tr>
    <td>Komponententyp</td>
    <td><p>Wenn leer oder nicht vorhanden, dann wird standardmäßig das Wort ERROR verwendet. Ansonsten ist es ein folgendes Wort: MASTER (gleichbedeutend mit SPEAKERS), DIGITAL, LINE, MICROPHONE, SYNTH, CD, TELEPHONE, PCSPEAKER, WAVE, AUX, ANALOG, HEADPHONES oder N/A. Wenn das Audiogerät den angegebenen <em>Komponententyp</em> nicht hat, dann kennzeichnet ErrorLevel das Problem.</p>
      <p>Die Komponente mit der Bezeichnung Auxiliary kann in einigen Mixern nur mit ANALOG und nicht mit AUX aufgerufen werden.</p>
    <p>Wenn ein Gerät mehrere Instanzen vom <em>Komponententyp</em> hat (zum Beispiel zwei vom Typ LINE), dann enthält der erste Typ normalerweise die Wiedergabeeinstellungen und der zweite Typ die Aufnahmeeinstellungen. Um auf eine Instanz außer der Ersten zuzugreifen, fügt dem Parameter einen Doppelpunkt und eine Nummer an. Zum Beispiel: Analog:2 ist die zweite Instanz der analogen Komponente.</p></td>
  </tr>
  <tr>
    <td>Kontrolltyp</td>
    <td>Wenn leer oder nicht vorhanden, dann wird standardmäßig das Wort VOLUME verwendet. Ansonsten ist es ein folgendes Wort: VOLUME (oder VOL), ONOFF, MUTE, MONO, LOUDNESS, STEREOENH, BASSBOOST, PAN, QSOUNDPAN, BASS, TREBLE, EQUALIZER oder die Nummer eines gültigen Kontrolltyps (siehe <a href="#Ex">Soundkartenanalyse-Script</a>). Wenn der <em>Komponententyp</em> den angegebenen <em>Kontrolltyp</em> nicht hat, dann kennzeichnet ErrorLevel das Problem.</td>
  </tr>
  <tr>
    <td>Gerätenummer</td>
    <td>Wenn dieser Parameter weggelassen wird, dann standardmäßig eine 1 (das erste Audiogerät), welches in der Regel das Standardgerät für die Aufnahme und Wiedergabe ist. Verwendet eine Zahl größer als 1, um ein anderes Audiogerät zu bearbeiten. Dieser Parameter kann ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein.</td>
  </tr>
</table>
<h3>ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 0 gesetzt, wenn der Befehl erfolgreich war. Ansonsten enthält ErrorLevel einen folgenden Satz:</p>
<table class="info" style="width:436px">
  <tr>
    <td width="426">Invalid Control Type or Component Type (ungültiger Kontrolltyp oder Komponententyp)</td>
  </tr>
  <tr>
    <td>Can't Open Specified Mixer (der angegebene Mixer konnte nicht geöffnet werden)</td>
  </tr>
  <tr>
    <td>Mixer Doesn't Support This Component Type (der Mixer unterstützt nicht diesen Komponententyp)</td>
  </tr>
  <tr>
    <td>Mixer Doesn't Have That Many of That Component Type (der Mixer hat nicht so viele Komponententypen)</td>
  </tr>
  <tr>
    <td>Component Doesn't Support This Control Type (die Komponente unterstützt nicht diesen Kontrolltyp)</td>
  </tr>
  <tr>
    <td>Can't Get Current Setting (aktuelle Einstellung konnte nicht ermittelt werden)</td>
  </tr>
  <tr>
    <td>Can't Change Setting (aktuelle Einstellung konnte nicht geändert werden)</td>
  </tr>
</table>
<h3>Bemerkungen</h3>
<p>In Windows Vista oder höher beeinflussen SoundSet und SoundGet nur das Script selbst (das kann in einer zukünftigen Version behoben werden). Es gibt mindestens zwei Übergangslösungen:</p>
<p>1) die Kompatibilitätseinstellung der Datei "AutoHotkey.exe" (oder des <a href="../Scripts.htm#ahk2exe">kompilierte Scripts</a>) auf "Windows XP" setzen.</p>
<p>2) Tastatureingaben senden, die die Lautstärke regeln können, um die Gesamtlautstärke des Systems zu ändern. Zum Beispiel:</p>
<pre>Send {Volume_Up}  <em>; Erhöht die Gesamtlautstärke um 1 Stufe (normalerweise 5%).</em>
Send {Volume_Down 3}  <em>; Verringert die Gesamtlautstärke um 3 Stufen.</em>
Send {Volume_Mute}  <em>; Gesamtlautstärke stumm schalten bzw. Stummschaltung aufheben.</em></pre>
<p>Um die Einsatzmöglichkeiten des installierten Audiogeräts (Mixer) festzustellen (z. B. verfügbare Komponenten- und Kontrolltypen), führt das <a href="#Ex">Soundkartenanalyse-Script</a> aus.</p>
<p>Wenn SoundSet die Lautstärke eines Komponenten ändert, dann werden alle Kanäle der Komponente (z.B: links und rechts) auf die gleiche Stufe gesetzt. Mit anderen Worten geht jede außermittig eingestellte "Balance" verloren. Das kann bei WAVE-Komponenten verhindert werden, wenn stattdessen mit <a href="SoundSetWaveVolume.htm">SoundSetWaveVolume</a> die Lautstärke geändert wird, um die vorhandene Balance zu bewahren.</p>
<p>Verwendet <a href="SoundGet.htm">SoundGet</a>, um den aktuellen Wert einer Einstellung zu abzurufen.</p>
<h3>Verwandte Befehle</h3>
<p><a href="SoundGet.htm">SoundGet</a>, <a href="SoundGetWaveVolume.htm">SoundGetWaveVolume</a>, <a href="SoundSetWaveVolume.htm">SoundSetWaveVolume</a>, <a href="SoundPlay.htm">SoundPlay</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent"><em>; EINFACHE BEISPIELE:</em>
SoundSet, 50  <em>; Setzt die Gesamtlautstärke auf 50%</em>
SoundSet +10  <em>; Erhöht die Gesamtlautstärke um10%</em>
SoundSet -10  <em>; Verringert die Gesamtlautstärke um 10%</em>
SoundSet, 1, Microphone, mute  <em>; Schaltet das Mikrofon auf stumm.</em>
SoundSet, +1, , mute  <em>; Stummschaltung umschalten (auf dem entgegengesetzten Zustand setzen)</em>
SoundSet, +20, Master, bass  <em>; Erhöht den Bass um 20%.</em>
If ErrorLevel
    MsgBox, Die BASS-Einstellung wird nicht für MASTER unterstützt.</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><a name="Ex"></a><em>; SOUNDKARTENANALYSE
; Mit dem folgenden Script können die Einsatzmöglichkeiten der Soundkarte festgestellt werden (Komponententypen und Kontrolltypen).
; Es zeigt die Ergebnisse in einem einfachen ListView.</em>

SetBatchLines -1
SplashTextOn,,, Informationen der Soundkarte ermitteln ...

<em>; Die meisten reinen Zahlen unten existieren wahrscheinlich in keinem Mixer, werden aber der Vollständigkeit halber abgefragt.
; Die Zahlen entsprechen den folgenden Elementen (in Reihenfolge): CUSTOM, BOOLEANMETER, SIGNEDMETER, PEAKMETER,
; UNSIGNEDMETER, BOOLEAN, BUTTON, DECIBELS, SIGNED, UNSIGNED, PERCENT, SLIDER, FADER, SINGLESELECT, MUX,
; MULTIPLESELECT, MIXER, MICROTIME, MILLITIME</em>
Kontrolltypen = VOLUME,ONOFF,MUTE,MONO,LOUDNESS,STEREOENH,BASSBOOST,PAN,QSOUNDPAN,BASS,TREBLE,EQUALIZER,0x00000000, 0x10010000,0x10020000,0x10020001,0x10030000,0x20010000,0x21010000,0x30040000,0x30020000,0x30030000,0x30050000,0x40020000,0x50030000,0x70010000,0x70010001,0x71010000,0x71010001,0x60030000,0x61030000

Komponententypen = MASTER,HEADPHONES,DIGITAL,LINE,MICROPHONE,SYNTH,CD,TELEPHONE,PCSPEAKER,WAVE,AUX,ANALOG,N/A

<em>; Erstellt eine ListView und bereitet sie auf die Hauptschleife vor:</em>
Gui, Add, Listview, w400 h400 vEigenesListView, Komponententyp|Kontrolltyp|Einstellung|Mixer
LV_ModifyCol(4, "Integer")
SetFormat, Float, 0.2  <em>; Begrenzt die maximale Anzahl an Dezimalstellen eines Prozentwertes auf 2.</em>

Loop  <em>; Für jede vorhandene Mixernummer im System die Einsatzmöglichkeiten abfragen.</em>
{
    Mixer := A_Index
    SoundGet, Einstellung,,, %Mixer%
    If ErrorLevel = Can't Open Specified Mixer  <em>; Jeder anderer Fehler kennzeichnet den Mixer als Vorhanden.</em>
        break

    <em>; Für jeden Komponententyp im Mixer die Instanzen und Kontrolltypen abfragen:</em>
    Loop, parse, Komponententypen, `,
    {
        Komponente := A_LoopField
        <em>; Zuerst überprüfen, ob dieser Komponententyp auch im Mixer vorhanden ist:</em>
        SoundGet, Einstellung, %Komponente%,, %Mixer%
        If ErrorLevel = Mixer Doesn't Support This Component Type
            continue  <em>; Eine neue Iteration starten, um auf den nächsten Komponententyp zu kommen.</em>
        Loop  <em>; Für jede Instanz des Komponententyps die Kontrolltypen abfragen.</em>
        {
            Instanz := A_Index
            <em>; Zuerst überprüfen, ob diese Instanz der Instanz auch im Mixer vorhanden ist:</em>
            SoundGet, Einstellung, %Komponente%:%Instanz%,, %Mixer%
            <em>; Beide auf folgende Fehler überprüfen, damit dieses Script auf ältere Betriebssysteme läuft:</em>
            If ErrorLevel in Mixer Doesn't Have That Many of That Component Type,Invalid Control Type or Component Type
                break  <em>; Keine weiteren Instanzen des Komponententyps.</em>
            <em>; Ermittelt die aktuelle Einstellung von jedem Kontrolltyp, der in der Instanz der Komponente vorhanden ist:</em>
            Loop, parse, Kontrolltypen, `,
            {
                Kontrolle := A_LoopField
                SoundGet, Einstellung, %Komponente%:%Instanz%, %Kontrolle%, %Mixer%
                <em>; Beide auf folgende Fehler überprüfen, damit dieses Script auf ältere Betriebssysteme läuft:</em>
                If ErrorLevel in Component Doesn't Support This Control Type,Invalid Control Type or Component Type
                    continue
                If ErrorLevel  <em>; Irgendein unerwarteter Fehler, der in den Ergebnissen angezeigt wird.</em>
                    Einstellung := ErrorLevel
                Komponentenstring := Komponente
                If Instanz > 1
                    Komponentenstring = %Komponentenstring%:%Instanz%
                LV_Add("", Komponentenstring, Kontrolle, Einstellung, Mixer)
            }  <em>; Für jeden Kontrolltyp.</em>
        }  <em>; Für jede Komponenteninstanz.</em>
    }  <em>; Für jeden Komponententyp.</em>
}  <em>; Für jeden Mixer.</em>

Loop % LV_GetCount("Col")  <em>; Die Größe jeder Spalte automatisch anpassen, damit der Inhalt passt.</em>
    LV_ModifyCol(A_Index, "AutoHdr")

SplashTextOff
Gui, Show
Return

GuiClose:
ExitApp</pre>

</body>
</html>
