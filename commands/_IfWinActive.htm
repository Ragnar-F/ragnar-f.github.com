<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>#IfWinActive / #IfWinExist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>#IfWinActive / #IfWinExist</h1>

<p>Erstellt kontextabhängige <a href="../Hotkeys.htm">Hotkeys</a> und <a href="../Hotstrings.htm">Hotstrings</a>. Solche Hotkeys führen eine andere Aktion aus (oder gar keine), abhängig vom Typ des aktiven oder vorhandenen Fensters.</p>

<pre class="Syntax">#IfWinActive [, Fenstertitel, Fenstertext]
#IfWinExist [, Fenstertitel, Fenstertext]
#IfWinNotActive [, Fenstertitel, Fenstertext]
#IfWinNotExist [, Fenstertitel, Fenstertext]
<a href="_If.htm">#If [, Ausdruck]</a></pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td width="15%">Fenstertitel</td>
    <td width="85%">Der Titel oder Teiltitel des Fensters (das Übereinstimmungsverhalten wird mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> im <a href="../Scripts.htm#auto">automatischen Ausführungsbereich</a> bestimmt). Bei Verwendung einer Fensterklasse muss ahk_class ExakterKlassenname angegeben werden (wird von Windows Spy angezeigt). Bei Verwendung einer <a href="GroupAdd.htm">Fenstergruppe</a> muss ahk_group Gruppenname angegeben werden. Die Schlüsselwörter <a href="../LastFoundWindow.htm#id">"ahk_pid" und "ahk_id"</a> werden auch unterstützt, aber bei #IfWin normalerweise indirekt mit <a href="GroupAdd.htm">GroupAdd</a> (alternativ kann <a href="Hotkey.htm">"Hotkey IfWin"</a> verwendet werden). Die Suche kann durch Angabe <a href="../LastFoundWindow.htm#multi">mehrerer Kriterien</a> eingeschränkt werden. Zum Beispiel: <em>Eigene Datei.txt ahk_class Notepad</em></td>
  </tr>
  <tr>
    <td>Fenstertext</td>
    <td>Wenn vorhanden, dann muss dieser Parameter einen Teil der einzelnen Textelemente des Fensters enthalten (wird von Windows Spy angezeigt). Versteckte Textelemente werden erfasst, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</td>
  </tr>
  <tr>
    <td>Titelausnahme<br> Textausnahme</td>
    <td>Diese Parameter werden <strong>nicht</strong> unterstützt, können aber indirekt verwendet werden, wenn <em>ahk_group EigeneGruppe</em> im <em>Fenstertitel</em> angegeben ist (wobei die <em>EigeneGruppe</em> mit dem <a href="GroupAdd.htm">GroupAdd</a>-Befehl erstellt wird, der Titel- und Textausnahme unterstützt).</td>
  </tr>
</table>

<h3>Grundlagen zur Bedienung</h3>
<p>Mit #IfWin-Anweisungen können kontextabhängige <a href="../Hotkeys.htm">Hotkeys</a> und <a href="../Hotstrings.htm">Hotstrings</a> einfach erstellt werden. Zum Beispiel:</p>
<pre>#IfWinActive ahk_class Notepad
#space::MsgBox Win+Leerzeichen wurde im Editor gedrückt.</pre>
<p> Die #IfWin-Anweisungen sind von der Position abhängig; alle nachfolgende Hotkeys und Hotstrings im Script sind davon betroffen. Sie schließen sich auch gegenseitig aus, d. h. nur das aktuellste #IfWin ist aktiv.</p>
<p>Um die Kontextabhängigkeit zu deaktivieren, verwendet #IfWin ohne Parameter. Zum Beispiel:</p>
<pre>#IfWinActive</pre>
<p>Wenn #IfWin deaktiviert ist (oder nie im Script verwendet wird), dann werden alle <a href="../Hotkeys.htm">Hotkeys</a> und <a href="../Hotstrings.htm">Hotstrings</a> für alle Fenster aktiviert (solange sie nicht durch den <a href="Suspend.htm">Suspend</a>- oder <a href="Hotkey.htm">Hotkey</a>-Befehl deaktiviert sind).</p>
<p>Wenn ein Maus- oder Tastatur-Hotkey mit #IfWin deaktiviert ist, dann erfolgt die ursprüngliche Funktion; d. h. der Hotkey wird im aktiven Fenster ausgeführt, als gäbe es nicht so ein Hotkey. Es gibt zwei Ausnahmen: 1) Windows 95/98/Me: Das Drücken eines IfWin-deaktivierten Hotkeys hat kein Effekt (auch nicht mit der ursprünglichen Funktion); 2) Joystick-Hotkeys: obwohl #IfWin funktioniert, kann nicht verhindert werden, dass andere Programme das Drücken eines Joystick-Buttons beachten.</p>
<p>#IfWin kann auch verwendet werden, um das Verhalten einer gewöhnlichen Taste (z. B. Enter oder Leertaste) zu ändern. Besonders nützlich, wenn ein bestimmtes Fenster die Taste ignoriert oder unerwünschte Aktionen durchführt. Zum Beispiel:</p>
<pre>#IfWinActive Erinnerung ahk_class #32770  <em>; Das Erinnerungsfenster im Outlook.</em>
Enter::Send !o  <em>; Eine ausgewählte Erinnerung wird mit der Enter-Taste geöffnet, anstatt zu warten.</em>
#IfWinActive</pre>
<h3 id="variant">Hotkeyvarianten (-duplikate)</h3>
<p>Ein bestimmter <a href="../Hotkeys.htm">Hotkey</a> oder <a href="../Hotstrings.htm">Hotstring</a> kann mehr als einmal erstellt werden, wenn jede Definition verschiedene IfWin-Kriterien hat. Diese werden <em>Hotkey-Varianten</em> genannt. Zum Beispiel:</p>
<pre>#IfWinActive ahk_class Notepad
^!c::MsgBox Steuerung+Alt+C wurde im Editor gedrückt.
#IfWinActive ahk_class WordPadClass
^!c::MsgBox Steuerung+Alt+C wurde im WordPad gedrückt.
#IfWinActive
^!c::MsgBox Steuerung+Alt+C wurde in einem beliebigen Fenster gedrückt (außer Editor/WordPad).</pre>
<p>Wenn mehrere Varianten übereinstimmen, dann wird nur die oberste Variante im Script ausgeführt. Die Ausnahme macht die globale Variante (ohne #IfWin-Kriterien): Sie hat immer die niedrigste Priorität und wird nur ausgeführt, wenn keine andere Variante berechtigt ist (diese Ausnahme gilt nicht für <a href="../Hotstrings.htm">Hotstrings</a>).</p>
<p>Bei der Erstellung von Hotkeyduplikaten spielt die Reihenfolge der <a href="../Hotkeys.htm#Symbols">Modifikatoren</a> (z.B. ^!+#) keine Rolle. Zum Beispiel ist ^!c das gleiche wie !^c. Allerdings müssen die Tasten konsequent ausgeschrieben werden. Zum Beispiel ist <em>Esc</em> in diesem Fall nicht das gleiche wie <em>Escape</em>. Außerdem ist jeder Hotkey mit einem <a href="../Hotkeys.htm#wildcard">Platzhalter-Präfix (*)</a> vollständig von einem Hotkey ohne Platzhalter abgegrenzt; Zum Beispiel haben F1 und *F1 jeweils ihre eigenen Varianten.</p>
<p>Damit dieselbe Hotkey-Subroutine von mehreren Varianten ausgeführt wird, erstellt ganz einfach eine Reihe von identischen Hotkeys, jeweils mit einer anderen #IfWin-Anweisung darüber. Zum Beispiel:</p>
<pre>#IfWinActive ahk_class Notepad
#z::
#IfWinActive ahk_class WordPadClass
#z::
MsgBox Win+Z wurde entweder im Editor oder WordPad gedrückt.
Return</pre>
<p>Alternativ kann eine <a href="GroupAdd.htm">Fenstergruppe</a> mit <em>#IfWinActive ahk_group EigeneGruppe</em> verwendet werden.</p>
<p>Um Hotkey-Varianten dynamisch zu erstellen (während das Script ausgeführt wird), siehe <a href="Hotkey.htm#IfWin">"Hotkey IfWin"</a>.</p>
<h3 id="gen">Allgemeine Bemerkungen</h3>
<p>#IfWin stellt auch die ursprüngliche Funktion der Präfixtasten gegebenenfalls wieder her (eine <a href="../Hotkeys.htm#prefix">Präfixtaste</a> ist zum Beispiel die "a"-Taste im Hotkey "a & b"). Das passiert, sobald keine aktivierten Hotkeys für ein bestimmtes Präfix vorhanden sind.</p>
<p>Wenn mit Gosub oder Goto ein Hotkey- oder Hotstring-Label ausgeführt wird, dann wird die oberste Variante im Script verwendet.</p>
<p>Wenn ein Hotkey zurzeit mit #IfWin deaktiviert ist, dann erscheint die Taste oder Maustaste in der Type-Spalte von <a href="KeyHistory.htm">KeyHistory</a> mit einem "#"-Zeichen. Das kann helfen, ein Script zu debuggen.</p>
<p>Variablenverweise (z. B. %Var%) werden aktuell nicht unterstützt. Daher müssen Prozentzeichen mit einem <a href="_EscapeChar.htm">Schutzzeichen</a> vorangestellt werden (`%), damit sie zukünftig unterstützt werden. Direkt vorhandene Kommas müssen auch mit einem Schutzzeichen vorangestellt werden (`,), damit zusätzliche Parameter zukünftig hinzugefügt werden können. Als Übergangslösung können <a href="GroupAdd.htm">GroupAdd</a> und <a href="../LastFoundWindow.htm#group">ahk_group</a> verwendet werden.</p>
<p>Ein Label, dem ein Hotkey mit dem <a href="Hotkey.htm">Hotkey-Befehl</a> zugewiesen ist, wird nicht direkt von #IfWin beeinflusst. Stattdessen wird das oberste #IfWin im Script (falls vorhanden) für alle Hotkeys verwendet, die mit dem Hotkey-Befehl erstellt wurden (solange "<a href="Hotkey.htm#IfWin">Hotkey IfWin</a>" nicht verwendet wurde, um dies zu ändern).</p>
<p><a href="../Hotkeys.htm#alttab">Alt-Tab-Hotkeys</a> sind nicht von #IfWin betroffen: sie sind für alle Fenster gültig.</p>
<p>Das <a href="../LastFoundWindow.htm">zuletzt gefundene Fenster</a> wird von #IfWinActive/Exist gesetzt (aber nicht von IfWin<em>Not</em>Active/<em>Not</em>Exist). Zum Beispiel:</p>
<pre>#IfWinExist ahk_class Notepad
#n::WinActivate  <em>; Aktiviert das zuletzt gefundene Fenster.</em></pre>
<p>Die <a href="_EscapeChar.htm">Schutzsequenzen</a> `s und `t können verwenden werden, wenn führende oder nachfolgende Leerzeichen/Tabulatoren in einem Parameter von #IfWin benötigt werden.</p>
<p>Aus Performance-Gründen überwacht #IfWin nicht ständig die Aktivierung oder Existenz des angegebenen Fensters. Stattdessen werden übereinstimmende Fenster nur gesucht, wenn der Benutzer ein Hotkey oder Hotstring drückt. Wenn ein passendes Fenster nicht vorhanden ist, dann können Tastatur- oder Mauseingaben unverändert an das aktive Fenster übergeben werden (außer in Windows 95/98/Me).</p>
<p>Windows 95/98/Me: Wenn die erste Variante des Hotkeys ein $-Präfix hat, dann werden alle Varianten "sich selbstständig versenden". Damit wird die Möglichkeit bereitgestellt, dass ein Hotkey wenigstens seine ursprüngliche Funktion ausführen kann. Zum Beispiel:</p>
<pre>$^a::Send ^a  <em>; Die erste Variante muss ein $-Präfix haben, damit sie sich selbstständig in Windows 9x versenden kann.</em>
#IfWinActive ahk_class Notepad
^a::MsgBox Strg-A wurde gedrückt, während der Editor aktiv ist.</pre>
<p>Fenstertitel und -texte sind von der Groß- und Kleinschreibung abhängig. Versteckte Textelemente werden erfasst, wenn <a href="DetectHiddenWindows.htm">DetectHiddenText</a> aktiv ist.</p>
<h3>Verwandte Befehle</h3>
<p><a href="_If.htm">#If <i>Ausdruck</i></a>, <a href="Hotkey.htm">Hotkey-Befehl</a>, <a href="../Hotkeys.htm">Hotkeys</a>, <a href="../Hotstrings.htm">Hotstrings</a>, <a href="Suspend.htm">Suspend</a>, <a href="IfWinActive.htm">IfWinActive</a>, <a href="IfWinExist.htm">IfWinExist</a>, <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>, <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">#IfWinActive ahk_class Notepad
^!a::MsgBox Strg-Alt-A wurde während des aktiven Editors gedrückt.  <em>; Dieser Hotkey ist unwirksam, wenn er in einem anderen Fenster gedrückt wird (und wird "durchgegeben").</em>
#c::MsgBox Win+C wurde während des aktiven Editors gedrückt.
::btw::Dieser Ersatztext für "btw" erscheint nur im Editor.
#IfWinActive
#c::MsgBox Win+C wurde während des inaktiven Editors gedrückt.</pre>

</body>
</html>
