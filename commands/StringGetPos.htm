<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>StringGetPos</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>StringGetPos</h1>

<p>Ermittelt die Position des angegebenen Teilstrings in einem String.</p>

<pre class="Syntax">StringGetPos, Ausgabevariable, Eingabevariable, Suchtext [, L#|R#, Offset]
Position := <a href="../Functions.htm#InStr">InStr</a>(Heuhaufen, Nadel [, Zeichengenauigkeit, Startposition]) <em>; Siehe <a href="../Functions.htm#InStr">InStr()-Funktion</a> für Details.</em></pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td width="15%">Ausgabevariable</td>
    <td width="85%">Der Name der Variable, in der die ermittelte Position relativ zum ersten Zeichen der <em>Eingabevariable</em> gespeichert wird. Das erste Zeichen ist bei StringGetPos die Position 0 und bei <a href="../Functions.htm#InStr">InStr()</a> die Position.</td>
  </tr>
  <tr>
    <td>Eingabevariable</td>
    <td>Name der Variable, dessen Inhalt durchsucht wird. Umschließt den Namen erst mit Prozentzeichen, wenn der <em>Inhalt</em> der Variable als Name verwendet werden soll.</td>
  </tr>
  <tr>
    <td>Suchtext</td>
    <td>Text, der gesucht wird. Die Übereinstimmung ist erst von der Groß- bzw. Kleinschreibung abhängig, wenn <a href="StringCaseSense.htm">StringCaseSense</a> aktiv ist. </td>
  </tr>
  <tr>
    <td>L#|R#</td>
    <td><p>Damit wird beeinflusst, welches Vorkommen gefunden wird, wenn der <em>Suchtext</em> mehrmals in der <em>Eingabevariable</em> vorkommt. Wenn dieser Parameter weggelassen wird, dann beginnt die Suche für die erste Übereinstimmung in der <em>Eingabevariable</em> von links. Wenn dieser Parameter den Wert 1 oder den Buchstaben R enthält, dann beginnt die Suche in der <em>Eingabevariable</em> von rechts und wird dann nach links weitergeführt, bis die erste Übereinstimmung gefunden wird.</p>
      <p>Um eine beliebige Übereinstimmung zu finden, verwendet den Buchstaben L oder R, gefolgt von der Vorkommensnummer. Zum Beispiel wird mit r4 das vierte Vorkommen von rechts gefunden. Hinweis: Wenn die Nummer kleiner gleich 0 ist, dann wird keine Übereinstimmung gefunden.</p>    </td>
  </tr>
  <tr>
    <td>Offset</td>
    <td>Die Anzahl der Zeichen an der linken oder rechten Seite (abhängig vom vorherigen Parameter), die übersprungen werden. Wenn nicht vorhanden, dann standardmäßig eine 0. Mit dem folgenden Beispiel beginnt die Suche ab dem 10. Zeichen von links: StringGetPos, Ausgabevariable, Eingabevariable, abc, , 9. Dieser Parameter kann ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein.</td>
  </tr>
</table>

<h3>ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, wenn der angegebene <em>Suchtext</em> nicht in der <em>Eingabevariable</em> vorkommt, ansonsten auf 0.</p>
<h3>Bemerkungen</h3>
<p>Im Gegensatz zu <a href="StringMid.htm">StringMid</a> und <a href="../Functions.htm#InStr">InStr()</a> ist bei StringGetPos die Position 0 das erste Zeichen.</p>
<p>Die abgerufene Position bezieht sich immer auf das erste Zeichen der <em>Eingabevariable</em>, unabhängig davon, ob <em>L#|R#</em> und/oder <em>Offset</em> angegeben ist. Wenn zum Beispiel der String "abc" in 123abc789 gefunden wird, dann ist die gemeldete Position immer 3, unabhängig von der Methode, mit der der String gefunden wurde.</p>
<p>Wenn der angegebene <em>Suchtext</em> nicht in der <em>Eingabevariable</em> vorkommt, dann wird die <em>Ausgabevariable</em> auf -1 und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
<p>Verwendet <a href="SplitPath.htm">SplitPath</a>, um einen Dateipfad einfacher in Verzeichnis, Dateinamen und Erweiterung aufzuteilen.</p>
<p>Die internen Variablen <a href="../Variables.htm">A_Space</a> und <a href="../Variables.htm">A_Tab</a> enthalten jeweils ein einzelnes Leerzeichen und ein einzelnes Tabulator-Zeichen. Sie sind nützlich, um Leerzeichen und Tabulatoren einzeln oder am Anfang oder Ende des <em>Suchstrings</em> zu suchen.</p>
<h3>Verwandte Befehle</h3>
<p><a href="../Functions.htm#InStr">InStr()</a>, <a href="RegExMatch.htm">RegExMatch()</a>, <a href="IfInString.htm">IfInString</a>, <a href="IfIn.htm">If Variable in/contains Übereinstimmungsliste</a>, <a href="StringCaseSense.htm">StringCaseSense</a>, <a href="StringReplace.htm">StringReplace</a>, <a href="SplitPath.htm">SplitPath</a>, <a href="StringLeft.htm">StringLeft</a>, <a href="StringLeft.htm">StringRight</a>, <a href="StringMid.htm">StringMid</a>, <a href="StringTrimLeft.htm">StringTrimLeft</a>, <a href="StringTrimLeft.htm">StringTrimRight</a>, <a href="StringLen.htm">StringLen</a>, <a href="StringLower.htm">StringLower</a>, <a href="StringLower.htm">StringUpper</a>, <a href="IfIs.htm">If Variable is Typ</a> </p>
<p><br> <strong>Beispiele</strong></p>
<pre class="NoIndent">Heuhaufen = abcdefghijklmnopqrs
Nadel = def
StringGetPos, Pos, Heuhaufen, %Nadel%
If Pos >= 0
    MsgBox, Der String wurde auf Position %Pos% gefunden.</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; Beispiel #2:
; Teilt den vollständigen Pfadnamen einer Datei in einzelne Komponenten auf.
; Beachtet, dass die Verwendung von <a href="StringSplit.htm">StringSplit</a> oder einer <a href="LoopParse.htm">Parsing-Schleife</a> einfacher ist, daher dient das Folgende nur als Veranschaulichung.</em>
FileSelectFile, Datei, , , Dateinamen in einem tief verschachtelten Ordner auswählen:
If Datei <>
{
    StringLen, Pos_vorher, Datei
    Pos_vorher += 1 <em>; Setzt die Position auf das Zeichen, dass nach dem letzten Zeichen erfolgt.</em>
    Loop
    {
        <em>; Sucht von rechts nach dem N. Vorkommen:</em>
        <strong>StringGetPos</strong>, Pos, Datei, \, R%A_Index%
        If ErrorLevel
            break
        Länge := Pos_vorher - Pos - 1
        Pos_vorher := Pos
        Pos += 2  <em>; Für die Verwendung mit StringMid anpassen.</em>
        StringMid, Pfad_Komponente, Datei, %Pos%, %Länge%
        MsgBox Pfadkomponente #%a_index% (von rechts) ist:`n%Pfad_Komponente%
    }
}</pre>

</body>
</html>
