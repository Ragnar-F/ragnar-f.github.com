<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>StringSplit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>StringSplit</h1>

<p>Teilt einen String in mehrere Teilstrings (Array) mithilfe der angegebenen Trennzeichen auf.</p>

<pre class="Syntax">StringSplit, AusgabeArray, Eingabevariable [, Trennzeichen, ZeichenAuslassen]</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td>AusgabeArray</td>
    <td><p>Der Name des <a href="../misc/Arrays.htm">Arrays</a>, in dem jeder extrahierte Teilstring aus der <em>Eingabevariable</em> gespeichert wird. Wenn zum Beispiel EigenesArray angegeben wird, dann wird der Befehl die Anzahl der Teilstrings (0 wenn keine) in EigenesArray0 speichern, den ersten Teilstring in EigenesArray1, den Zweiten in EigenesArray2 und so weiter.</p>
    <p>Um einen globalen anstelle eines lokalen Arrays innerhalb einer <a href="../Functions.htm">Funktion</a> zu erstellen, <a href="../Functions.htm#Global">deklariert</a> EigenesArray0 als globale Variable, bevor dieser Befehl verwendet wird (Das Gegenteil davon gilt für <a href="../Functions.htm#AssumeGlobal">global-angesehene</a> Funktionen).</p></td>
  </tr>
  <tr>
    <td width="15%">Eingabevariable</td>
    <td width="85%">Name der Variable, dessen Inhalt analysiert wird.  Umschließt den Namen erst mit Prozentzeichen, wenn der <em>Inhalt</em> der Variable als Name verwendet werden soll. HINWEIS: Die <em>Eingabevariable</em> darf keine Variable vom <em>AusgabeArray</em> sein.</td>
  </tr>
  <tr>
    <td>Trennzeichen</td>
    <td><p>Wenn leer oder nicht vorhanden, dann wird jedes Zeichen in der <em>Eingabevariable</em> als Teilstring angesehen.</p>
      <p>Andernfalls enthält das <em>Trennzeichen</em> beliebig viele Zeichen (abhängig von Groß- und Kleinschreibung), die als Abgrenzungen zwischen den Teilstrings in der <em>Eingabevariable</em> dienen. Da die Trennzeichen nicht zu den Teilstrings gehören, werden sie nie ins <em>AusgabeArray</em> kopiert. Wenn darüber hinaus nichts zwischen einem Paar von Trennzeichen innerhalb der <em>Eingabevariable</em> liegt, dann ist das entsprechende Array-Element leer.</p>
      <p>Zum Beispiel: Mit `, (ein geschütztes Komma) wird der String jeweils bei einem Komma geteilt. Mit %A_Tab%%A_Space% wird jeweils ein neues Array-Element erstellt, wenn sich Leer- oder Tab-Zeichen in der <em>Eingabevariable</em> befinden.</p>
      <p>Um ein String als Trennung zu verwenden, benutzt zuerst <a href="StringReplace.htm">StringReplace</a>, um alle Vorkommnisse des Strings mit einem Zeichen zu ersetzen, welches nie direkt im Text gebraucht wird. Ein Beispiel, das den String <br> als Trennung verwendet:</p>
<pre>StringReplace, NeueHTML, HTMLString, <br>, ``, All  <em>; Ersetzt jedes <br> mit einem Akzent.</em>
StringSplit, EigenesArray, NeueHTML, ``  <em>; Teilt den String, basierend auf dem Akzentbuchstaben.</em></pre></td>
  </tr>
  <tr>
    <td>ZeichenAuslassen</td>
    <td><p>Eine optionale Liste von Zeichen (abhängig von Groß- und Kleinschreibung), die am Anfang und Ende jedes Array-Elements ausgeschlossen werden. Wenn <em>ZeichenAuslassen</em> zum Beispiel %A_Space%%A_Tab% enthält, dann werden Leer- oder Tabulatorzeichen am Anfang und Ende (aber nicht in der Mitte) jeden Elements entfernt.</p>
    <p>Wenn das <em>Trennzeichen</em> leer ist, dann wird mit <em>ZeichenAuslassen</em> gekennzeichnet, welche Zeichen im Array ausgelassen werden.</p>
    <p>Im Gegensatz zum letzten Parameter der meisten anderen Befehle müssen Kommas in <em>ZeichenAuslassen</em> geschützt werden (`,).</p></td>
  </tr>
</table>

<h3>Bemerkungen</h3>
<p>Wenn die Array-Elemente bereits vorhanden sind, dann wird der Befehl die Werte der ersten N Elemente ändern, wobei N die Anzahl der Teilstrings in der <em>Eingabevariable</em> ist. Alle Elemente über N, die schon vorhanden sind, bleiben unverändert. Daher ist es am sichersten, das 0-Element (EigenesArray0) zu verwenden, um festzustellen, wie viele Elemente tatsächlich mit diesem Befehl erstellt wurden.</p>
<p>Unsichtbare Zeichen wie Leerzeichen und Tabulatoren werden nur beibehalten, wenn sie selbst keine Trennzeichen sind. Tabulatoren und Leerzeichen können an beiden Enden jeder Variable entfernt werden, indem sie sich selbst zuweisen, während <a href="AutoTrim.htm">AutoTrim</a> aktiv ist (Standardeinstellung). Zum Beispiel: EigenesArray1 = %EigenesArray1%</p>
<p>Um einen String im CSV-Format (kommagetrennten Werte) aufzuteilen, verwendet eine <a href="LoopParse.htm">Parsing-Schleife</a>, da sie über eine interne CSV-Handhabung verfügt.</p>
<p>Um die Felder vor dem Aufteilen neu anzuordnen, verwendet den Befehl <a href="Sort.htm">Sort</a>.</p>
<p>Wenn es unnötig ist, Teilstrings dauerhaft im Speicher abzulegen, zieht eine <a href="LoopParse.htm">Parsing-Schleife</a> in Betracht, besonders wenn die <em>Eingabevariable</em> sehr groß ist, um viel Speicherplatz zu sparen. Zum Beispiel:</p>
<pre>Farben = rot,grün,blau
Loop, parse, Farben, `,
    MsgBox Farbnummer %A_Index% ist %A_LoopField%.</pre>
<h3>Verwandte Befehle</h3>
<p><a href="LoopParse.htm">Parsing-Schleife</a>, <a href="../misc/Arrays.htm">Arrays</a>, <a href="Sort.htm">Sort</a>, <a href="SplitPath.htm">SplitPath</a>, <a href="IfInString.htm">IfInString</a>, <a href="StringGetPos.htm">StringGetPos</a>, <a href="StringMid.htm">StringMid</a>, <a href="StringTrimLeft.htm">StringTrimLeft</a>, <a href="StringTrimLeft.htm">StringTrimRight</a>, <a href="StringLen.htm">StringLen</a>, <a href="StringLower.htm">StringLower</a>, <a href="StringLower.htm">StringUpper</a>, <a href="StringReplace.htm">StringReplace</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">TestString = Das ist ein Test.
StringSplit, WörterArray, TestString, %A_Space%, .  <em>; Punkte weglassen.</em>
MsgBox, Das vierte Wort ist %WörterArray4%.

Farben = rot,grün,blau
StringSplit, FarbArray, Farben, `,
Loop, %FarbArray0%
{
    Farbe := FarbArray%a_index%
    MsgBox, Farbnummer %a_index% ist %Farbe%.
}</pre>

</body>
</html>
