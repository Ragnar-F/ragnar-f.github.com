<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MsgBox</title>
<meta name="description" content="Display MsgBox windows easily in this free scripting language. You can also create custom data entry forms, user interfaces, and menu bars.">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>MsgBox</h1>

<p>Zeigt den angegebenen Text in einem kleinen Fenster mit beliebig vielen Schaltflächen (z. B. Ja und Nein).</p>

<pre class="Syntax">MsgBox, Text
MsgBox [, Optionen, Titel, Text, Zeitüberschreitung]</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td>Text</td>
    <td><p>Wenn alle Parameter weggelassen werden, dann wird in der MsgBox "Press OK to continue." angezeigt. Andernfalls wird in diesem Parameter der Text des Hinweisfensters angegeben, um den Benutzer zu unterweisen oder Informationen zu präsentieren.</p>
    <p><a href="_EscapeChar.htm">Schutzsequenzen</a> können verwendet werden, um besondere Zeichen zu kennzeichnen. Mit `n beispielsweise wird ein LF-Zeichen gekennzeichnet, welches die aktuelle Zeile beendet und eine neue beginnt. Daher wird zum Beispiel mit text1`n`ntext2 eine leere Zeile zwischen Text1 und Text2 erstellt.</p>
    <p>Wenn <em>Text</em> lang ist, dann kann er in mehreren kurzen Zeilen aufgeteilt werden (<a href="../Scripts.htm#continuation">Fortsetzungsbereich</a>), die die Lesbarkeit und Wartbarkeit verbessern könnten.</p></td>
  </tr>
  <tr>
    <td>Optionen</td>
    <td><p>Bestimmt den Typ des Hinweisfensters und die möglichen Schaltflächenkombinationen.&nbsp; Wenn leer oder nicht vorhanden, dann standardmäßig eine 0. Siehe nachstehende Tabelle für die zulässigen Werte.</p>
    <p>Dieser Parameter wird nicht anerkannt, wenn ein Ausdruck oder eine Variablenreferenz wie %option% enthalten ist. Verwendet stattdessen einen direkt vorhandenen numerischen Wert. </p></td>
  </tr>
  <tr>
    <td>Titel</td>
    <td>Der Titel des Hinweisfensters. Wenn leer oder nicht vorhanden, dann wird standardmäßig der aktuelle Name des Scripts verwendet (ohne Pfad). </td>
  </tr>
  <tr>
    <td width="15%">Zeitüberschreitung</td>
    <td width="85%"><p><a name="Timeout"></a>(Optional) Zeitüberschreitung in Sekunden (kann einen Dezimalpunkt, aber keinen Ausdruck enthalten).&nbsp; Wenn dieser Wert 2147483 (24.8 Tage) übersteigt, dann wird dieser auf 2147483 gesetzt.&nbsp; Nachdem die Zeit verstrichen ist, wird das Hinweisfenster automatisch geschlossen und der <a href="IfMsgBox.htm">IfMsgBox</a>-Befehl sieht den Wert TIMEOUT.</p>
      <p>Bekannte Einschränkung: Wenn die MsgBox nur eine OK-Schaltfläche enthält, dann denkt <a href="IfMsgBox.htm">IfMsgBox</a>, dass die OK-Schaltfläche gedrückt wurde, nachdem die Zeit verstrichen ist, während der eigene <a href="../misc/Threads.htm">Thread</a> von einem anderen unterbrochen wurden ist.</p></td>
  </tr>
</table>

<p>Der<strong> </strong><em>Optionen</em>-Parameter kann eine Kombination (Summe) von einem oder mehreren folgenden Werten sein.</p>
<table class="info" style="width:55%">
  <tr>
    <th width="287">Funktion</th>
    <th>Dezimal-Wert</th>
    <th>Hex-Wert</th>
  </tr>
  <tr>
    <td>OK (das heißt, es wird nur eine OK-Schaltfläche angezeigt)</td>
    <td align="center">0</td>
    <td align="center">0x0</td>
  </tr>
  <tr>
    <td>OK/Abbrechen</td>
    <td align="center">1</td>
    <td align="center">0x1</td>
  </tr>
  <tr>
    <td>Abbrechen /Wiederholen/Ignorieren</td>
    <td align="center">2</td>
    <td align="center">0x2</td>
  </tr>
  <tr>
    <td>Ja/Nein/Abbrechen</td>
    <td align="center">3</td>
    <td align="center">0x3</td>
  </tr>
  <tr>
    <td>Ja/Nein</td>
    <td align="center">4</td>
    <td align="center">0x4</td>
  </tr>
  <tr>
    <td>Wiederholen/Abbrechen</td>
    <td align="center">5</td>
    <td align="center">0x5</td>
  </tr>
  <tr>
    <td>Abbrechen/Wiederholen/Weiter (2000/XP+)</td>
    <td align="center">6</td>
    <td align="center">0x6</td>
  </tr>
  <tr>
    <td>Fügt eine Hilfe-Schaltfläche hinzu (siehe Bemerkungen unten)</td>
    <td align="center">16384</td>
    <td align="center">0x4000</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>Icon Hand (Stopp/Fehler)</td>
    <td align="center">16</td>
    <td align="center">0x10</td>
  </tr>
  <tr>
    <td>Icon Frage </td>
    <td align="center">32</td>
    <td align="center">0x20</td>
  </tr>
  <tr>
    <td>Icon Ausrufezeichen</td>
    <td align="center">48</td>
    <td align="center">0x30</td>
  </tr>
  <tr>
    <td>Icon Sternchen (Info)</td>
    <td align="center">64</td>
    <td align="center">0x40</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>Die 2. Schaltfläche wird zur Standard-Schaltfläche </td>
    <td align="center">256</td>
    <td align="center">0x100</td>
  </tr>
  <tr>
    <td>Die 3. Schaltfläche wird zur Standard-Schaltfläche </td>
    <td align="center">512</td>
    <td align="center">0x200</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>System Modal (immer im Vordergrund)</td>
    <td align="center">4096</td>
    <td align="center">0x1000</td>
  </tr>
  <tr>
    <td>Task Modal</td>
    <td align="center">8192</td>
    <td align="center">0x2000</td>
  </tr>
  <tr>
    <td>Immer im Vordergrund (WS_EX_TOPMOST-Style) <br> (Wie System Modal, aber ohne Icon in der Titelleiste)</td>
    <td align="center">262144</td>
    <td align="center">0x40000</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>Macht den Text rechtsbündig</td>
    <td align="center">524288</td>
    <td align="center">0x80000</td>
  </tr>
  <tr>
    <td>Leserichtung von links nach rechts (für Hebräisch/Arabisch)</td>
    <td align="center">1048576</td>
    <td align="center">0x100000</td>
  </tr>
</table>
<h3>Bemerkungen</h3>
<p>Die obige Tabelle wird verwendet, um die Werte für die gewünschte Ansicht der MsgBox zu addieren. Um zum Beispiel ein Ja/Nein-Hinweisfenster mit Nein anstelle von Ja als Standard-Schaltfläche anzugeben, verwendet 256+4 (260) in den <em>Optionen</em>. In Hexadezimal wäre es 0x100 +0x4 (0x104).</p>
<p>MsgBox hat eine intelligente Komma-Handhabung, daher müssen Kommas im <em>Text</em>-Parameter nicht <a href="_EscapeChar.htm">geschützt</a> werden.</p>
<p>Um festzustellen, welche Schaltfläche der Benutzer in der aktuellsten MsgBox gedrückt hat, verwendet den Befehl <a href="IfMsgBox.htm">IfMsgBox</a>. Zum Beispiel:</p>
<pre>MsgBox, 4,, Möchten Sie fortfahren? (Ja oder Nein drücken)
IfMsgBox Yes
    MsgBox Sie haben Ja gedrückt.
Else
    MsgBox Sie haben Nein gedrückt.</pre>
<p>Die Namen der Schaltflächen können mit diesem <a href="../scripts/MsgBoxButtonNames.htm">Beispiel</a> benutzerdefiniert werden.</p>
<p><strong>Tipp</strong>: Wenn Steuerung+C gedrückt wird, während das Hinweisfenster aktiv ist, dann wird der Text in die Zwischenablage kopiert. Das gilt für alle Hinweisfenster, nicht nur die von AutoHotkey.</p>
<p><strong>MsgBox mit einem GUI-Fenster verwenden</strong>: Ein GUI-Fenster kann eine <em>modale</em> MsgBox mittels <a href="Gui.htm#OwnDialogs">Gui, +OwnDialogs</a> anzeigen. Ein <em>modales</em> Dialog-Fenster hindert den Benutzer solange daran, mit dem GUI-Fenster zu interagieren, bis das modale Dialog-Fenster wieder geschlossen wird. In einem solchen Fall ist es nicht notwendig, System Modal oder Task Modal in den Optionen anzugeben.</p>
<p>Wenn <a href="Gui.htm#OwnDialogs">Gui +OwnDialogs</a> <em>nicht</em> aktiv ist, dann kann die Option Task Modal (8192) verwendet werden, um alle Fenster im Script zu deaktivieren, bis der Benutzer die MsgBox schließt.</p>
<p><strong>Die Schaltfläche Hilfe</strong>: Wenn die Option für die Hilfe-Schaltfläche (83) in den <em>Optionen</em> vorhanden ist, dann funktioniert das Drücken dieser Schaltfläche nur, wenn die beiden folgenden Bedingungen erfüllt sind:</p>
<ol>
  <li>Die MsgBox wird einem GUI-Fenster mittels <a href="Gui.htm#OwnDialogs">Gui +OwnDialogs</a> untergeordnet.</li>
  <li>Das Script überwacht die WM_HELP-Nachricht (0x53). Zum Beispiel: <a href="OnMessage.htm">OnMessage(0x53, "WM_HELP")</a>. Wenn die Funktion WM_HELP() aufgerufen wird, dann wird der Benutzer z. B. durch das Anzeigen eines anderen Fensters oder einer MsgBox geleitet.</li>
</ol>
<p><strong>Die Schaltfläche Schließen (in der Titelleiste der MsgBox)</strong>: Da die MsgBox eine integrierte Funktion des Betriebssystems ist, wird die <strong>X-Schaltfläche</strong> nur aktiviert, wenn bestimmte Schaltflächen vorhanden sind. Falls nur eine OK-Schaltfläche vorhanden ist, dann ist das Klicken der <strong>X-Schaltfläche</strong> das gleiche wie das Drücken von OK. Ansonsten wird die X-Schaltfläche nur aktiviert, wenn eine Abbrechen-Schaltfläche vorhanden ist, in diesem Fall entspricht das Klicken der <strong>X-Schaltfläche</strong> das Drücken von Abbrechen.</p>
<h3>Verwandte Befehle</h3>
<p><a href="IfMsgBox.htm">IfMsgBox</a>, <a href="InputBox.htm">InputBox</a>, <a href="FileSelectFile.htm">FileSelectFile</a>, <a href="FileSelectFolder.htm">FileSelectFolder</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="Gui.htm">GUI</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">MsgBox Das ist die 1-Parameter-Methode. Kommas (,) müssen nicht geschützt werden.
MsgBox, 4, , Das ist die 3-Parameter-Methode. Kommas (,) müssen nicht geschützt werden.
MsgBox, 4,, Möchten Sie fortfahren? (Ja oder Nein drücken)
IfMsgBox No
    Return
MsgBox, 4, , 4-Parameter-Methode: Diese MsgBox schließt sich automatisch in 5 Sekunden.  Weiter?, 5
IfMsgBox Timeout
    MsgBox Sie haben nicht Ja oder Nein innerhalb von 5 Sekunden gedrückt.
Else IfMsgBox No
    Return

<em>; Mit dem Voranstellen von "% " wird jeder Parameter zum Ausdruck. Im folgenden Beispiel wird eine Berechnung durchgeführt, auf ein Array-Element zugegriffen und eine Funktion aufgerufen.  Alle Elemente
; sind durch den Punkt-Operator verkettet, um einen String in der MsgBox darzustellen:</em>
MsgBox % "Die neue Breite des Objekts #" . A_Index . " ist: " . RestrictWidth(ObjectWidth%A_Index% * ScalingFactor)

<em>; Das folgende Beispiel warnt den Benutzer, dass eine MsgBox den Fokus gleich wegnimmt (falls der Benutzer schreibt).</em>
SplashTextOn,,, Eine MsgBox erscheint gleich.
Sleep 3000
SplashTextOff
MsgBox Der Sicherungsprozess wurde abgeschlossen.</pre>

</body>
</html>
