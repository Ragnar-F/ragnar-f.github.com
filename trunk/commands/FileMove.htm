<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>FileMove</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>FileMove</h1>

<p>Verschiebt oder benennt beliebig viele Dateien um.</p>

<pre class="Syntax">FileMove, Quellmuster, Zielmuster [, Flag]</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td>Quellmuster</td>
    <td>Der Name einer Datei oder eine musterbasierte Suche wie C:\Temp\*.tmp. Das <em>Quellmuster</em> befindet sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis, solange kein absoluter Pfad angegeben ist.</td>
  </tr>
  <tr>
    <td>Zielmuster</td>
    <td>Der Name oder Muster des Ziels, das sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis befindet, solange kein absoluter Pfad angegeben ist.  Damit beim Verschieben von Dateien die Namen beibehalten werden, darf nur der Ordnernamen wie in den folgenden Beispielen angegeben werden:<br> FileMove, C:\*.txt, C:\Eigener Ordner<br> FileMove, C:\*.txt, C:\Eigener Ordner\*.*</td>
  </tr>
  <tr>
    <td width="15%">Flag</td>
    <td width="85%"><p>(Optional) Mit diesem Parameter wird bestimmt, ob Dateien überschrieben werden, wenn sie bereits vorhanden sind:</p>
      <p>0 = (Standard) vorhandene Dateien nicht überschreiben<br>1 = vorhandene Dateien überschreiben</p>
      <p>Dieser Parameter kann ein <a href="../Variables.htm#Expressions">Ausdruck</a> oder True bzw. False sein (intern auch als 1 bzw. 0 gespeichert).</p></td>
  </tr>
</table>

<h3>ErrorLevel</h3>
<p>Bei Problemen enthält <a href="../misc/ErrorLevel.htm">ErrorLevel</a> die Anzahl an Dateien, die nicht verschoben werden konnten, ansonsten wird ErrorLevel auf 0 gesetzt. Allerdings wird ErrorLevel auf 0 gesetzt, wenn die Quelldatei eine einzelne Datei (ohne Platzhalter) ist und nicht existiert. Zur Überprüfung dieser Bedingung kann <a href="IfExist.htm">IfExist</a> oder <a href="../Functions.htm#FileExist">FileExist()</a> mit der Quelldatei verwendet werden, bevor sie verschoben wird.</p>
<p>Im Gegensatz zu <a href="FileCopy.htm">FileCopy</a> wird das Verschieben einer Datei auf sich selbst immer als Erfolg betrachtet, auch wenn der Überschreibmodus nicht aktiv ist.</p>
<p>Wenn Dateien gefunden wurden, enthält <a href="../Variables.htm#LastError">A_LastError</a> eine Null oder den Rückgabewert der Systemfunktion GetLastError()-Funktion unmittelbar nach dem letzten Fehler. Ansonsten enthält A_LastError einen Fehlercode, der darauf hinweist, warum keine Dateien gefunden wurden.</p>

<h3>Bemerkungen</h3>
<p> FileMove verschiebt nur Dateien. Um stattdessen den Inhalt eines Ordners zu verschieben (alle Dateien und Unterordner), sieht die Beispiele weiter unten. Mit <a href="FileMoveDir.htm">FileMoveDir</a> können einzelne Ordner verschoben oder umbenannt werden.</p>
<p>Die Operation wird fortgesetzt, selbst wenn Fehler auftreten.</p>
<p>Obwohl dieser Befehl in der Lage ist, Dateien auf andere Datenträger zu verschieben, dauert der Vorgang länger als das Verschieben auf dem gleichen Datenträger. Denn das Verschieben auf dem gleichen Datenträger ist das gleiche wie Umbenennen, was bedeutend schneller ist.</p>
<h3>Verwandte Befehle</h3>
<p><a href="FileCopy.htm">FileCopy</a>, <a href="FileCopyDir.htm">FileCopyDir</a>, <a href="FileMoveDir.htm">FileMoveDir</a>, <a href="FileDelete.htm">FileDelete</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">FileMove, C:\Eigene Dokumente\Liste1.txt, D:\Hauptsicherung\  <em>; Verschiebt die Datei, ohne sie umzubenennen.</em>
FileMove, C:\Datei bevor.txt, C:\Datei danach.txt  <em>; Benennt eine Datei um.</em>
FileMove, C:\Ordner1\*.txt, D:\Neuer Ordner\*.bkp  <em>; Verschiebt und benennt die Erweiterung der Dateien um.</em></pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; Das folgende Beispiel verschiebt alle Dateien und Unterordner in einem anderen Ordner:</em>
Fehlerzählung := MoveFilesAndFolders("C:\Eigener Ordner\*.*", "D:\Zielordner für Dateien & Ordner")
If Fehlerzählung <> 0
    MsgBox %Fehlerzählung% Dateien/Ordner konnten nicht verschoben werden.

MoveFilesAndFolders(Quellmuster, Zielordner, Überschreiben = false)
<em>; Verschiebt alle Dateien und Ordner vom Quellmuster in dem Zielordner und
; gibt die Anzahl an Dateien/Ordnern zurück, die nicht verschoben werden konnten. Diese Funktion benötigt v1.0.38+, weil der 2. Modus von FileMoveDir verwendet wird.</em>
{
    If Überschreiben = 1
        Überschreiben = 2  <em>; Siehe <a href="FileMoveDir.htm">FileMoveDir</a> für die Beschreibung vom 1. und 2. Modus.</em>
    <em>; Zuerst alle Dateien verschieben (aber nicht die Ordner):</em>
    FileMove, %Quellmuster%, %Zielordner%, %Überschreiben%
    Fehlerzählung := ErrorLevel
    <em>; Jetzt alle Ordner verschieben:</em>
    Loop, %Quellmuster%, 2  <em>; 2 bedeutet "nur Ordner".</em>
    {
        FileMoveDir, %A_LoopFileFullPath%, %Zielordner%\%A_LoopFileName%, %Überschreiben%
        Fehlerzählung += ErrorLevel
        If ErrorLevel  <em>; Jeden Problemordner mit Namen anzeigen.</em>
            MsgBox %A_LoopFileFullPath% kann nicht nach  %Zielordner% verschoben werden.
    }
    Return Fehlerzählung
}</pre>

</body>
</html>
