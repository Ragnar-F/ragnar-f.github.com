<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>ImageSearch</title>
<meta name="description" content="Use ImageSearch in this free macro program to search the screen for an ICO, BMP, or PNG image. Send keystrokes or mouse clicks in response.">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>ImageSearch</h1>

<p>Sucht in einem bestimmten Bildschirmbereich nach einem Bild.</p>

<pre class="Syntax">ImageSearch, AusgabevariableX, AusgabevariableY, X1, Y1, X2, Y2, Bilddatei</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td width="15%">AusgabevariableX/Y</td>
    <td width="85%"><p>Die Namen der Variablen, in denen die X- und Y-Koordinate des oberen linken Pixels gespeichert werden, wo das Bild gefunden wurde (wenn keine Übereinstimmung vorhanden ist, dann werden diese Variablen leer gemacht). Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu ändern.</p>
    <p>Eine oder beide Parameter können leer gelassen werden. In diesem Fall kann mit ErrorLevel (siehe unten) festgestellt werden, ob eine Übereinstimmung gefunden wurde.</p></td>
  </tr>
  <tr>
    <td>X1,Y1</td>
    <td>Die neuen X- und Y-Koordinaten der oberen linken Ecke des gesuchten Rechtecks, die <a href="../Variables.htm#Expressions">Ausdrücke</a> sein können. <strong>Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu ändern.</strong></td>
  </tr>
  <tr>
    <td>X2,Y2</td>
    <td>Die neuen X- und Y-Koordinaten der unteren rechten Ecke des gesuchten Rechtecks, die <a href="../Variables.htm#Expressions">Ausdrücke</a> sein können. Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu ändern.</td>
  </tr>
  <tr>
    <td>Bilddatei</td>
    <td><p>Der Name des Bildes, das sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis befindet, solange kein absoluter Pfad angegeben ist. Alle Betriebssysteme unterstützen GIF, JPG, BMP, ICO, CUR und ANI (BMP-Bilder müssen 16-Bit oder höher sein). Andere Quellen von Icons können sein: EXE, DLL, CPL, SCR und andere Typen, die Icon-Ressourcen enthalten. In Windows XP (oder höher) werden zusätzliche Bildformate wie PNG, TIF, Exif, WMF und EMF unterstützt. Betriebssysteme älter als XP können unterstützt werden, wenn die freie GDIPlus.dll von Microsoft in den Ordner der AutoHotkey.exe kopiert wird (im Falle eines <a href="../Scripts.htm#ahk2exe">kompilierten Scripts</a> muss die DLL-Datei in den Ordner des Scripts). Um die DLL herunterzuladen, sucht in <a href="http://www.microsoft.com">www.microsoft.com</a> mit folgenden Begriffen: gdi redistributable</p>
      <p><strong>Optionen</strong>: Beliebig viele folgende Strings können vor dem Dateinamen stehen. Die Optionen werden mit einem Leerzeichen oder Tabulator getrennt. Zum Beispiel: *2 *w100 *h-1 C:\Hauptlogo.bmp</p>
      <p><strong>*IconN</strong>: Um eine beliebige Icon-Gruppe in einer Datei zu verwenden, fügt in den <I>Optionen</I> das Wort *Icon ein, gefolgt von der Gruppennummer. Mit *Icon2 beispielsweise wird das Standard-Icon aus der zweiten Icon-Gruppe geladen.</p>
    <p><strong>*n</strong> (Variation): Für <strong>n</strong> kann eine Nummer zwischen 0 und 255 angegeben werden, um den Farbtontoleranzbereich von Rot-, Grün- und Blaukomponenten jeder Pixelfarbe zu bestimmen. Zum Beispiel erlaubt *2 zwei Farbtonvarianten. Dieser Parameter ist hilfreich, wenn die Bildfarbe leicht variiert oder die <em>Bilddatei</em> ein Format wie GIF oder JPG benutzt, dass auf dem Bildschirm nicht richtig dargestellt wird. Bei 255 Farbtonvarianten stimmen alle Farben überein. Standard sind 0 Farbtonvarianten.</p>
    <p><strong>*TransN</strong>: Diese Option macht es einfacher, eine Übereinstimmung zu finden, wenn eine Farbe des Bildes angegeben wird, die mit jeder beliebigen Farbe auf dem Bildschirm übereinstimmt. Wird häufig bei PNG-, GIF- und TIF-Dateien verwendet, die transparente Bereiche enthalten (Icons benötigen diese Option nicht, weil die Transparenz automatisch unterstützt wird). Bei GIF-Dateien funktioniert meistens *TransWhite. Bei PNG- oder TIF-Dateien eher *TransBlack. Ansonsten kann für <strong>N</strong> ein anderer Farbname oder RGB-Wert angegeben werden (siehe <a href="Progress.htm#colors">Farbtabelle</a> oder verwendet <a href="PixelGetColor.htm">PixelGetColor</a> im RGB-Modus). Beispiele: *TransBlack, *TransFFFFAA, *Trans0xFFFFAA</p>
    <p><strong>*wn</strong> und <strong>*hn</strong>: Bild auf die angegebene Breite und/oder Höhe skaliert (diese Breite und Höhe bestimmt auch, welches Icon von einer .ICO-Datei mit mehreren Icons geladen wird). Wenn beide Optionen weggelassen werden, dann werden die geladenen Icons von einer ICO-, DLL- oder EXE-Datei auf die Standardgröße für kleine Icons skaliert, in der Regel 16x16 (die aktuelle/interne Größe kann mit *w0 *h0 erzwungen werden). Bilder, die keine Icons sind, werden in ihrer aktuellen Größe geladen. Um das Bild unter Beibehaltung des Seitenverhältnisses zu verkleinern oder zu vergrößern, verwendet -1 für eine Abmessung und eine positive Zahl für die andere Abmessung. Mit <em>*w200 *h-1</em> beispielsweise wird die Breite des Bildes auf 200 Pixel gesetzt und die Höhe automatisch eingestellt.</p>    </td>
  </tr>
</table>

<h3>ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 0 gesetzt, wenn das Bild im angegeben Bereich gefunden wird. Ansonsten 1, wenn nicht oder 2, wenn der Befehl daran gehindert wird, die Suche durchzuführen (z. B. die Bilddatei kann nicht geöffnet werden oder eine falsch formatierte Option).</p>
<h3>Bemerkungen</h3>
<p>ImageSearch kann dazu verwendet werden, grafische Objekte auf einem Bildschirm zu erkennen, der kein Text beinhaltet oder der Text nicht einfach ermittelt werden kann. ImageSearch kann zum Beispiel die Position von Bild-Schaltflächen, Icons, Links von Webseiten oder Objekte in Spiele erkennen. In diesem Fall können solche Objekte mithilfe von <a href="Click.htm">Click</a> angeklickt werden.</p>
<p>Es ist manchmal besser, nur einen kleinen Teil des Bildes zu suchen. Damit kann die Zuverlässigkeit bei ständig variierenden Bildern verbessert werden, bei denen bestimmte Bereiche gleich bleiben. Ein Ausschnitt kann z. B. wie folgt gemacht werden:</p>
<ol>
  <li> Alt+Druck drücken, während das Bild im aktiven Fenster sichtbar ist. Der Screenshot landet in der Zwischenablage. </li>
  <li> Ein Bildbearbeitungsprogramm wie Paint öffnen.</li>
  <li> Den Inhalt der Zwischenablage einfügen (in diesem Fall der Screenshot).</li>
  <li> Bereich markieren, der nicht variiert und nur einmal im Bild vorkommt.</li>
  <li> Den Bereich kopieren und in einer neuen Bilddatei einfügen.</li>
  <li> Die Datei speichern, damit sie mit ImageSearch verwenden werden kann.</li>
</ol>
<p>Für eine Übereinstimmung muss ein Bild auf dem Bildschirm so groß wie das Bild sein, welches mit dem <em>Bilddatei</em>-Parameter und dessen Optionen geladen wurde.</p>
<p> Der Suchbereich muss sichtbar sein. Es ist nicht möglich, den Bereich in einem Fenster zu suchen, das hinter einem anderen Fenster liegt. Im Gegensatz dazu werden Bilder, die sich unter dem Mauszeiger befinden, trotzdem erkannt. Die Ausnahme machen Zeiger in Spiele, die in den meisten Fällen bestimmte Bilder darunter behindern.</p>
<p>Die Suche beginnt auf der obersten Zeile des Bereichs und arbeitet sich nach unten. Bei mehreren Übereinstimmungen wird der oberste Fund bevorzugt.</p>
<p>Icons mit transparenter Farbe erlauben dieser Farbe, automatisch mit jeder Farbe auf dem Bildschirm übereinzustimmen. Daher spielt die Farbe hinter dem Icon keine Rolle.</p>
<p>ImageSearch unterstützt Farbbildschirme mit 8-Bit (256 Farben) oder höher.</p>
<p>Das Suchverhalten ist von der Farbtiefe der Grafikkarte abhängig (besonders für GIF- und JPG-Dateien). Wenn ein Script mit mehreren Farbtiefen läuft, dann ist es das Beste, das Script mit jeder Tiefeneinstellung zu testen. Mit der Option für Farbtontoleranz (*n) kann das Verhalten mit mehreren Farbtiefen nachgeahmt werden.</p>
<p>Wenn das Bild auf dem Bildschirm durchsichtig ist, dann könnte die Suche mit ImageSearch fehlschlagen. Als Übergangslösung kann die Option für Farbtontoleranz (*n) ausprobiert werden oder das Fenster kurzzeitig mit <a href="WinSet.htm#trans">WinSet, Transparent, Off</a> undurchsichtig machen.</p>
<h3>Verwandte Befehle</h3>
<p><a href="PixelSearch.htm">PixelSearch</a>, <a href="PixelGetColor.htm">PixelGetColor</a>, <a href="CoordMode.htm">CoordMode</a>, <a href="MouseGetPos.htm">MouseGetPos</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">ImageSearch, FoundX, FoundY, 40,40, 300, 300, C:\Eigene Bilder\test.bmp

CoordMode Pixel  <em>;  Koordinaten beziehen sich auf dem Bildschirm, anstatt auf das aktive Fenster.</em>
ImageSearch, XPos, YPos, 0, 0, A_ScreenWidth, A_ScreenHeight, *Icon3 %A_ProgramFiles%\BeliebigerOrdner\BeliebigeApp.exe
If ErrorLevel = 2
    MsgBox Die Suche konnte nicht durchgeführt werden.
Else If ErrorLevel = 1
    MsgBox Icon konnte nicht auf dem Bildschirm gefunden werden.
Else
    MsgBox Das Icon wurde bei %XPos%x%YPos% gefunden.</pre>

</body>
</html>
