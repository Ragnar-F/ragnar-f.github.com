<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Hotkey</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>Hotkey</h1>

<p>Erstellt, bearbeitet, aktiviert oder deaktiviert ein Hotkey, während das Script läuft.</p>

<pre class="Syntax">Hotkey, Tastenname [, Label, Optionen]
Hotkey, IfWinActive/Exist [, Fenstertitel, Fenstertext]
Hotkey, If, Ausdruck</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td width="15%">Tastenname</td>
    <td width="85%"><p>Name des Hotkeys, einschließlich <a href="../Hotkeys.htm#Symbols">Modifikatoren</a>. Zum Beispiel kann für Win+C #c angegeben werden.</p>
    <p>Wenn der <em>Tastenname</em> bereits als Hotkey existiert, dann wird dieser überschrieben.</p>
    <p>Der <em>Tastenname</em> kann auch der Name eines existierenden Hotkey-Labels sein (d. h. ein Label mit zwei Doppelpunkten), dass mit den neuen Werten überschrieben wird.</p>
    <p>Wenn ein <em>existierender</em> Hotkey angegeben wird, dann ist der <em>Tastenname</em> nicht von der Groß- oder Kleinschreibung abhängig. Allerdings müssen die Namen der Tasten mit dem existierenden Hotkey übereinstimmen (z. B. ist Esc in diesem Fall nicht das gleiche wie Escape). Außerdem spielt die Reihenfolge der <a href="../Hotkeys.htm#Symbols">Modifikatoren</a> wie ^!+# keine Rolle.</p>
    <p>Die <a href="#IfWin">aktuelle IfWin-Einstellung</a> bestimmt die <a href="#variant">Variante</a>, mit welcher ein HotKey-Befehl ausgeführt wird. Wenn die Variante noch nicht existiert, dann wird sie erstellt.</p>
    <p>Wenn ein Hotkey zuerst erstellt wird (entweder mit einem Hotkey-Befehl oder einem <a href="../Hotkeys.htm">Label mit zwei Doppelpunkten</a>), dann entsteht aus dem Tastennamen und der Reihenfolge der Modifikatoren ein permanenter Name des Hotkeys, der im Zusammenhang mit <a href="../Variables.htm#ThisHotkey">A_ThisHotkey</a> steht. Dieser Name ändert sich nicht, selbst wenn der Hotkey-Befehl später mit einer unterschiedlichen Zeichenreihenfolge auf dem Hotkey zugreift.</p></td>
  </tr>
  <tr>
    <td>Label</td>
    <td><p>Name des Labels, dessen Inhalt (als neuer <a href="../misc/Threads.htm">Thread</a>) ausgeführt wird, wenn der Hotkey gedrückt wird. Sowohl normale Labels als auch <a href="../Hotkeys.htm">Hotkey</a>/<a href="../Hotstrings.htm">Hotstring</a>-Labels können verwendet werden. Die nachfolgenden Doppelpunkte sollten nicht eingefügt werden. Wenn <em>Label</em> dynamisch ist (z. B. %VarEnthältLabelName%), dann kann <a href="../Functions.htm#IsLabel">IsLabel(VarEnthältLabelName)</a>vorher aufgerufen werden, um die Verfügbarkeit des Labels zu überprüfen.</p>
      <p>Dieser Parameter kann leer gelassen werden, wenn der <em>Tastenname</em> bereits als Hotkey existiert. In diesem Fall wird die Bezeichnung des Labels nicht geändert. Das ist besonders nützlich, wenn nur die <em>Optionen</em> des Hotkeys geändert werden müssen.</p>
      <p><strong>Wenn das Label festgelegt wurde, aber der Hotkey durch eine vorherige Anwendung des Befehls deaktiviert ist, dann bleibt der Hotkey deaktiviert. Mit dem Wort ON in den <em>Optionen</em> kann das verhindert werden.</strong></p>
      <p>Dieser Parameter kann einen folgenden Wert enthalten:</p>
      <p><strong>On</strong>: Der Hotkey wird aktiviert. Es passiert nichts, wenn der Hotkey bereits aktiv ist.</p>
      <p><strong>Off</strong>: Der Hotkey wird deaktiviert. Es passiert nichts, wenn der Hotkey bereits inaktiv ist.</p>
      <p><strong>Toggle</strong>: Der Status des Hotkeys wird umgekehrt (aktiviert oder deaktiviert).</p>
      <p><strong>AltTab</strong> (und andere): Spezielle Alt-Tab-Aktionen, die <a href="../Hotkeys.htm#alttab">hier</a> beschrieben werden.</p>
      <p>Hinweis: Diese Werte haben nur eine besondere Bedeutung, <u>wenn kein entsprechendes Label vorhanden ist</u>. Wenn zum Beispiel ein Label <code>On:</code> existiert und der Parameter das Wort ON enthält, dann wird das Wort als Labelname verwendet. Um Hotkeys in solchen Fällen zu aktivieren oder zu deaktivieren, verwendet den <i>Optionen</i>-Parameter. <i>Label</i> kann weggelassen werden, z. B. <code>Hotkey Esc,, Off</code>.</p>
      <p>Hinweis: Die <a href="#IfWin">aktuelle IfWin-Einstellung</a> bestimmt die <a href="#variant">Variante</a>, mit welcher On/Off/Toggle ausgeführt wird.</p>      </td>
  </tr>
  <tr>
    <td>Optionen</td>
    <td><p>Ein String mit beliebig vielen Buchstaben, die optional mit Leerzeichen getrennt werden. Zum Beispiel: UseErrorLevel B0</p>
      <p><strong><a name="UseErrorLevel"></a>UseErrorLevel</strong>: Wenn der Befehl ein Problem feststellt, dann werden alle Warnungsfenster übersprungen, <a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf einem Code aus der <a href="#ErrorLevel">unteren</a> Tabelle gesetzt und der <a href="../misc/Threads.htm">aktuelle Thread</a> wird fortgesetzt.</p>
      <p><strong>On</strong>: Aktiviert den Hotkey, wenn er derzeit deaktiviert ist.</p>
      <p><strong>Off</strong>: Deaktiviert den Hotkey, wenn er derzeit aktiviert ist. Das wird normalerweise benutzt, um einen Hotkey zunächst im deaktivierten Zustand zu erstellen.</p>
      <p><strong>B</strong> oder <strong>B0</strong>: Mit dem Buchstaben B kann ein Hotkey zwischengespeichert werden (siehe <a href="_MaxThreadsBuffer.htm">#MaxThreadBuffer</a>). Mit B0 (B mit der Zahl 0) kann die Zwischenspeicherung deaktiviert werden.</p>
      <p><strong>Pn</strong>: Mit dem Buchstaben P kann die <a href="../misc/Threads.htm">Thread-Priorität</a> des Hotkeys bestimmt werden. Wenn die P-Option bei der Erstellung eines Hotkeys weggelassen wird, dann wird die Zahl 0 verwendet.</p>
      <p><strong>Tn</strong>: Mit dem Buchstaben T kann die maximale Anzahl an Threads bestimmt werden (siehe <a href="_MaxThreadsPerHotkey.htm">#MaxThreadsPerHotkey</a>). Zum Beispiel: T5</p>
      <p>Wenn die <strong>B</strong>- oder <strong>T</strong>-Optionen weggelassen werden und der Hotkey bereits existiert, dann werden diese Optionen nicht geändert. Wenn der Hotkey aber noch nicht vorhanden ist, dann treten die aktuellsten Optionen in Kraft. Zum Beispiel wird die aktuellste (unterste im Script) Instanz von <a href="_MaxThreadsBuffer.htm">#MaxThreadBuffer</a> verwendet. Wenn <a href="_MaxThreadsBuffer.htm">#MaxThreadBuffer</a> nirgendwo im Script erscheint, dann wird die Standardeinstellung (in diesem Fall OFF) benutzt. Dieses Verhalten gilt auch für <a href="_IfWinActive.htm">#IfWin</a>: das unterste Vorkommen gilt für neu erstellte Hotkeys, es sei denn, "<a href="#IfWin">Hotkey IfWin</a>" wurde seit dem Start des Scripts ausgeführt.</p>
      <p>Hinweis: Die <a href="#IfWin">aktuelle IfWin-Einstellung</a> bestimmt die <a href="#variant">Variante</a>, mit welcher ein HotKey-Befehl ausgeführt wird. Wenn die Variante noch nicht existiert, dann wird sie erstellt.</p>      </td>
  </tr>
  <tr>
    <td>IfWinActive<br> IfWinExist</td>
    <td>(IfWin<strong>Not</strong>Active und IfWin<strong>Not</strong>Exist werden auch unterstützt). Diese Unterbefehle machen alle danach erstellten Hotkeys kontextabhängig. Siehe <a href="#IfWin">unten</a> für weitere Details.</td>
  </tr>
  <tr>
    <td>Fenstertitel<br> Fenstertext</td>
    <td><p>Innerhalb dieser Parameter wird jede Variablereferenz wie %var% beständig, sobald der Befehl ausgeführt wurde. Mit anderen Worten: nachfolgende Änderungen am Inhalt werden nicht von existierenden IfWin-Hotkeys erkannt.</p>
      <p>Wie <a href="_IfWinActive.htm">#IfWinActive/Exist</a> verwenden der <em>Fenstertitel</em> und <em>Fenstertext</em> die Standardeinstellungen für <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> und <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> im <a href="../Scripts.htm#auto">automatischen Ausführungsbereich</a>. Siehe <a href="_IfWinActive.htm">#IfWinActive/Exist</a> für weitere Details. </p></td>
  </tr>
  <tr>
    <td>If, Ausdruck</td>
    <td><span class="ver">[AHK_L]:</span> Gegenstück von <a href="_If.htm">#If <i>Ausdruck</i></a>. Der <i>Ausdruck</i> muss exakt mit dem Text eines <b>bestehenden</b> <code>#If <i>Ausdruck</i></code> übereinstimmen, mit Ausnahme von <code>#If</code> oder <code>#If,</code>. Wenn mit dem Hotkey-Befehl verwendet, dann ist nach dem Komma das "If" erforderlich. Obwohl dieser Befehl nicht fähig ist, neue Ausdrücke zu erstellen, können immer noch neue Hotkeys erstellt werden, die einen existierenden Ausdruck verwenden. Siehe <a href="_If.htm#ex4">#If Beispiel 4</a>.</td>
  </tr>
</table>

<h3 id="ErrorLevel">ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> ändert sich nur, wenn: 1) der erste Parameter IfWin[Not]Active/Exist ist, in diesem Fall wird ErrorLevel bei einem Problem auf 1 gesetzt, ansonsten 0; 2) das Wort UseErrorLevel in den <em>Optionen</em> vorhanden ist.</p>
<table class="info">
  <tr>
    <th>Fehler</th>
    <th>Beschreibung</th>
  </tr>
  <tr>
    <td>1</td>
    <td>Der <em>Label</em>-Parameter bestimmt einen nicht vorhandenen Labelnamen. </td>
  </tr>
  <tr>
    <td>2</td>
    <td>Der <em>Tastenname</em>-Parameter kann beliebig viele Tasten angegeben, die weder erkannt noch von der aktuellen Tastaturbelegung/Sprache unterstützt werden.</td>
  </tr>
  <tr>
    <td>3</td>
    <td>Die Präfixtaste wird nicht unterstützt. Zum Beispiel wird das Verwenden des Mausrads als ein Präfix in einem Hotkey wie <em>WheelDown & Enter</em> nicht unterstützt.</td>
  </tr>
  <tr>
    <td>4</td>
    <td>Der <em>Tastenname</em> ist nicht für die Verwendung mit <a href="../Hotkeys.htm#alttab">AltTab- oder ShiftAltTab</a>-Aktionen geeignet. Eine Kombination aus zwei Tasten ist nicht erforderlich. Zum Beispiel: <em>RControl & RShift::AltTab</em></td>
  </tr>
  <tr>
    <td>5</td>
    <td>Der Befehl versucht, einen nicht existierenden Hotkey zu bearbeiten.</td>
  </tr>
  <tr>
    <td>6</td>
    <td>Der Befehl versucht, eine nicht existierende <a href="#variant">Variante</a> des Hotkeys zu bearbeiten. Als Übergangslösung kann "<a href="#IfWin">Hotkey IfWin</a>" verwendet werden, um Übereinstimmungskriterien nur für bestimmte Hotkeys zu setzen.</td>
  </tr>
  <tr>
    <td>50</td>
    <td>Windows 95/98/Me: Der Befehl wurde erfolgreich ausgeführt, aber das Betriebssystem verweigert die Aktivierung des Hotkeys. Das wird üblicherweise durch den Hotkey verursacht, der gerade von anderen Scripts oder Anwendungen verwendet wird (oder vom Betriebssystem selbst). Das passiert nur in Windows 95/98/Me. Bei anderen Betriebssystemen greift das Programm auf den <a href="_InstallKeybdHook.htm">Tastatur-Hook</a> zurück, um dieses Problem zu <a href="../misc/Override.htm">überschreiben</a>.</td>
  </tr>
  <tr>
    <td>51</td>
    <td>Windows 95/98/Me: Der Befehl wurde erfolgreich ausgeführt, aber der Hotkey wird vom Betriebssystem nicht unterstützt. Zum Beispiel werden Maus- und Präfix-Hotkeys wie "a & b" nicht unterstützt.</td>
  </tr>
  <tr>
    <td>98</td>
    <td>Beim Erstellen des Hotkeys würde die Begrenzung von 1000 Hotkeys pro Script überschritten (allerdings kann jeder Hotkey eine unbegrenzte Anzahl an <a href="#variant">Varianten</a> besitzen, und die Anzahl an <a href="../Hotstrings.htm">Hotstrings</a> ist nicht begrenzt).</td>
  </tr>
  <tr>
    <td>99</td>
    <td>Nicht genug Arbeitsspeicher. Das ist sehr selten und passiert für gewöhnlich nur, wenn das Betriebssystem instabil wird.</td>
  </tr>
</table>
<p><br> Tipp: Mit der Option UseErrorLevel kann die Existenz einer Hotkey-Variante getestet werden. Zum Beispiel:</p>
<pre>Hotkey, ^!p,, UseErrorLevel
If ErrorLevel in 5,6
   MsgBox Der Hotkey ist weder vorhanden noch hat er eine Variante für die aktuellen IfWin-Kriterien.</pre>
<h3>Bemerkungen</h3>
<p>Wenn das Ziel darin besteht, die ausgewählten Hotkeys oder Hotstrings basierend auf den Typ des aktiven Fensters automatisch zu deaktivieren, dann ist <em>Hotkey, ^!c, Off</em> in der Regel weniger geeignet als <a href="_IfWinActive.htm">#IfWinActive/Exist</a> (oder das dynamischen Gegenstück <a href="#IfWin">Hotkey, IfWinActive/Exist</a>).</p>
<p>Das Erstellen von Hotkeys mit <a href="../Hotkeys.htm">zwei Doppelpunkten</a> ist im Gegensatz zu den Hotkey-Befehlen besser geeignet, weil alle Hotkeys auf einmal aktivierten werden können, wenn das Script startet (statt einzeln). Daher ist es am besten, mit diesem Befehl nur Hotkeys zu erstellen, deren Tastenname nach dem Starten des Scripts noch nicht bekannt ist. Wenn zum Beispiel die Hotkeys eines Scripts für verschiedene Aktion mit einer <a href="IniRead.htm">INI-Datei</a> konfigurierbar sein sollen.</p>
<p>Ein bestimmtes Label kann das Ziel von mehreren Hotkeys werden. Wenn bekannt ist, dass das Label von einem Hotkey aufgerufen wurde, dann kann dieser Hotkey mithilfe der internen Variable <a href="../Variables.htm#ThisHotkey">A_ThisHotkey</a> ermittelt werden.</p>
<p>Wenn das Script <a href="Suspend.htm">unterbrochen</a> wird, dann werden neu hinzugefügte/aktivierte Hotkeys auch unterbrochen, bis die Unterbrechung endet (es sei denn, sie wurden davon befreit, wie im <a href="Suspend.htm">Suspend</a>-Abschnitt beschrieben).</p>
<p>Die <a href="_InstallKeybdHook.htm">Tastatur</a>- und/oder <a href="_InstallMouseHook.htm">Maus</a>-Hooks werden installiert oder entfernt, wenn die Änderungen durch diesen Befehl berechtigt sind.</p>
<p>Obwohl der Hotkey-Befehl Hotkeys in Scripts nicht direkt aktivieren oder deaktivieren kann, können sie in den meisten Fällen durch Erstellen oder Aktivieren der gleichen Hotkeys <a href="../misc/Override.htm">überschrieben</a> werden. Ob das funktioniert, hängt von verschiedenen Faktoren ab: 1) Ob der Hotkey, der überschrieben werden soll, ein <a href="ListHotkeys.htm">Hook-Hotkey</a> in einem anderen Script ist (Hotkeys ohne Hook können immer überschrieben werden, außer in Win9x); 2) Die Tatsache, dass die meisten aktuell gestarteten Hotkeys in Scripts in der Regel Vorrang vor den Hotkeys in anderen Scripts haben; 3) Ob das Aktivieren oder Erstellen dieser Hotkeys den <a href="_InstallKeybdHook.htm">Tastatur</a>- oder <a href="_InstallMouseHook.htm">Maus</a>-Hook neu aktivieren werden (dann ist das Überschreiben immer erfolgreich).</p>
<p>Wenn mindestens ein Hotkey vorhanden ist, dann wird das Script persistent, d. h. dass <a href="ExitApp.htm">ExitApp</a> anstatt Exit zum Beenden des Scripts verwendet werden muss. Hotkey-Scripts sind auch automatisch <a href="_SingleInstance.htm">#SingleInstance</a>, es sei denn, <em>#SingleInstance, Off</em> wurde verwendet.</p>
<h3 id="IfWin">Bemerkungen über <em>Hotkey, IfWinXX [, Fenstertitel, Fenstertext]</em></h3>
<p>Der Befehl "Hotkey IfWin" erlaubt kontextabhängige <a href="../Hotkeys.htm">Hotkeys</a>, die erstellt und bearbeitet werden können, während das Script läuft (im Gegensatz dazu sind Anweisungen mit <a href="_IfWinActive.htm">#IfWinActive/Exist</a> positionell und treten in Effekt, bevor das Script ausgeführt wird). Zum Beispiel:</p>
<pre>Hotkey, IfWinActive, ahk_class Notepad
Hotkey, ^!e, EigenesLabel  <em>; Erstellt ein Hotkey, der nur in Notepad funktioniert.</em></pre>
<p>Mit "Hotkey IfWin" wird die Kontextabhängigkeit für alle danach erstellten oder modifizierten <a href="../Hotkeys.htm">Hotkeys</a> aktiviert. Darüber hinaus tritt nur der aktuellste Unterbefehl in Kraft.</p>
<p>Um die Kontextabhängigkeit auszuschalten (damit danach erstellte Hotkeys in allen Fenstern funktionieren), muss im jedem IfWin-Unterbefehl die Parameter <em>Fenstertitel/Text</em> weggelassen werden. Zum Beispiel: <em>Hotkey, IfWinActive</em></p>
<p>Wenn "Hotkey IfWin" nie von einem Script verwendet wird, dann wird die unterste Verwendung der <a href="_IfWinActive.htm">#IfWin</a>-Anweisung (falls vorhanden) für den Hotkey-Befehl wirksam.</p>
<p>Wenn ein Maus- oder Tastatur-Hotkey durch IfWin deaktiviert ist, dann erfolgt die ursprüngliche Funktion; d. h. der Hotkey wird im aktiven Fenster ausgeführt, als gäbe es nicht diesen Hotkey. Es gibt zwei Ausnahmen: 1) Windows 95/98/Me: Das Drücken eines IfWin-deaktivierten Hotkeys hat keinen Effekt (selbst dessen ursprüngliche Funktion nicht); 2) Joystick-Hotkeys: obwohl IfWin funktioniert, werden andere Programme nicht daran gehindert, das Drücken eines Joystick-Buttons zu beachten.</p>
<h3 id="variant">Hotkeyvarianten (-duplikate)</h3>
<p>Ein besonderer Hotkey kann mehr als einmal erstellt werden, wenn jede Definition verschiedene IfWin-Kriterien hat. Diese werden <em>Hotkey-Varianten</em> genannt. Zum Beispiel:</p>
<pre>Hotkey, IfWinActive, ahk_class Notepad
Hotkey, ^!c, EigenesLabelFürNotepad
Hotkey, IfWinActive, ahk_class WordPadClass
Hotkey, ^!c, EigenesLabelFürWordPad
Hotkey, IfWinActive
Hotkey, ^!c, EigenesLabelFürAndereFenster</pre>
<p>Wenn mehrere Hotkeyvarianten berechtigt sind, ausgeführt zu werden, dann wird die neueste erstellte Variante verwendet. Die Ausnahme macht die globale Variante (ohne IfWin-Kriterien): Sie hat immer die niedrigste Priorität und wird nur ausgeführt, wenn keine andere Variante berechtigt ist.</p>
<p>Bei der Erstellung von Hotkeyduplikaten spielt die Reihenfolge der <a href="../Hotkeys.htm#Symbols">Modifikatoren</a> (z.B. ^!+#) keine Rolle. Zum Beispiel ist ^!c das gleiche wie !^c. Allerdings müssen die Tasten konsequent ausgeschrieben werden. Zum Beispiel ist <em>Esc</em> in diesem Fall nicht das gleiche wie <em>Escape</em>. Schließlich ist jeder Hotkey mit einem <a href="../Hotkeys.htm#wildcard">Platzhalter-Präfix (*)</a> vollständig von einem Hotkey ohne Platzhalter abgegrenzt; Zum Beispiel haben F1 und *F1 jeweils ihre eigenen Varianten.</p>
<p>Für mehr Informationen über IfWin-Hotkeys, siehe <a href="_IfWinActive.htm#gen">allgemeine Bemerkungen von #IfWin</a>.</p>
<h3>Verwandte Befehle</h3>
<p><a href="../Hotkeys.htm#Symbols">Hotkey Symbols</a>, <a href="_IfWinActive.htm">#IfWinActive/Exist</a>, <a href="_MaxThreadsBuffer.htm">#MaxThreadsBuffer</a>, <a href="_MaxThreadsPerHotkey.htm">#MaxThreadsPerHotkey</a>, <a href="Suspend.htm">Suspend</a>, <a href="../Functions.htm#IsLabel">IsLabel()</a>, <a href="../misc/Threads.htm">Threads</a>, <a href="Thread.htm">Thread</a>, <a href="Critical.htm">Critical</a>, <a href="Gosub.htm">Gosub</a>, <a href="Return.htm">Return</a>, <a href="Menu.htm">Menu</a>, <a href="SetTimer.htm">SetTimer</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">Hotkey, ^!z, EigenesLabel
Return

EigenesLabel:
MsgBox %A_ThisHotkey% wurde gedrückt.
Return

<em>; Andere Beispiele:</em>
Hotkey, RCtrl & RShift, AltTab <em>; Ermöglicht das Arbeiten von RCtrl & RShift wie Alt-Tab.</em>
Hotkey, #c, On  <em>; Reaktiviert den Win-C-Hotkey.</em>
Hotkey, $+#c, Off  <em>; Deaktiviert den Shift-Win-C-Hotkey.</em>
Hotkey, ^!a, , T5  <em>; Erlaubt 5 Threads für diesen Hotkey.</em>

Hotkey, IfWinActive, ahk_class Notepad
Hotkey, ^!c, EigenesLabelFürNotepad  <em>; Erstellt den Hotkey Ctrl-Alt-C, der nur in Notepad funktioniert.</em></pre>

</body>
</html>
