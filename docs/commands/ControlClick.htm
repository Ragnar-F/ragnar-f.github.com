<!DOCTYPE HTML>
<html>
<head>
<title>ControlClick</title>
<meta name="keywords" content="Befehl, Steuerelement, Maus">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="../static/html5.js"></script>
<![endif]-->
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <div id="article">
    <h1>ControlClick</h1>
    <p>Sendet eine Maus- oder Mausradaktion an einem Steuerelement.</p>
    <pre class="Syntax">ControlClick [, Steuerelement-oder-Pos, Fenstertitel, Fenstertext, Taste, Klickanzahl, Optionen, Titelausnahme, Textausnahme]</pre>
    <h3>Parameter</h3>
    <table class="info">
      <tr>
        <td style="width: 15%;">Steuerelement-oder-Pos</td>
        <td style="width: 85%;"><p>Ist  dieser Parameter leer, wird das oberste Steuerelement des Fensters angeklickt (oder das Fenster selbst, falls es keine Steuerelemente hat). Ansonsten wird eine der unteren Methoden verwendet.</p>
          <p>Modus 1 (Position): Gebe die Koordinaten X und Y an, die sich auf die obere linke Ecke des Zielfensters beziehen. Die X-Koordinate muss vor der Y-Koordinate angegeben werden, au&szlig;erdem muss mindestens ein Leer- oder Tabulatorzeichen zwischen denen vorkommen. Zum Beispiel: <code>X55 Y33</code>. Befindet sich auf den angegebenen Koordinaten ein Steuerelement, wird das Klickereignis auf genau diesen Koordinaten gesendet. Ist dort kein Steuerelement, wird die Aktion an das Fenster selbst gesendet (funktioniert nicht bei jedem Fenster). Hinweis: In diesem Modus werden die Optionsbuchstaben X und Y ignoriert.</p>
          <p>Modus 2 (ClassNN oder Text): Gebe entweder ClassNN (Klassenname und Instanznummer des Steuerelements) oder Name/Text des Steuerelements an, die beide per Windows Spy ermittelt werden k&ouml;nnen. Beim Name/Text wird das &Uuml;bereinstimmungsverhalten mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> bestimmt.</p>
          <p>Standardm&auml;&szlig;ig hat der zweite Modus Vorrang vor dem ersten Modus. Zum Beispiel w&uuml;rde bei einem Steuerelement, dessen Text oder Klassenname im Format "Xnnn Ynnn" ist (eher unwahrscheinlich), der zweite Modus in Kraft treten. M&ouml;chtest du das &uuml;berschreiben und den ersten Modus unbedingt verwenden, muss du das Wort "Pos" wie folgt in <em>Optionen</em> angeben: <code>ControlClick, x255 y152, Fenstertitel,,,, Pos</code>.</p>
          <p>Um ein Steuerelement per HWND (Windows Handle) anzusteuern, muss dieser Parameter leer gelassen und <code>ahk_id %SteuerelementHwnd%</code> im <em>Fenstertitel</em>-Parameter angegeben werden (funktioniert auch bei versteckten Steuerelementen, selbst wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist). Das HWND eines Steuerelements wird &uuml;blicherweise per <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a> oder <a href="DllCall.htm">DllCall</a> abgerufen.</p></td>
      </tr>
      <tr>
        <td>Fenstertitel</td>
        <td>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</td>
      </tr>
      <tr>
        <td>Fenstertext</td>
        <td>In diesem Parameter kann ein Teilstring angegeben werden, der in einem Textelement des Zielfensters vorkommt (werden mit Windows Spy angezeigt). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</td>
      </tr>
      <tr>
        <td>Taste</td>
        <td><p>Die zu klickende Taste: LEFT, RIGHT, MIDDLE (oder einfach der erste Buchstabe). Ist dieser Parameter leer oder nicht vorhanden, wird die Maustaste LEFT verwendet.</p>
          <p>Ben&ouml;tigt Windows 2000/XP oder h&ouml;her. Zudem wird X1 (XButton1, die 4. Maustaste) und X2 (XButton2, die 5. Maustaste) unterst&uuml;tzt.</p>
          <p>Ben&ouml;tigt Windows NT/2000/XP oder h&ouml;her. Zudem wird WheelUp (oder WU) und WheelDown (oder WD) unterst&uuml;tzt. Mit <em>Klickanzahl</em> kann die Anzahl der Rasterungen zum Drehen des Rades bestimmt werden.</p>
          <p>Windows Vista oder h&ouml;her <span class="ver">[v1.0.48+]:</span> WheelLeft (WL) oder WheelRight (WR) werden auch unterst&uuml;tzt (funktioniert nicht bei &auml;lteren Betriebssystemen). Mit <em>Klickanzahl</em> kann die Anzahl der Rasterungen zum Drehen des Rades bestimmt werden.</p></td>
      </tr>
      <tr>
        <td>Klickanzahl</td>
        <td>Die Anzahl der Mausklicks, das auch ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein kann. Ist dieser Parameter leer oder nicht vorhanden, wird ein Mausklick gesendet. </td>
      </tr>
      <tr>
        <td>Optionen</td>
        <td><p>Eine Reihe der folgenden  Optionsbuchstaben. Zum Beispiel: <code>d x50 y25</code>.</p>
          <p><strong>NA</strong> <span class="ver">[v1.0.45+]:</span> Kann die Zuverl&auml;ssigkeit verbessern. Siehe <a href="#Reliability">Zuverl&auml;ssigkeit</a> weiter unten.</p>
          <p><strong>D</strong>: Dr&uuml;ckt die Maustaste nach unten, aber l&auml;sst sie nicht mehr los (erzeugt ein Down-Ereignis). Fehlt sowohl die <strong>D</strong>- als auch <strong>U</strong>-Option, wird ein vollst&auml;ndiger Mausklick (dr&uuml;cken und loslassen) gesendet.</p>
          <p><strong>U</strong>: L&auml;sst die Maustaste los (erzeugt ein Up-Ereignis). Diese Option sollte nicht verwendet werden, wenn die <strong>D</strong>-Option bereits aktiv ist (und umgekehrt).</p>
          <p><strong>Pos</strong>: Bewirkt, dass der X/Y-Positionierungsmodus bedingungslos verwendet wird, wie oben beim Parameter <em>Steuerelement-oder-Pos</em> beschrieben.</p>
          <p><strong>Xn</strong>: Ersetze <strong>n</strong> mit der X-Position, auf die geklickt werden soll, bezogen auf die obere linke Ecke des Steuerelements. Ansonsten erfolgt der Mausklick auf der horizontalen Mitte des Steuerelements.</p>
          <p><strong>Yn</strong>: Ersetze <strong>n</strong> mit der Y-Position, auf die geklickt werden soll, bezogen auf die obere linke Ecke des Steuerelements. Ansonsten erfolgt der Mausklick auf der vertikalen Mitte des Steuerelements.</p>
          <p>Verwende dezimale (nicht hexadezimale) Zahlen bei den Optionen <strong>X</strong> und <strong>Y</strong>.</p></td>
      </tr>
      <tr>
        <td>Titelausnahme</td>
        <td>Ignoriert Fenster, deren Titel diesen Wert enthalten.</td>
      </tr>
      <tr>
        <td>Textausnahme</td>
        <td>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</td>
      </tr>
    </table>
    <h3>ErrorLevel</h3>
    <p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszul&ouml;sen. F&uuml;r mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
    <p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt.</p>
    <h3 id="Reliability">Zuverl&auml;ssigkeit</h3>
    <p>Zur Verbesserung der Zuverl&auml;ssigkeit (besonders, wenn der Benutzer die Maus w&auml;hrend des ControlClick-Befehls physisch bewegt) k&ouml;nnte das eine oder andere vielleicht weiterhelfen:</p>
    <ul>
      <li>Benutze <code><a href="SetControlDelay.htm">SetControlDelay</a> -1</code> vor ControlClick. Dadurch wird verhindert, dass die Maustaste beim Klicken gedr&uuml;ckt gehalten wird, wodurch St&ouml;rungen durch physischen Mausbewegungen des Benutzers reduziert werden.</li>
      <li>F&uuml;ge NA im sechsten Parameter (<em>Optionen</em>) ein. Zum Beispiel: <code>ControlClick, Toolbar321, Fenstertitel,,,, NA</code>. Dadurch wird verhindert, dass das Fenster als aktiv markiert wird und dass sich die Eingabeverarbeitungen des Fensters und des Scripts vermischen, wodurch St&ouml;rungen durch physischen Mausbewegungen unterdr&uuml;ckt werden (aber &uuml;blicherweise nur, wenn das Fenster inaktiv ist). Allerdings funktioniert diese Methode nicht bei allen Fenster- und Steuerelementarten.</li>
    </ul>
    <h3>Bemerkungen</h3>
    <p>Einige Anwendungen ignorieren eine <em>Klickanzahl</em> h&ouml;her als 1 zum Drehen des Mausrads. Verwende bei solche Anwendungen eine Schleife wie folgt, um das Mausrad mehr als eine Rasterung zu drehen:</p>
    <pre>Loop, 5
    ControlClick, <i>Steuerelement</i>, <i>Fenstertitel</i>, <i>Fenstertext</i>, WheelUp</pre>
    <p>Fenstertitel und -texte unterscheiden zwischen Gro&szlig;- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>
    <h3>Verwandte Befehle</h3>
    <p><a href="SetControlDelay.htm">SetControlDelay</a>, <a href="Control.htm">Control</a>, <a href="ControlGet.htm">ControlGet</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlMove.htm">ControlMove</a>, <a href="ControlGetPos.htm">ControlGetPos</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlSend.htm">ControlSend</a>, <a href="Click.htm">Click</a></p>
    <h3>Beispiele</h3>
    <pre class="NoIndent">ControlClick, OK, Beliebiger Fenstertitel  <em>; Klickt die OK-Schaltfl&auml;che</em>
ControlClick, x55 y77, Fenstertitel  <em>; Klickt auf den Koordinaten. Beachte, dass das Komma zwischen X und Y fehlt.</em>

<em>; Die folgende Methode kann die Zuverl&auml;ssigkeit verbessern und Nebeneffekte reduzieren:</em>
SetControlDelay -1
ControlClick, Toolbar321, Fenstertitel,,,, NA x192 y10  <em>; Klickt im NA-Modus auf Koordinaten, die sich auf das angegebene Steuerelement beziehen.</em></pre>
  </div>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>