<!DOCTYPE HTML>
<html>
<head>
<title>ComObjArray()</title>
<meta name="keywords" content="Befehl, Funktion, COM, Objekt">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery-1.11.0.min.js"type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../navbar/NavScript.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <article>
      <h1>ComObjArray() <span class="ver">[v1.0.91+]</span></h1>
      <p>Erstellt einen SafeArray, das mit COM verwendbar ist.</p>
      <pre class="Syntax">ArrayObj := ComObjArray(VarTyp, Anzahl1 [, Anzahl2, ... Anzahl8])</pre>
      <h3>Parameter</h3>
      <table class="info">
        <tr>
          <td>VarTyp</td>
          <td>Der Basistyp des Arrays (der VARTYPE von jedem Array-Element). Der VARTYPE ist auf eine Teilmenge der Variantentypen beschränkt. Weder das VT_ARRAY- noch VT_BYREF-Flag kann gesetzt werden. VT_EMPTY und VT_NULL sind keine gültigen Basistypen für das Array. Alle anderen Typen sind gültig.
          <p>Siehe <a href="ComObjType.htm">ComObjType</a> für eine Liste von möglichen Werten.</p>
          </td>
        </tr>
        <tr>
          <td>Anzahl<i>N</i></td>
          <td>Die Größe jeder Dimension. Es werden Arrays mit bis zu 8 Dimensionen unterstützt.</td>
        </tr>
        <tr>
          <td>ArrayObj</td>
          <td>Ein Wrapper-Objekt mit dem SafeArray.</td>
        </tr>
      </table>
      <h3>Methoden</h3>
      <p>Array-Wrapper-Objekte unterstützen folgende Methoden:</p>
      <p><code class="Syntax">Array.MaxIndex(n)</code>: Gibt die Obergrenze der <i>n</i>-ten Dimension zurück. Ist <i>n</i> nicht vorhanden, gilt standardmäßig 1.</p>
      <p><code class="Syntax">Array.MinIndex(n)</code>: Gibt die Untergrenze der <i>n</i>-ten Dimension zurück. Ist <i>n</i> nicht vorhanden, gilt standardmäßig 1.</p>
      <p><code class="Syntax">Array.Clone()</code> <span class="ver">[v1.0.96.00+]</span>: Gibt eine Kopie des Arrays zurück.</p>
      <p><code class="Syntax">Array._NewEnum()</code> <span class="ver">[v1.0.96.00+]</span>: Wird üblicherweise nicht vom Script aufgerufen. <a href="For.htm">For-Schleifen</a> können mit SafeArrays verwendet werden.</p>
      <h3>Allgemeine Bemerkungen</h3>
      <p>Array-Wrapper-Objekte können auch von COM-Methoden und <a href="ComObjActive.htm">ComObjActive</a> zurückgegeben werden. Scripts können wie folgt überprüfen, ob ein Wert ein Array ist:</p>
      <pre>If ComObjType(<i>obj</i>) &amp; 0x2000
    MsgBox % "Array-Subtyp: " . ComObjType(obj) &amp; 0xfff
Else
    MsgBox Kein Array.</pre>
      <p>Es werden Arrays mit bis zu 8 Dimensionen unterstützt.</p>
      <p><span class="ver">[v1.0.96.00+]:</span> Da SafeArrays keine Mehrfachverweise unterstützen, wird beim Zuweisen eines SafeArrays an ein Element eines anderen SafeArrays eine separate Kopie erstellt. Das geschieht allerdings nur, wenn das Wrapper-Objekt das F_OWNVALUE-Flag hat, welches verantwortlich dafür ist, das Array zu zerstören. Dieses Flag kann mit <a href="ComObjFlags.htm">ComObjFlags</a> entfernt werden.</p>
      <h3>Verwandte Befehle</h3>
      <p><a href="ComObjType.htm">ComObjType</a>, <a href="ComObjValue.htm">ComObjValue</a>, <a href="ComObjActive.htm">ComObjActive</a>, <a href="ComObjFlags.htm">ComObjFlags</a>, <a href="http://msdn.microsoft.com/en-us/library/ms221145.aspx">Array Manipulation Functions (MSDN)</a></p>
      <h3>Beispiele</h3>
      <pre id="Ex1" class="NoIndent"><em>; Beispiel #1: Einfache Verwendung.</em>

arr := ComObjArray(VT_VARIANT:=12, 3)
arr[0] := "Auto"
arr[1] := "Hot"
arr[2] := "key"
Loop % arr.MaxIndex() + 1
   t .= arr[A_Index-1]
MsgBox % t

</pre>
      <pre id="Ex2" class="NoIndent"><em>; Beispiel #2: Mehrere Dimensionen.</em>

arr := ComObjArray(VT_VARIANT:=12, 3, 4)

<em>; Ermittelt die Anzahl an Dimensionen:</em>
dim := DllCall("oleaut32\SafeArrayGetDim", "ptr", ComObjValue(arr))

<em>; Ermittelt die Grenzen jeder Dimension:</em>
Loop %dim%
    dims .= arr.MinIndex(A_Index) " .. " arr.MaxIndex(A_Index) "`n"
MsgBox %dims%

<em>; Einfache Verwendung:</em>
Loop 3 {
    x := A_Index-1
    Loop 4 {
        y := A_Index-1
        arr[x, y] := x * y
    }
}
MsgBox % arr[2, 3]

</pre>
    </article>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>
