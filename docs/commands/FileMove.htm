<!DOCTYPE HTML>
<html>
<head>
<title>FileMove</title>
<meta name="keywords" content="Befehl, Datei">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <article>
      <h1>FileMove</h1>
      <p>Verschiebt oder benennt eine oder mehrere Dateien um.</p>
      <pre class="Syntax">FileMove, Quellmuster, Zielmuster [, Flag]</pre>
      <h3>Parameter</h3>
      <table class="info">
        <tr>
          <td>Quellmuster</td>
          <td>Der Name einer Datei oder eine musterbasierte Suche wie <code>C:\Temp\*.tmp</code>. Das <em>Quellmuster</em> befindet sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis, solange kein absoluter Pfad angegeben ist.</td>
        </tr>
        <tr>
          <td>Zielmuster</td>
          <td>Der Name oder Muster des Ziels, das sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis befindet, solange kein absoluter Pfad angegeben ist. Um eine einfache Verschiebung durchzuführen (vorhandene Dateinamen beibehalten), sollte nur der Ordnername angegeben werden. Siehe dazu folgende Beispiele, die funktional identisch sind:
          <pre>FileMove, C:\*.txt, C:\Eigener Ordner
FileMove, C:\*.txt, C:\Eigener Ordner\*.*</pre>
          </td>
        </tr>
        <tr>
          <td style="width: 15%;">Flag</td>
          <td style="width: 85%;">
          <p>(Optional) Dieser Parameter bestimmt, ob bereits vorhandene Dateien überschrieben werden dürfen:</p>
          <p>0 = (Standard) vorhandene Dateien nicht überschreiben<br>1 = vorhandene Dateien überschreiben</p>
          <p>Dieser Parameter kann ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein, auch einer, der als wahr oder falsch gewertet wird (weil True und False intern als 1 und 0 gespeichert sind).</p>
          </td>
        </tr>
      </table>
      <h3>ErrorLevel</h3>
      <p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
      <p>Bei Problemen enthält <a href="../misc/ErrorLevel.htm">ErrorLevel</a> die Anzahl an Dateien, die nicht verschoben werden konnten, ansonsten wird ErrorLevel auf 0 gesetzt. Allerdings wird ErrorLevel auch auf 0 gesetzt, wenn die Quelldatei eine einzelne Datei (ohne Platzhalter) ist und nicht existiert. Um diesen Zustand zu erkennen, verwende <a href="IfExist.htm">IfExist</a> oder <a href="../Functions.htm#FileExist">FileExist()</a>, bevor die Quelldatei verschoben wird.</p>
      <p>Im Gegensatz zu <a href="FileCopy.htm">FileCopy</a> wird das Verschieben einer Datei auf sich selbst immer als Erfolg angesehen, selbst wenn der Überschreibmodus nicht aktiv ist.</p>
      <p>Falls Dateien gefunden wurden, wird <a href="../Variables.htm#LastError">A_LastError</a> auf 0 gesetzt, oder auf den aktuellsten Rückgabewert der Systemfunktion GetLastError(). Ansonsten enthält A_LastError einen Fehlercode, der darauf hinweist, warum keine Dateien gefunden wurden.</p>
      <h3>Bemerkungen</h3>
      <p>FileMove verschiebt nur Dateien. Um stattdessen den Inhalt eines Ordners zu verschieben (alle Dateien und Unterordner), sieht die Beispiele weiter unten. Um einen einzelnen Ordner zu verschieben oder umzubenennen, verwende <a href="FileMoveDir.htm">FileMoveDir</a>.</p>
      <p>Die Operation wird auch dann fortgesetzt, wenn Fehler auftreten.</p>
      <p>Dieser Befehl in der Lage ist, Dateien auf andere Datenträger zu verschieben. Beachte jedoch, dass das Verschieben auf gleichen Datenträgern schneller ist, als auf unterschiedlichen Datenträgern, weil die Dateien hierbei nur umbenannt werden.</p>
      <h3>Verwandte Befehle</h3>
      <p><a href="FileCopy.htm">FileCopy</a>, <a href="FileCopyDir.htm">FileCopyDir</a>, <a href="FileMoveDir.htm">FileMoveDir</a>, <a href="FileDelete.htm">FileDelete</a></p>
      <h3>Beispiele</h3>
      <pre class="NoIndent">FileMove, C:\Eigene Dokumente\Liste1.txt, D:\Backup\  <em>; Verschiebt die Datei, ohne sie umzubenennen.</em>
FileMove, C:\Datei vorher.txt, C:\Datei nachher.txt  <em>; Benennt eine Datei um.</em>
FileMove, C:\Ordner1\*.txt, D:\Neuer Ordner\*.bkp  <em>; Verschiebt und benennt die Erweiterung der Dateien um.</em></pre>
      <p>&nbsp;</p>
      <pre class="NoIndent"><em>; Das folgende Beispiel verschiebt alle Dateien und Unterordner in einem anderen Ordner:</em>
Fehleranzahl := VerschiebeDateienUndOrdner("C:\Eigener Ordner\*.*", "D:\Zielordner für Dateien &amp; Ordner")
If Fehleranzahl &lt;&gt; 0
    MsgBox %Fehleranzahl% Dateien/Ordner konnten nicht verschoben werden.

VerschiebeDateienUndOrdner(Quellmuster, Zielordner, Überschreiben = false)
<em>; Verschiebt alle Dateien und Ordner vom Quellmuster in dem Zielordner und
; gibt die Anzahl an Dateien/Ordnern zurück, die nicht verschoben werden konnten. Diese Funktion benötigt v1.0.38+, weil der 2. Modus von FileMoveDir verwendet wird.</em>
{
    If Überschreiben = 1
        Überschreiben = 2  <em>; Siehe <a href="FileMoveDir.htm">FileMoveDir</a> für die Beschreibung vom 1. und 2. Modus.</em>
    <em>; Zuerst alle Dateien verschieben (aber nicht die Ordner):</em>
    FileMove, %Quellmuster%, %Zielordner%, %Überschreiben%
    Fehleranzahl := ErrorLevel
    <em>; Jetzt alle Ordner verschieben:</em>
    Loop, %Quellmuster%, 2  <em>; 2 bedeutet "nur Ordner".</em>
    {
        FileMoveDir, %A_LoopFileFullPath%, %Zielordner%\%A_LoopFileName%, %Überschreiben%
        Fehleranzahl += ErrorLevel
        If ErrorLevel  <em>; Jeden Problemordner mit Namen anzeigen.</em>
            MsgBox %A_LoopFileFullPath% kann nicht nach %Zielordner% verschoben werden.
    }
    Return Fehleranzahl
}</pre>
    </article>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>
