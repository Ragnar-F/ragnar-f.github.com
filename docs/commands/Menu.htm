<!DOCTYPE HTML>
<html>
<head>
<title>Menu</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>Menu</h1>

<p>Erstellt, löscht, ändert und zeigt Menüs und Menüpunkte. Ändert das Tray-Icon und dazugehörige ToolTip. Kontrolliert, ob das Hauptfenster eines <a href="../Scripts.htm#ahk2exe">kompilierten Scripts</a> geöffnet werden kann.</p>

<pre class="Syntax">Menu, Menüname, Befehl [, P3, P4, P5]</pre>
<h3>Parameter</h3>
<dl>

  <dt>Menüname</dt>
  <dd><p>Kann das Wort TRAY oder den Name eines benutzerdefinierten Menüs enthalten. Ein benutzerdefiniertes Menü wird automatisch erstellt, sobald dessen Name mit dem <em>Add</em>-Befehl verwendet wird. Zum Beispiel: <code>Menu, MeinMenü, Add, Element1</code>.</p>
      <p>Wurde ein benutzerdefiniertes Menü erstellt, kann es mit dem <em>Show</em>-Befehl angezeigt werden. Mit dem <em>Add</em>-Befehl kann es zudem als Untermenü an andere Menüs angefügt werden.</p></dd>

  <dt>Befehl, P3, P4, P5</dt>
  <dd><p>Diese 4 Parameter sind voneinander abhängig. Siehe untere Liste für die erlaubten Kombinationen.</p></dd>

</dl>

<h2>Hinzufügen oder Ändern von Menüpunkten</h2>
<p><strong>Add [, Menüpunktname, Label-oder-Untermenü, Pn]</strong>: Dieser vielseitige Befehl kann ein Menüpunkt hinzufügen, ihn mit einem neuen Untermenü oder Label versehen oder ihn in ein Untermenü umwandeln (oder umgekehrt). Falls <em>Menüpunktname</em> noch nicht vorhanden ist, wird dieser ins Menü eingefügt. Ansonsten wird <em>Menüpunktname</em> mit dem neu angegebenen <em>Label-oder-Untermenü</em> versehen.</p>
<p>Um eine Trennlinie ins Menü einzufügen, müssen alle drei Parameter weggelassen werden.</p>
<p>Die Label-Subroutine wird als neuer <a href="../misc/Threads.htm">Thread</a> ausgeführt, sobald der Benutzer den Menüpunkt auswählt (vergleichbar mit <a href="Gosub.htm">Gosub</a> und <a href="../Hotkeys.htm">Hotkey-Subroutinen</a>). Falls <em>Label-oder-Untermenü</em> weggelassen wird, dient <em>Menüpunktname</em> sowohl als Labelname als auch als Menüpunktname.</p>
<p>Damit der <em>Menüpunktname</em> zum Untermenü wird (ein Menüpunkt, der beim Auswählen ein neues Menü öffnet), muss in <em>Label-oder-Untermenü</em> ein Doppelpunkt angegeben werden, gefolgt vom <em>Menünamen</em> eines vorhandenen benutzerdefinierten Menüs. Zum Beispiel:</p>
<pre>Menu, MeinUntermenü, Add, Element1
Menu, Tray, Add, Dieser Menüpunkt ist ein Untermenü, :MeinUntermenü</pre>
<p>Der letzte Parameter kann den Buchstaben P enthalten, gefolgt von der <a href="../misc/Threads.htm">Thread-Priorität</a> des Menüs, z. B. <code>P1</code>. Falls dieser Parameter beim Hinzufügen eines Menüpunktes weggelassen wird, gilt eine Priorität von 0 (Standardwert). Falls dieser Parameter beim Aktualisieren eines Menüpunktes weggelassen wird, bleibt die aktuelle Priorität unverändert. Um nur die Priorität eines vorhandenen Menüpunkts zu ändern, sollte der Parameter <em>Label-oder-Untermenü</em> weggelassen werden. Für die Priorität kann nur eine Dezimalzahl angegeben werden (nicht hexadezimal).</p>
<p><strong><a name="Delete"></a>Delete [, Menüpunktname]</strong>: Bewirkt, dass <em>Menüpunktname</em> aus dem Menü gelöscht wird. Voreingestellte Menüpunkte wie Exit können nicht einzeln gelöscht werden. Falls der <em>Standard</em>-Menüpunkt gelöscht wird, gilt der Effekt der <em>NoDefault</em>-Option. Falls <em>Menüpunktname</em> weggelassen wird, wird das ganze Menü <em>Menüname</em> gelöscht, einschließlich Menüpunkte von anderen Menüs, die <em>Menüname</em> als Untermenü verwenden.</p>
<p><strong>DeleteAll</strong>: Bewirkt, dass alle benutzerdefinierten Menüpunkte aus dem Menü gelöscht werden. Dabei wird das Menü nicht zerstört, sondern einfach nur leer gelassen, solange nicht die <em>voreingestellten</em> Menüpunkte enthalten sind (siehe unten). Im Gegensatz zu einem Menü, das komplett mit dem Befehl <em>Delete</em> (siehe oben) gelöscht wurde, existiert weiterhin ein leeres Menü. Folglich werden andere Menüs, die diesen als Untermenü verwenden, solche Untermenüs beibehalten.</p>
<p><strong>Rename, Menüpunktname [, Neuname]</strong>: Bewirkt, dass <em>Menüpunktname</em> in <em>Neuname</em> umbenannt wird (falls <em>Neuname</em> leer ist, wird <em>Menüpunktname</em> in eine Trennlinie umgewandelt). <em>Neuname</em> darf nicht der Name eines vorhandenen benutzerdefinierten Menüpunkts sein. Das aktuelle Ziel-Label oder Untermenü des Menüpunkts bleibt unverändert.</p>
<p><strong>Check, Menüpunktname</strong>: Setzt ein sichtbares Häkchen neben <em>Menüpunktname</em> (falls noch nicht vorhanden).</p>
<p><strong>Uncheck, Menüpunktname</strong>: Entfernt das Häkchen (falls vorhanden) von <em>Menüpunktname</em>.</p>
<p><strong>ToggleCheck, Menüpunktname</strong>: Fügt ein Häkchen hinzu, falls noch nicht vorhanden, ansonsten wird es entfernt.</p>
<p><strong>Enable, Menüpunktname</strong>: Erlaubt dem Benutzer, <em>Menüpunktname</em> wieder auszuwählen, falls dieser zuvor deaktiviert (ergraut) wurde.</p>
<p><strong>Disable, Menüpunktname</strong>: Bewirkt, dass <em>Menüpunktname</em> grau gemacht wird, wodurch dieser nicht länger vom Benutzer ausgewählt werden kann.</p>
<p><strong>ToggleEnable, Menüpunktname</strong>: Deaktiviert <em>Menüpunktname</em>, falls dieser zuvor aktiviert war, ansonsten wird er aktiviert.</p>
<p><strong>Default [, Menüpunktname]</strong>: Bewirkt, dass <em>Menüpunktname</em> zum Standard-Menüpunkt wird, in fetter Schrift dargestellt (nur für TRAY sinnvoll; das Setzen des Standard-Menüpunkts in anderen Menüs ist rein kosmetischer Natur). Wenn der Benutzer das Tray-Icon zweimal anklickt, wird dessen Standard-Menüpunkt ausgeführt. Ist dieser nicht vorhanden, hat Doppelklick keine Wirkung. Falls <em>Menüpunktname</em> weggelassen wird, gilt der Effekt der <em>NoDefault</em>-Option.</p>
<p><strong>NoDefault</strong>: Beim Tray-Menü: Bewirkt, dass der voreingestellte Standard-Menüpunkt wiederhergestellt wird - bei unkompilierten Scripts ist das OPEN und bei <a href="../Scripts.htm#ahk2exe">kompilierten Scripts</a> nichts (außer wenn die <em>MainWindow</em>-Option aktiv ist). Falls der Menüpunkt OPEN durch Verwenden des NoStandard-Befehls (siehe unten) nicht vorhanden ist, existiert kein Standard-Menüpunkt. Folglich hat ein Doppelklick auf das Tray-Icon keine Wirkung. Bei sonstigen Menüs: Die Schrift des Standard-Menüpunkts (falls vorhanden) wird nicht länger fett dargestellt.</p>
<p><strong>Standard</strong>: Bewirkt, dass die voreingestellten Menüpunkte ans untere Ende des Menüs eingefügt werden (falls noch nicht vorhanden). Dieser Befehl kann mit einem beliebigen Menü verwendet werden (auch TRAY).</p>
<p><strong>NoStandard</strong>: Entfernt alle voreingestellten Menüpunkte (nicht benutzerdefinierten) aus dem Tray-Menü (sofern vorhanden).</p>
<h2 id="MenuIcon">Setzen oder Entfernen von Menüpunkt-Icons <span class="ver">[AHK_L 17 +]</span></h2>
<p><strong>Icon, Menüpunktname, Dateiname [, Iconnummer, Iconbreite]</strong>: Setzt das Icon für <em>Menüpunktname</em>. <em>Dateiname</em> ist entweder eine Icondatei oder ein Bildformat, das von AutoHotkey unterstützt wird. Um von der Datei anstelle der ersten Icon-Gruppe eine andere zu verwenden, kann deren Nummer bei <em>Iconnummer</em> angegeben werden (falls weggelassen, standardmäßig 1). Wenn <em>Iconnummer</em> negativ ist, wird davon ausgegangen, dass sein absoluter Wert die Ressourcen-ID eines Icons innerhalb einer ausführbaren Datei ist. In <em>Iconbreite</em> kann die gewünschte Breite des Icons angegeben werden. Falls die angegebene Icon-Gruppe in <em>Iconnummer</em> mehrere Größen enthält, wird die beste Übereinstimmung verwendet und das Icon auf die angegebene Größe skaliert. Siehe Beispiel-Abschnitt für Anwendungsbeispiele.</p>
<p>Derzeit ist es notwendig, die tatsächliche Größe anzugeben, wenn die Transparenz des Icons in Windows Vista oder höher bewahrt werden soll. Zum Beispiel:</p>
<pre>Menu, Menüname, Icon, Menüpunktname, Dateiname.png,, 0</pre>
<p>Bekannte Einschränkung: Icons auf GUI-Menüleisten werden in Windows XP und höher falsch positioniert.</p>
<p><strong>NoIcon, Menüpunktname</strong>: Entfernt das Icon von <em>Menüpunktname</em>, falls vorhanden.
<h2>Ändern des Tray-Icons oder ToolTips <span class="ver">(<em>Menüname</em> muss TRAY sein)</span></h2>
<p><strong><a name="Icon"></a>Icon [, Dateiname, Iconnummer, 1]</strong>: Bewirkt, dass für das Script-Icon ein Icon von <em>Dateiname</em> verwendet wird. Folgende Dateitypen werden unterstützt: ICO, CUR, ANI, EXE, DLL, CPL, SCR und andere Typen, die Icon-Ressourcen enthalten. Um von der Datei anstelle der ersten Icon-Gruppe eine andere zu verwenden, kann deren Nummer bei <em>Iconnummer</em> angegeben werden (falls weggelassen, standardmäßig 1). Zum Beispiel würde die Angabe von <strong>2</strong> bewirken, dass das Standard-Icon von der zweiten Icon-Gruppe verwendet wird. Wenn <em>Iconnummer</em> negativ ist, wird davon ausgegangen, dass sein absoluter Wert die Ressourcen-ID eines Icons innerhalb einer ausführbaren Datei ist. Mit einem Sternchen (*) in <em>Dateiname</em> wird das Standard-Icon wiederhergestellt.</p>
<p>Der letzte Parameter: Mit einer 1 im letzten Parameter wird das Icon blockiert, mit 0 wieder freigegeben (oder leer lassen, um den aktuellen Status zu belassen). Falls das Icon blockiert wurde, kann es von <a href="Pause.htm">Pause</a> und <a href="Suspend.htm">Suspend</a> nicht geändert werden. Hinweis: Um das <em>aktuelle</em> Icon zu blockieren oder freizugeben, muss 1 oder 0 wie folgt verwendet werden: <code>Menu, Tray, Icon,,, 1</code>.</p>
<p>Sobald das Tray-Icon geändert wird, ändert sich auch das Icon bei <a href="InputBox.htm">InputBox</a>, <a href="Progress.htm">Progress</a> und danach erstellte <a href="Gui.htm">GUI</a>-Fenster. <a href="../Scripts.htm#ahk2exe">Kompilierte Scripts</a> sind davon auch betroffen, selbst dann, wenn ein benutzerdefiniertes Icon bei der Kompilierung angegeben wurde. Hinweis: Das Ändern des Icons macht das Tray-Icon nicht wieder sichtbar, falls es zuvor beispielsweise mit <a href="_NoTrayIcon.htm">#NoTrayIcon</a> versteckt wurde; stattdessen sollte <code>Menu, Tray, Icon</code> (ohne Parameter) verwendet werden.</p>
<p><a name="distort"></a>Es können leichte Verformungen auftreten, wenn ein Icon ins Tray-Icon geladen wird, das nicht von einer ICO-Datei stammt. Das gilt besonders für 16x16-Icons. Um das zu verhindern, muss das gewünschte Icon in eine ICO-Datei gespeichert werden.</p>
<p>Es gibt einige Icons in DLL- und CPL-Dateien des Betriebssystems, die nützlich sein könnten. Zum Beispiel: <code>Menu, Tray, Icon, Shell32.dll, 174</code>.</p>
<p>Die integrierten Variablen <strong>A_IconNumber</strong> und <strong>A_IconFile</strong> enthalten die Nummer und Namen (mit vollständigen Pfad) des aktuellen Icons (beide sind leer, wenn das Standard-Icon verwendet wird).</p>
<p><strong>Icon</strong> (ohne Parameter): Erstellt das Tray-Icon, sofern noch nicht vorhanden. Dabei wird <a href="_NoTrayIcon.htm">#NoTrayIcon</a> überschrieben, falls diese Direktive auch im Script vorhanden ist.</p>
<p><strong>NoIcon</strong>: Entfernt das Tray-Icon, sofern vorhanden. Falls dieser Befehl ganz oben im Script verwendet wird, ist das Tray-Icon beim Starten des Scripts möglicherweise noch kurz sichtbar. Um das zu verhindern, sollte stattdessen <a href="_NoTrayIcon.htm">#NoTrayIcon</a> verwendet werden. Die integrierte Variable <strong>A_IconHidden</strong> enthält eine 1, wenn das Tray-Icon zurzeit versteckt ist, andernfalls 0.</p>
<p><strong>Tip [, Text]</strong>: Ändert den ToolTip des Tray-Icons (wird angezeigt, wenn sich der Mauszeiger darüber befindet). Wenn der Tooltip mehrzeilig sein soll, verwende zwischen jeder Zeile das Zeilenumbruchszeichen (`n), zum Beispiel Zeile1`nZeile2. Nur die ersten 127 Zeichen vom <em>Text</em> werden angezeigt, zudem wird <em>Text</em> beim ersten Tabulatorzeichen abgeschnitten, falls vorhanden. Durch Weglassen von <em>Text</em> wird der Standardtext des ToolTips wiederhergestellt. Die integrierte Variable <strong>A_IconTip</strong> enthält den aktuellen Text des ToolTips (leer, wenn der Standardtext verwendet wird).</p>
<h2>Verschiedene Befehle</h2>
<p><strong><a name="Show"></a>Show [, X, Y]</strong>: Zeigt <em>Menüname</em> an, bei dem der Benutzer ein Menüpunkt mit Pfeiltasten, Tastenkürzel (unterstrichene Buchstaben) oder der Maus auswählen kann. Mit Ausnahme der <a href="Gui.htm">GUI</a>-Menüleiste kann jedes Menü angezeigt werden, auch das Tray-Menü. Sobald X als auch Y weggelassen wird, wird das Menü auf der aktuellen Position des Mauszeigers angezeigt. Falls eine Koordinate fehlt, wird dafür die Position des Mauszeigers verwendet. Die Koordinaten beziehen sich auf das aktive Fenster. Durch Angabe von "<a href="CoordMode.htm">CoordMode</a>, Menu" davor beziehen sich die Koordinaten auf dem ganzen Bildschirm.</p>
<p><strong>Color, Farbwert [, Single]</strong>: Bewirkt, dass die Hintergrundfarbe des Menüs auf den angegebenen <em>Farbwert</em> gesetzt wird, der entweder der Name einer HTML-Hauptfarbe oder ein 6-stelliger RGB-Wert ist (siehe <a href="Progress.htm#colors">Farbtabelle</a>). Sobald <em>Farbwert</em> leer ist (oder das Wort Default enthält), wird die Standardfarbe des Menüs wiederhergestellt. Falls das Wort Single im nächsten Parameter weggelassen wird, werden auch alle Untermenüs, die an diesem Menü angefügt wurden, farblich geändert.</p>
<p><strong>Click, Klickanzahl</strong>: Die Angabe von 1 in <em>Klickanzahl</em> bewirkt, dass der Standard-Menüpunkt des Tray-Menüs mit einem einzigen Klick aktiviert werden kann. Mit einer 2 in <em>Klickanzahl</em> wird das Standardverhalten wiederhergestellt (Doppelklick). Zum Beispiel: <code>Menu, Tray, Click, 1</code>.</p>
<p><strong><a name="MainWindow"></a>MainWindow</strong>: Dieser Befehl funktioniert nur bei <a href="../Scripts.htm#ahk2exe">kompilierten Scripts</a>. Dieser Befehl macht es möglich, dass das Hauptfenster des Scripts über das Tray-Icon geöffnet werden kann (standardmäßig nicht möglich). Dadurch werden auch Menüpunkte wie "Lines most recently executed" im Hauptfenster aktiviert, um den Quellcode des Scripts und andere Informationen anzeigen zu lassen. <em>Menüname</em> muss TRAY sein.</p>
<p><strong>NoMainWindow</strong> (Standard): Dieser Befehl funktioniert nur bei <a href="../Scripts.htm#ahk2exe">kompilierten Scripts</a>. Dieser Befehl stellt das Standardverhalten des Scripts wieder her - das heißt, es wird verhindert, dass das Hauptfenster geöffnet werden kann. Selbst während diese Option aktiv ist, können folgende Befehle weiterhin das Hauptfenster anzeigen, falls diese bei Laufzeit erreicht werden: <a href="ListLines.htm">ListLines</a>, <a href="ListVars.htm">ListVars</a>, <a href="ListHotkeys.htm">ListHotkeys</a> und <a href="KeyHistory.htm">KeyHistory</a>. <em>Menüname</em> muss TRAY sein.</p>
<p><strong>UseErrorLevel [, off]</strong>: Falls diese Option nie im Script verwendet wird, gilt standardmäßig OFF. Die Einstellung OFF bewirkt, dass ein Dialogfenster angezeigt und der <a href="../misc/Threads.htm">aktuelle Thread</a> beendet wird, sobald der Menübefehl einen Fehler erzeugt. Mit <code>Menu, Tray, UseErrorLevel</code> wird das Dialogfenster und Beenden des Threads unterdrückt, dabei wird <a href="../misc/ErrorLevel.htm">Errorlevel</a> bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt. Um diese Option wieder zu deaktivieren, muss OFF im nächsten Parameter angegeben werden. Diese Einstellung ist global, d. h. alle Menüs werden beeinflusst, nicht nur <em>Menüname</em>.</p>
<h2>Bemerkungen</h2>
<p>Um einen der Buchstaben im Namen <em>eines</em> Menüpunktnamens zu unterstreichen, muss vor diesem Buchstaben ein Und-Zeichen (&amp;) eingefügt werden. Sobald das Menü angezeigt wird, kann dieser Menüpunkt durch Drücken der entsprechenden Taste ausgewählt werden. Für die literale Darstellung eines Und-Zeichen müssen zwei aufeinanderfolgende Und-Zeichen wie folgt angegeben werden: "Save &amp;&amp; Exit"</p>
<p>Die Namen der Menüs und Menüpunkte können bis zu 260 Zeichen lang sein.</p>
<p>Beim Verweis auf vorhandene Menüs oder Menüpunkte spielt die Groß- und Kleinschreibung keine Rolle - das Und-Zeichen jedoch muss mit angegeben werden. Zum Beispiel: &amp;Open</p>
<p>Mit <code>Menu, Tray, Add</code> (ohne den restlichen Parametern) können Trennlinien hinzugefügt werden. Der einzige Nachteil ist, dass Trennlinien nicht einzeln gelöscht werden können. Als Übergangslösung sollte zuerst <code>Menu, Tray, DeleteAll</code> verwendet und danach die benutzerdefinierten Menüpunkte nochmals hinzugefügt werden.</p>
<p>Neue Menüpunkte werden immer ans untere Ende des Menüs anfügt. Beim Tray-Menü: Damit die benutzerdefinierten Menüpunkte über den voreingestellten Menüpunkten angezeigt werden (nachdem die benutzerdefinierten Menüpunkte hinzugefügt wurden), muss <code>Menu, Tray, NoStandard</code> und danach <code>Menu, Tray, Standard</code> ausgeführt werden.</p>
<p>Es ist nicht möglich, voreingestellte Menüpunkte wie "Pause Script" und "Suspend Hotkeys" mit Menü-Unterbefehlen einzeln zu bearbeiten.</p>
<p>Ist ein Menü komplett leer (z. B. mithilfe von <code>Menu, MeinMenü, DeleteAll</code>), kann es nicht angezeigt werden. Falls das Tray-Menü leer ist, hat Rechtsklick oder Doppelklick auf das Tray-Icon keine Wirkung (in solchen Fällen ist es normalerweise besser, <a href="_NoTrayIcon.htm">#NoTrayIcon</a> zu verwenden).</p>
<p>Wenn die Subroutine des Menüpunkts bereits läuft und der Benutzer diesen Menüpunkt wieder auswählt, wird ein neuer <a href="../misc/Threads.htm">Thread</a> erstellt, der die gleiche Subroutine ausführt und den vorherigen Thread unterbricht. Um solche Ereignisse stattdessen nach hinten zu verschieben, sollte <a href="Critical.htm">Critical</a> auf der ersten Zeile der Subroutine angegeben werden (allerdings werden dadurch auch andere Threads zwischengespeichert/nach hinten verschoben, wie das Drücken eines Hotkeys).</p>
<p>Sobald eine Subroutine durch einen Menüpunkt ausgeführt wird, beginnt diese mit den Standardwerten von Einstellungen wie <a href="SendMode.htm">SendMode</a>. Diese Standardwerte können im <a href="../Scripts.htm#auto">automatischen Ausführungsbereich</a> geändert werden.</p>
<p>Die integrierten Variablen <strong><a href="../Variables.htm#ThisMenuItem">A_ThisMenuItem</a></strong> und <strong><a href="../Variables.htm#ThisMenuItemPos">A_ThisMenuItemPos</a></strong> enthalten den Namen und die Position des benutzerdefinierten Menüpunkts, der zuletzt vom Benutzer ausgewählt wurde (leer, wenn kein Menüpunkt ausgewählt wurde). Ebenso enthält <strong>A_ThisMenu</strong> den Namen des Menüs, bei dem <strong>A_ThisMenuItem</strong> ausgewählt wurde. Diese Variablen sind beim Erstellen eines Menüs nützlich, dessen Inhalt nicht gleich bleibt. In so einem Fall sollten alle Menüpunkte auf das gleiche Label verweisen, welches auf die oben genannten Variablen zurückgreift, um zu bestimmen, welche Maßnahmen ergriffen werden sollen.</p>
<p>Für die dauerhafte Aufrechterhaltung eines Scripts, das weder Hotkeys noch <a href="Gui.htm">GUI</a> enthält (zum Beispiel jedoch benutzerdefinierte Menüs oder Menüpunkte), kann <a href="_Persistent.htm">#Persistent</a> verwendet werden.</p>
<h2>Siehe auch</h2>
<p><a href="Gui.htm">GUI</a>, <a href="../misc/Threads.htm">Threads</a>, <a href="Thread.htm">Thread</a>, <a href="Critical.htm">Critical</a>, <a href="_NoTrayIcon.htm">#NoTrayIcon</a>, <a href="Gosub.htm">Gosub</a>, <a href="Return.htm">Return</a>, <a href="SetTimer.htm">SetTimer</a>, <a href="_Persistent.htm">#Persistent</a></p>
<h2>Beispiele</h2>
<pre class="NoIndent"><em>; BEISPIEL #1: Mit diesem Script wird ein neuer Menüpunkt ans Ende des Tray-Icon-Menüs angefügt.</em>

#Persistent  <em>; Hält das Script aufrecht, bis der Benutzer es beendet.</em>
Menu, Tray, Add  <em>; Erstellt eine Trennlinie.</em>
Menu, Tray, Add, Element1, MenuHandler  <em>; Erstellt einen neuen Menüpunkt.</em>
return

MenuHandler:
MsgBox Sie haben %A_ThisMenuItem% im Menü %A_ThisMenu% ausgewählt.
return</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; BEISPIEL #2: Mit diesem Script wird ein aufklappbares Menü erstellt, das angezeigt wird, sobald der Benutzer WIN+Z drückt.</em>

<em>; Erstellt ein aufklappbares Menü durch Hinzufügen von Menüpunkten.</em>
Menu, MeinMenü, Add, Element1, MenuHandler
Menu, MeinMenü, Add, Element2, MenuHandler
Menu, MeinMenü, Add  <em>; Fügt eine Trennlinie hinzu.</em>

<em>; Erstellt ein weiteres Menü, das als Untermenü für das obige Menü dient.</em>
Menu, Submenu1, Add, Element1, MenuHandler
Menu, Submenu1, Add, Element2, MenuHandler

<em>; Erstellt ein Untermenü im ersten Menüpunkt (mit einem nach rechts gerichteten Pfeil). Sobald der Benutzer diesen auswählt, wird das zweite Menü angezeigt.</em>
Menu, MeinMenü, Add, Mein Untermenü, :Submenu1

Menu, MeinMenü, Add  <em>; Setzt eine Trennlinie unter dem Untermenü.</em>
Menu, MeinMenü, Add, Element3, MenuHandler  <em>; Setzt einen weiteren Menüpunkt unter dem Untermenü.</em>
return <em>; Ende des automatischen Ausführungsbereichs.</em>

MenuHandler:
MsgBox Sie haben %A_ThisMenuItem% im Menü %A_ThisMenu% ausgewählt.
return

#z::Menu, MeinMenü, Show  <em>; WIN+Z drücken, um das Menü anzuzeigen.</em></pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; BEISPIEL #3: Dieses Script demonstriert einige Menübefehle.</em>

#Persistent
#SingleInstance
Menu, Tray, Add <em>; Trennlinie</em>
Menu, Tray, Add, TestToggle&amp;Check

Menu, Tray, Add, TestToggleEnable
Menu, Tray, Add, TestDefault
Menu, Tray, Add, TestStandard
Menu, Tray, Add, TestDelete
Menu, Tray, Add, TestDeleteAll
Menu, Tray, Add, TestRename
Menu, Tray, Add, Test
return

<em>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</em>

TestToggle&amp;Check:

Menu, Tray, ToggleCheck, TestToggle&amp;Check

Menu, Tray, Enable, TestToggleEnable <em>; Aktiviert auch den nächsten Test, da dieser seine Deaktivierung selbst nicht rückgängig machen kann.</em>
Menu, Tray, Add, TestDelete <em>; Das Gleiche wie oben.</em>
return

TestToggleEnable:
Menu, Tray, ToggleEnable, TestToggleEnable
return

TestDefault:
if default = TestDefault
{
    Menu, Tray, NoDefault
    default =
}
else
{
    Menu, Tray, Default, TestDefault
    default = TestDefault
}
return

TestStandard:
if standard &lt;&gt; n
{
    Menu, Tray, NoStandard
    standard = n
}
else
{
    Menu, Tray, Standard
    standard = y
}
return

TestDelete:
Menu, Tray, delete, TestDelete
return

TestDeleteAll:
Menu, Tray, DeleteAll
return

TestRename:
if Neuname &lt;&gt; renamed
{
    Altname = TestRename
    Neuname = renamed
}
else
{
    Altname = renamed
    Neuname = TestRename
}
Menu, Tray, rename, %Altname%, %Neuname%
return

Test:
MsgBox Sie haben %A_ThisMenuItem% im Menü %A_ThisMenu% ausgewählt.
return</pre>
<pre class="NoIndent"><em>; BEISPIEL #4: Mit diesem Script werden Icons zu den Menüpunkten hinzufügt.</em>
Menu, Dateimenü, Add, Script-Icon, MenuHandler
Menu, Dateimenü, Add, Sperren-Icon, MenuHandler
Menu, Dateimenü, Add, Pause-Icon, MenuHandler
Menu, Dateimenü, Icon, Script-Icon, %A_AhkPath%, 2 <em>; Verwendet die zweite Icongruppe von der Datei.</em>
Menu, Dateimenü, Icon, Sperren-Icon, %A_AhkPath%, -206 <em>; Verwendet das Icon mit dem Ressourcen-Bezeichner 206.</em>
Menu, Dateimenü, Icon, Pause-Icon, %A_AhkPath%, -207 <em>; Verwendet das Icon mit dem Ressourcen-Bezeichner 207.</em>
Menu, MeineMenüleiste, Add, &amp;Datei, :Dateimenü
Gui, Menu, MeineMenüleiste
Gui, Add, Button, gExit, Dieses Beispiel beenden
Gui, Show
MenuHandler:
Return

Exit:
ExitApp
</pre>
</body>
</html>
