<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>GuiControl</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>GuiControl</h1>

<p>Erm&ouml;glicht &Auml;nderungen eines Steuerelements in einem GUI-Fenster.</p>

<pre class="Syntax">GuiControl, Unterbefehl, SteuerelementID [, Param3] </pre>
<h3>Parameter</h3>
<table class="info">
  <tbody>
<tr>
    <td>Unterbefehl</td>
    <td>Siehe untere Liste.</td>
  </tr>
  <tr>
    <td width="15%">SteuerelementID</td>
    <td width="85%">
<p>Wenn das Ziel-Steuerelement eine zugewiesene Variable hat, dann kann der Name der Variable als <em>SteuerelementID</em> angegeben werden (diese Methode hat Vorrang vor der n&auml;chsten Methode). Daher ist es am besten, dem Steuerelement eine Variable zuzuweisen, auf das sp&auml;ter mit GuiControl oder GuiControlGet zugegriffen wird, selbst wenn es nicht eingabef&auml;hig ist (z. B. GroupBox oder Text).</p>
      <p>Ansonsten ist die <em>SteuerelementID</em> entweder die ClassNN (Klassenname und Instanznummer des Steuerelements) oder der Name/Text des Steuerelements, die beide mit Windows Spy ermittelt werden k&ouml;nnen. Wenn Name/Text verwendet wird, wird das &Uuml;bereinstimmungsverhalten mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> bestimmt. Hinweis: Der Dateiname eines Picture-Steuerelements kann auch als <em>SteuerelementID</em> verwendet werden.</p>
      <p><span class="ver">[v1.1.04+]:</span> <em>SteuerelementID</em> kann das <a href="Gui.htm#HwndOutputVar">HWND</a> des Steuerelements sein.</p></td>
  </tr>
  <tr>
    <td>Param3</td>
    <td>Dieser Parameter kann weggelassen werden, solange er nicht von einem Unterbefehl aus der unteren Liste ben&ouml;tigt wird.</td>
  </tr>
</tbody></table>

<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszul&ouml;sen. F&uuml;r mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, wenn das angegebene Fenster/Steuerelement nicht existiert oder ein anderes Problem aufgetreten ist. Ansonsten auf 0.</p>
<h3>Unterbefehle</h3>
<p><strong>(Leer)</strong>: Wenn der <em>Unterbefehl</em> leer ist, dann k&ouml;nnen neue Inhalte &uuml;ber <em>Param3</em> in das Steuerelement eingef&uuml;gt werden. Im Einzelnen:</p>
<p><a href="GuiControls.htm#Picture">Picture</a>: Ersetzt <em>Param3</em> mit dem Dateinamen des neuen Bildes, das geladen werden soll (siehe <a href="GuiControls.htm#Picture">Gui Picture</a> f&uuml;r unterst&uuml;tzte Dateitypen). Beliebig viele Optionen k&ouml;nnen direkt vor dem Dateinamen angegeben werden: *wN (Breite N), *hN (H&ouml;he N) und *IconN (Gruppennummer des Icons N in einer DLL- oder EXE-Datei).  Im folgenden Beispiel wird das Standard-Icon aus der zweiten Icon-Gruppe geladen, mit einer Breite von 100 Pixel und einer automatischen H&ouml;he via "Seitenverh&auml;ltnis beibehalten": <em>GuiControl,, EigenesPicture, *icon2 *w100 *h-1 C:\Eigene Anwendung.exe</em>. Mit <em>*w0 *h0</em> wird die aktuelle Breite und H&ouml;he des Bildes beibehalten. Wenn *w und *h nicht vorhanden sind, dann wird die Gr&ouml;&szlig;e des Bildes der aktuellen Gr&ouml;&szlig;e des Steuerelements angepasst. Wird die Breite und H&ouml;he einer ICO-Datei mit mehreren Icons angegeben, dann wird automatisch das passendste Icon ausgew&auml;hlt, welches geladen werden soll. Hinweis: Zwischen der letzten Option und dem Dateinamen selbst sollte nur ein Leerzeichen oder Tabulator verwendet werden; weitere Leerzeichen und Tabulatoren werden als Teil des Dateinamens betrachtet.</p>
<p><a href="GuiControls.htm#Text">Text</a>/<a href="GuiControls.htm#Button">Button</a>/<a href="GuiControls.htm#GroupBox">GroupBox</a>/<a href="GuiControls.htm#StatusBar">StatusBar</a>: <em>Param3</em> enth&auml;lt den neuen Text des Steuerelement. Da das Steuerelement sich nicht automatisch erweitern kann, verwendet <em><a href="#Move">GuiControl</a>, Move, EigenerText, W300</em>, wenn das Steuerelement breiter gemacht werden muss. Beim <a href="GuiControls.htm#StatusBar">StatusBar</a>-Steuerelement wird nur der Text im ersten Teil ge&auml;ndert (<a href="GuiControls.htm#SB_SetText">SB_SetText()</a> hat eine h&ouml;here Flexibilit&auml;t).</p>
<p><a href="GuiControls.htm#Edit">Edit</a>: Jedes LF-Zeichen (`n) in <em>Param3</em> ohne vorhergehendes CR-Zeichen (`r) wird automatisch in CR+LF (`r`n) umgewandelt, damit sie korrekt angezeigt werden. Dies ist jedoch in der Regel kein Problem, weil die Befehle "Gui Submit" und "GuiControlGet Ausgabevariable" diese Umwandlung automatisch r&uuml;ckg&auml;ngig machen, indem CR+LF mit LF (`n) ersetzt wird.</p>
<p><a href="GuiControls.htm#Hotkey">Hotkey</a>: Wenn <em>Param3</em> leer ist, dann wird das Steuerelement frei gemacht, ansonsten kann ein Modifikator mit einer Taste angegeben werden. Beispiele: ^!c, ^Numpad1, +Home. Nur die Modifikatoren Strg (^), Alt (!) und Umschalt (+) werden unterst&uuml;tzt. Siehe <a href="../KeyList.htm">Keyboard, Maus und Joystickreferenz</a> f&uuml;r weitere Tasten.</p>
<p><a href="GuiControls.htm#Checkbox">Checkbox</a>: Mit der Zahl 1 in <em>Param3</em> kann das H&auml;kchen hinzugef&uuml;gt, mit 0 entfernt und mit -1 grau gemacht werden. Ansonsten wird <em>Param3</em> als neue Bezeichnung/neuer Text eingef&uuml;gt. Siehe <strong>Text</strong> weiter unten, wie dieses Verhalten &uuml;berschrieben wird.</p>
<p><a href="GuiControls.htm#Radio">Radio</a>: Das Gleiche wie Checkbox. Wenn das Optionsfeld allerdings aktiviert und Mitglied einer Gruppe von Optionsfeldern ist, dann werden die anderen Optionsfelder automatisch deaktiviert. Um ein neues Optionsfeld innerhalb einer Gruppe von Optionsfeldern zu markieren, welches nur eine Variable hat, ersetzt die <em>SteuerelementID</em> mit dem Namen/Text des Optionsfelds, wenn dieses Optionsfeld nicht direkt der Variable zugewiesen ist.</p>
<p><a href="GuiControls.htm#DateTime">DateTime</a>/<a href="GuiControls.htm#MonthCal">MonthCal</a>: F&uuml;r <em>Param3</em> kann ein Zeitstempel im Y<a href="FileSetTime.htm#YYYYMMDD">YYYMMDDHH24MISS</a>-Format angegeben werden. Mit %A_Now% kann das aktuelle Datum und die aktuelle Uhrzeit verwendet werden. Bei DateTime-Steuerelementen kann <em>Param3</em> weggelassen werden, damit das Steuerelement kein Datum/Zeit ausgew&auml;hlt hat (wenn das Steuerelement mit der <a href="GuiControls.htm#ChooseNone">Nummer 2</a> in Optionen erstellt wurde). Bei MonthCal-Steuerelementen kann ein Bereich angegeben werden, wenn die <a href="GuiControls.htm#MonthCalMulti">Mehrfachauswahl</a> aktiviert ist.</p>
<p><a href="GuiControls.htm#UpDown">UpDown</a>/<a href="GuiControls.htm#Slider">Slider</a>/<a href="GuiControls.htm#Progress">Progress</a>: <em>Param3</em> enth&auml;lt die neue Position des Steuerelements. Wenn das erste Zeichen in <em>Param3</em> ein Plus ist, dann dient die Zahl als Offset von der aktuellen Position. Zum Beispiel wird die Position mit +10 um 10 erh&ouml;ht und mit +-10 um 10 verringern. Wenn die neue Position au&szlig;erhalb des Bereichs ist, dann wird die Position auf den n&auml;chsten g&uuml;ltigen Wert gesetzt.</p>
<p><a href="GuiControls.htm#Tab">Tab</a>/<a href="GuiControls.htm#DropDownList">DropDownList</a>/<a href="GuiControls.htm#ComboBox">ComboBox</a>/<a href="GuiControls.htm#ListBox">ListBox</a>: <em>Param3</em> enth&auml;lt eine Liste von Eintr&auml;gen, die ans Ende der Liste angef&uuml;gt werden sollen (durch senkrechte Striche getrennt). Um die Liste stattdessen zu ersetzen (&uuml;berschreiben), f&uuml;gt einen senkrechten Strich als erstes Zeichen hinzu (z. B. |Rot|Gr&uuml;n|Blau). Mit einem einzelnen senkrechten Strich (|) kann das Steuerelement geleert werden. Damit ein Element vorausgew&auml;hlt ist, f&uuml;gt zwei senkrechte Striche danach hinzu (z. B. Rot|Gr&uuml;n||Blau). Das Trennzeichen zwischen den Feldern muss nicht ein senkrechter Strich sein. Mit <a href="Gui.htm#Delimiter"><em>Gui +Delimiter`n</em></a> beispielsweise ist das Trennzeichen ein LF und mit <em>Gui +DelimiterTab</em> ein Tabulator (`t).</p>
<p><a href="GuiControls.htm#Tab">Tab Steuerelemente</a>: Zus&auml;tzlich zu den beschriebenen Verhalten im obigen Absatz, bleiben Untersteuerelemente eines Tabs mit ihren urspr&uuml;nglichen Tabnummern verbunden, d. h. sie sind nie dem tats&auml;chlichen Anzeigenamen des Tabs zugeordnet. Daher hat das Umbenennen oder Entfernen eines Tabs keine Auswirkung auf die Tabnummer, die den Unterelementen zugeordnet ist. Wenn zum Beispiel der zweite Tab von insgesamt drei Tabs "Rot|Gr&uuml;n|Blau" mit "<em>GuiControl,, EigenesTab, |Red|Blue</em>" entfernt wird, dann werden die Untersteuerelemente von Gr&uuml;n dem Tab Blau zugeordnet. Daher sollten nur Tabs am Ende entfernt werden. Tabs, die auf diese Weise entfernt werden, k&ouml;nnen sp&auml;ter hinzugef&uuml;gt werden und erhalten wieder ihre urspr&uuml;nglichen Steuerelemente.</p>
<p><a href="ListView.htm">ListView</a> und <a href="TreeView.htm">TreeView</a>: Werden nicht unterst&uuml;tzt, wenn der <em>Unterbefehl</em> leer ist. Verwendet stattdessen die internen <a href="ListView.htm#BuiltIn">ListView</a>- und <a href="TreeView.htm#BuiltIn">TreeView</a>-Funktionen.</p>
<p><strong><br> <a name="Text"></a><span class="CommandSyntax">GuiControl</span>, Text</strong>: Verh&auml;lt sich wie oben, au&szlig;er f&uuml;r:<br> <a href="GuiControls.htm#Checkbox">Checkbox</a>/<a href="GuiControls.htm#Radio">Radio</a>: <em>Param3</em> wird als neue(r) Text/Bezeichnung behandelt, selbst wenn es -1, 0 oder 1 ist.<br> <a href="GuiControls.htm#DateTime">DateTime</a>: <em>Param3</em> wird als neues <a href="GuiControls.htm#DateTimeFormat">Datum/Zeit Format</a> behandelt, vom Steuerelement angezeigt. Wenn Param3 weggelassen wird, dann wird jedes benutzerdefinierte Format entfernt und das kurze Datumsformat tritt in Kraft.<br> <a href="GuiControls.htm#ComboBox">ComboBox</a>: <em>Param3</em> wird als Text behandelt, der direkt in das Edit-Steuerelement der ComboBox eingef&uuml;gt wird.</p>
<p><strong><a name="Move"></a><span class="CommandSyntax">GuiControl</span>, Move</strong>: Verschiebt das Steuerelement und/oder &auml;ndert dessen Gr&ouml;&szlig;e. Beliebig viele der folgenden Optionsbuchstaben k&ouml;nnen in <em>Param3</em> verwendet werden: X (die X-Koordinate bezieht sich auf den Client-Bereich des GUI-Fensters, ohne Titelleiste, Men&uuml;leiste und Rahmen); Y (die Y-Koordinate), W (Breite), H (H&ouml;he). Jede Zahl muss dezimal angegeben werden. Zum Beispiel:</p>
<pre>GuiControl, Move, EigenesEdit, x10 y20 w200 h100
GuiControl, Move, EigenesEdit, % "x" VarX+10 "y" VarY+5 "w" VarW*2 "h" VarH*1.5 <em>; Verwendet ein <a href="../Variables.htm#Expressions">Ausdruck</a> mit dem "% " Pr&auml;fix.</em></pre>
<p><strong><a name="MoveDraw" id="MoveDraw"></a><span class="CommandSyntax">GuiControl</span>, MoveDraw</strong>: Das Gleiche wie "Move" (oben). Zus&auml;tzlich wird der Bereich des Steuerelements im GUI-Fenster neu gezeichnet. Obwohl das zu unerw&uuml;nschtem Flackern bei mehreren schnellen Aufrufen f&uuml;hrt, werden damit Artefakte durch das Zeichnen von bestimmten Steuerelementen wie <a href="GuiControls.htm#GroupBox">GroupBox</a> aufgel&ouml;st. Seit v1.0.48.04 kann der letzte Parameter weggelassen werden, damit das Steuerelement neu gezeichnet wird, ohne es zu bewegen.</p>
<p><strong><span class="CommandSyntax">GuiControl</span>, Focus</strong>: Setzt den Tastaturfokus auf das Steuerelement. Damit dieser Befehl richtig funktioniert, darf das Fenster des Steuerelements im Allgemeinen nicht minimiert oder versteckt sein.</p>
<p><strong><span class="CommandSyntax">GuiControl</span>, Enable / Disable</strong>: Aktiviert oder deaktiviert ("ergraut") ein Steuerelement. Bei Tab-Steuerelementen werden auch alle Untersteuerelemente aktiviert oder deaktiviert. Doch jedes direkt deaktivierte Untersteuerelement mit "GuiControl Disable" merkt sich diese Einstellung und bleibt deaktiviert, selbst wenn das Tab-Steuerelement wieder aktiviert wird. Nach dem Wort Disabled kann auch eine 0 oder 1 erfolgen. Eine Null bewirkt, dass die Wirkung umgekehrt wird. Beispielsweise aktivieren <em>Enable</em> und <em>Enable%VarMitEins%</em> das Steuerelement, mit <em>Enable%VarMitNull%</em> jedoch deaktiviert.</p>
<p><strong><span class="CommandSyntax">GuiControl</span>, Hide / Show</strong>: Steuerelement ein- oder ausblenden. Bei Tab-Steuerelementen werden auch alle Untersteuerelemente ein- oder ausgeblendet. Au&szlig;erdem ist es m&ouml;glich, die Tastenkombination des Steuerelements (unterstrichener Buchstabe) mit "GuiControl Disable" zu unterbinden. Nach dem Wort Hide oder Show kann auch eine 0 oder 1 erfolgen. Eine Null bewirkt, dass die Wirkung umgekehrt wird. Beispielsweise wird mit <em>Show</em> und <em>Show%VarMitEins%</em> das Steuerelement eingeblendet, mit <em>Show%VarMitNull%</em> jedoch ausgeblendet.</p>
<p><strong><span class="CommandSyntax">GuiControl</span>, Delete (noch nicht implementiert)</strong>: Dieser Unterbefehl existiert noch nicht. Als &Uuml;bergangsl&ouml;sung kann <strong>Hide</strong> und/oder <strong>Disable</strong> (oben) verwendet werden, oder das ganze Fenster mit <a href="Gui.htm#Destroy">Gui Destroy</a> zerst&ouml;rt und neu erstellt werden.</p>
<p><strong><span class="CommandSyntax">GuiControl</span>, Choose, SteuerelementID, N</strong>: Setzt die Auswahl auf den N-ten Eintrag in einer ListBox, ComboBox oder Tab-Steuerelement. <em>N</em> ist mit der Nummer 1 der erste Eintrag, mit der Nummer 2 der zweite Eintrag, usw. (wenn <em>N</em> kein Integer-Wert ist, dann wird die unten beschriebene ChooseString-Methode verwendet). Im Gegensatz zu <a href="Control.htm">Control Choose</a> l&ouml;st dieser Unterbefehl nur ein <a href="Gui.htm#label">g-Label</a> aus, wenn <em>N</em> mit einem senkrechten Strich vorangestellt ist (selbst dann wird das g-Label nur ausgel&ouml;st, wenn die neue Auswahl sich von der alten Auswahl unterscheidet, zumindest bei <a href="GuiControls.htm#Tab">Tab-Steuerelementen</a>). Zum Beispiel: GuiControl, Choose, EigeneListBox, <strong>|3</strong>.</p>
<p>Damit zus&auml;tzlich ein Abschlussereignis auftreten kann (z. B. Doppelklick in einer ListBox), m&uuml;ssen zwei senkrechte Striche anstelle von einem vorangestellt werden (nicht unterst&uuml;tzt f&uuml;r Tab-Steuerelemente).</p>
<p>Um die Auswahl in einer <a href="GuiControls.htm#ListBoxMulti">ListBox mit Mehrfachauswahl</a> auf <u>alle</u> Eintr&auml;ge gleichzeitig zu setzen oder zu entfernen, siehe Beispiel:</p>
<pre>Gui +LastFound  <em>; Verhindert, dass der Fenstertitel darunter angegeben werden muss.</em>
<a href="PostMessage.htm">PostMessage</a>, 0x185, 1, -1, ListBox1  <em>; Alle ListBox-Eintr&auml;ge ausw&auml;hlen. 0x185 ist LB_SETSEL.</em>
<a href="PostMessage.htm">PostMessage</a>, 0x185, 0, -1, ListBox1  <em>; Alle ListBox-Eintr&auml;ge abw&auml;hlen.</em></pre>
<p><strong><span class="CommandSyntax">GuiControl</span>, ChooseString, SteuerelementID, String</strong>: Setzt die Auswahl auf den ersten Eintrag in einer ListBox ,ComboBox und Tab-Steuerelement, dessen f&uuml;hrender Teil mit <em>String</em> &uuml;bereinstimmt. Die Suche ist nicht von der Gro&szlig;-/Kleinschreibung abh&auml;ngig. Wenn ein Steuerelement beispielsweise den Eintrag "UNIX-Text" enth&auml;lt, dann gen&uuml;gt das Wort unix (kleingeschrieben), um es auszuw&auml;hlen. Eins oder zwei senkrechte Striche als Pr&auml;fix werden ebenfalls unterst&uuml;tzt (siehe "Choose" f&uuml;r Details).</p>
<p><strong><span class="CommandSyntax">GuiControl</span>, Font</strong>: &Auml;ndert die Art, Gr&ouml;&szlig;e, Stil und/oder Farbe der Schrift des Steuerelements. Zum Beispiel:</p>
<pre><a href="Gui.htm#Font">Gui, Font</a>, s18 cRed Bold, Verdana  <em>; Verwendet je nach Bedarf so eine Zeile, um eine neue Standard-Schrift zu setzen.</em>
GuiControl, Font, EigenesEdit  <em>; Setzt die obere Schrift f&uuml;r ein Steuerelement in Kraft.</em></pre>
<p><strong><span class="CommandSyntax">GuiControl</span>, +/-Option1 +/-Option2 ... </strong>: Hinzuf&uuml;gen oder Entfernen von verschiedenen <a href="GuiControls.htm">steuerelement-spezifischen</a> oder <a href="Gui.htm#OtherOptions">allgemeinen</a> Optionen und Styles. Im folgenden Beispiel wird die <a href="Gui.htm#AltSubmit">AltSubmit</a>-Option aktiviert, aber <a href="Gui.htm#label">g-Label</a> entfernt:</p>
<pre>GuiControl, +AltSubmit -g, EigeneListBox</pre>
<p>Im n&auml;chsten Beispiel wird die OK-Schaltfl&auml;che zur neuen Standardschaltfl&auml;che:</p> 
<pre>GuiControl, +Default, OK</pre>
<p>Obwohl <a href="../misc/Styles.htm">Styles</a> und erweiterte Styles auch erkannt werden, k&ouml;nnen einige von ihnen nicht angewendet oder entfernt werden, nachdem ein Steuerelement erstellt wurde. ErrorLevel wird auf 0 gesetzt, wenn mindestens eine angegebene &Auml;nderung erfolgreich angewendet wurde. Ansonsten wird es auf 1 gesetzt, um anzuzeigen, dass keine &Auml;nderung angewandt werden konnte. Selbst wenn eine &Auml;nderung erfolgreich angewendet wird, k&ouml;nnte das Steuerelement es trotzdem ignorieren.</p>

<h3>Bemerkungen</h3>
<p>Damit auch ein anderes Fenster neben dem Standardfenster bearbeitet werden kann (siehe unten), muss dessen Name oder Nummer gefolgt von einem Doppelpunkt vor dem Unterbefehl eingef&uuml;gt werden, wie zum Beispiel:</p>
<pre>GuiControl, EigenesGui:Show, EigenerButton
GuiControl, EigenesGui:, EigeneListBox, Element1|Element2</pre>
<p>Ein <a href="../misc/Threads.htm">GUI-Thread</a> wird aufgrund einer GUI-Aktion wie jeder andere Thread behandelt. GUI-Aktionen sind das Ausw&auml;hlen von Eintr&auml;gen in einer Men&uuml;leiste oder das Ausf&uuml;hren eines <a href="Gui.htm#label">g-Labels</a> (z. B. beim Dr&uuml;cken einer Schaltfl&auml;che).</p>
<p>Der <a href="Gui.htm#DefaultWin">Standardfenstername</a> f&uuml;r einen GUI-Thread ist von dem Fenster, das diesen Thread gestartet hat. Nicht-GUI-Threads verwenden standardm&auml;&szlig;ig die 1.</p>

<h3>Verwandte Befehle</h3>
<p><a href="Gui.htm">Gui</a>, <a href="GuiControlGet.htm">GuiControlGet</a>, <a href="Control.htm">Control</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">GuiControl,, EigeneListBox, |Rot|Gr&uuml;n|Blau  <em>; Ersetzt die aktuelle Liste mit einer neuen Liste.</em>
GuiControl,, EigenesEdit, Neue Textzeile 1.`nNeue Textzeile 2.
GuiControl,, EigenesRadio2, 1  <em>; Aktiviert das Optionsfeld und deaktiviert alle anderen in dieser Gruppe.</em>
GuiControl, Move, OK, x100 y200  <em>; Verschiebt die OK-Schaltfl&auml;che zur neuen Position.</em>
GuiControl, Focus, LastName  <em>; Setzt den Tastaturfokus auf ein Steuerelement, dessen Variable oder Text "LastName" ist.</em></pre>


</body></html>