<!DOCTYPE HTML>
<html>
<head>
<title>GuiControl</title>
<meta name="keywords" content="Befehl, Grafische Benutzeroberfläche">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>
<h1>GuiControl</h1>
<p>Ermöglicht Änderungen eines Steuerelements in einem GUI-Fenster.</p>
<pre class="Syntax">GuiControl, Unterbefehl, SteuerelementID [, Param3] </pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td>Unterbefehl</td>
    <td>Siehe untere Liste.</td>
  </tr>
  <tr>
    <td style="width: 15%;">SteuerelementID</td>
    <td style="width: 85%;">
    <p>Wenn das Ziel-Steuerelement eine zugewiesene Variable hat, dann kann der Name der Variable als <em>SteuerelementID</em> angegeben werden (diese Methode hat Vorrang vor der nächsten Methode). Daher ist es am besten, dem Steuerelement eine Variable zuzuweisen, auf das später mit GuiControl oder GuiControlGet zugegriffen wird, selbst wenn es nicht eingabefähig ist (z. B. GroupBox oder Text).</p>
    <p>Ansonsten ist <em>SteuerelementID</em> entweder das ClassNN (Klassenname und Instanznummer des Steuerelements) oder der Text des Steuerelements, das beides mit Windows Spy ermittelt werden kann. Verwendet man Text, ist das Übereinstimmungsverhalten abhängig von <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>. Hinweis: Der Dateiname eines Picture-Steuerelements kann auch als <em>SteuerelementID</em> verwendet werden.</p>
    <p><span class="ver">[v1.1.04+]:</span> <em>SteuerelementID</em> kann das <a href="Gui.htm#HwndOutputVar">HWND</a> eines Steuerelements sein. Wie bei allen anderen Werten für SteuerelementID auch, muss das Gui angegeben werden, falls sich das Steuerelement nicht auf dem Standard-Gui befindet.</p>
    </td>
  </tr>
  <tr>
    <td>Param3</td>
    <td>Dieser Parameter kann weggelassen werden, solange er nicht von einem Unterbefehl aus der unteren Liste benötigt wird.</td>
  </tr>
</table>
<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, wenn das angegebene Fenster/Steuerelement nicht existiert oder ein anderes Problem aufgetreten ist. Ansonsten auf 0.</p>
<h3>Unterbefehle</h3>
<p><strong>(Leer)</strong>: Falls der <em>Unterbefehl</em> leer ist, können neue Inhalte über <em>Param3</em> in das Steuerelement eingefügt werden. Im Einzelnen:</p>
<p><a href="GuiControls.htm#Picture">Picture</a>: Bestimmt mit <em>Param3</em> den Dateinamen des neuen Bildes, das geladen werden soll (siehe <a href="GuiControls.htm#Picture">Gui Picture</a> für unterstützte Dateitypen). Direkt vor dem Dateinamen können beliebig viele der folgenden Optionen angegeben werden: <code>*wN</code> (Breite N), <code>*hN</code> (Höhe N) und <code>*IconN</code> (Gruppennummer des Icons N in einer DLL- oder EXE-Datei). Beachtet, dass es <strong>nicht</strong> möglich ist, auf diese Weise (*x und *y) das Bild auf eine neue Position zu verschieben - verwendet stattdessen <a href="#Move">GuiControl Move</a>. Im folgenden Beispiel wird das Standard-Icon aus der zweiten Icon-Gruppe geladen - mit einer Breite von 100 Pixel und einer automatischen Höhe via "Seitenverhältnis beibehalten": <code>GuiControl,, EigenesBild, *icon2 *w100 *h-1 C:\Eigene Anwendung.exe</code>. Mit <code>*w0 *h0</code> wird die aktuelle Breite und Höhe des Bildes beibehalten. Wenn <code>*w</code> und <code>*h</code> nicht vorhanden sind, passt sich das Bild an die Steuerelementgröße an. Falls ein Icon aus einer ICO-Datei geladen wird, die mehrere Icons enthält, dann bewirkt die Angabe von Breite und Höhe zudem, welches Icon geladen wird. Hinweis: Zwischen der letzten Option und dem Dateinamen selbst sollte nur ein Leer- oder Tabulatorzeichen verwendet werden; weitere Leer- und Tabulatorzeichen werden als Teil des Dateinamens betrachtet.</p>
<p><a href="GuiControls.htm#Text">Text</a>/<a href="GuiControls.htm#Button">Button</a>/<a href="GuiControls.htm#GroupBox">GroupBox</a>/<a href="GuiControls.htm#StatusBar">StatusBar</a>: Bestimmt mit <em>Param3</em> den neuen Text des Steuerelements. Da das Steuerelement sich dabei nicht automatisch breiter macht, verwendet, falls nötig, <code><a href="#Move">GuiControl</a>, Move, EigenerText, W300</code>. Beim <a href="GuiControls.htm#StatusBar">StatusBar</a>-Steuerelement wird nur der Text im ersten Teil geändert (verwendet daher <a href="GuiControls.htm#SB_SetText">SB_SetText()</a> für eine höhere Flexibilität).</p>
<p><a href="GuiControls.htm#Edit">Edit</a>: Jedes LF-Zeichen (`n) in <em>Param3</em> ohne vorhergehendes CR-Zeichen (`r) wird automatisch in CR+LF (`r`n) umgewandelt, damit diese korrekt angezeigt werden. Allerdings ist das normalerweise kein Grund zur Sorge, weil diese Umwandlung durch die Befehle <code>Gui Submit</code> und <code>GuiControlGet AusgabeVar</code> automatisch rückgängig gemacht wird, indem CR+LF mit LF (`n) ersetzt wird.</p>
<p><a href="GuiControls.htm#Hotkey">Hotkey</a>: Mit leerem <em>Param3</em>-Wert kann das Steuerelement freigemacht werden, ansonsten können mehrere Modifikatortasten mit einem Tastennamen angegeben werden. Beispiele: <code>^!c</code>, <code>^Numpad1</code>, <code>+Home</code>. Es werden nur die Modifikatortasten ^ (STRG), ! (ALT) und + (UMSCHALT) unterstützt. Siehe <a href="../KeyList.htm">Keyboard, Maus und Joystickreferenz</a> für weitere Tasten.</p>
<p><a href="GuiControls.htm#Checkbox">Checkbox</a>: Mit einer 1 in <em>Param3</em> wird das Häkchen im Kontrollkästchen hinzugefügt, mit 0 entfernt und mit -1 grau gemacht. Ansonsten wird <em>Param3</em> als neue Bezeichnung/neuer Text angesehen. Siehe <strong>Text</strong> weiter unten, wie dieses Verhalten überschrieben werden kann.</p>
<p><a href="GuiControls.htm#Radio">Radio</a>: Das Gleiche wie Checkbox. Wenn das Optionsfeld allerdings ausgewählt wird und zu einer Gruppe von Optionsfeldern gehört, werden die anderen Optionsfelder in der Gruppe automatisch abgewählt. Um ein neues Optionsfeld innerhalb einer Gruppe von Optionsfeldern auszuwählen, welches nur eine Variable hat, ersetzt <em>SteuerelementID</em> mit dem Namen/Text des Optionsfelds, falls es nicht das Optionsfeld ist, mit dem die Variable direkt verbunden wurde.</p>
<p><a href="GuiControls.htm#DateTime">DateTime</a>/<a href="GuiControls.htm#MonthCal">MonthCal</a>: Bestimmt mit <em>Param3</em> einen Zeitstempel im <a href="FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a>-Format. Mit <code>%A_Now%</code> kann das aktuelle Datum und die aktuelle Zeit verwendet werden. Bei DateTime-Steuerelementen bewirkt das Weglassen von <em>Param3</em>, dass das Steuerelement keinen Datum bzw. keine Zeit ausgewählt hat (falls das Steuerelement mit der <a href="GuiControls.htm#ChooseNone">Nummer 2</a> in den Optionen erstellt wurde). Bei MonthCal-Steuerelementen kann ein Bereich angegeben werden, wenn die <a href="GuiControls.htm#MonthCalMulti">Mehrfachauswahl</a> aktiviert ist.</p>
<p><a href="GuiControls.htm#UpDown">UpDown</a>/<a href="GuiControls.htm#Slider">Slider</a>/<a href="GuiControls.htm#Progress">Progress</a>: Bestimmt mit <em>Param3</em> die neue Position des Steuerelements. Sobald das erste Zeichen in <em>Param3</em> ein Plus ist, wird die Zahl als Offset von der aktuellen Position angesehen. Zum Beispiel würde mit <code>+10</code> die Position um 10 Pixel erhöht und mit <code>+-10</code> um 10 Pixel verringert werden. Falls die neue Position außerhalb des Bereichs liegt, wird die Position auf den nächsten gültigen Wert gesetzt.</p>
<p><a href="GuiControls.htm#Tab">Tab</a>/<a href="GuiControls.htm#DropDownList">DropDownList</a>/<a href="GuiControls.htm#ComboBox">ComboBox</a>/<a href="GuiControls.htm#ListBox">ListBox</a>: Bestimmt mit <em>Param3</em> eine Liste von Einträgen, die ans Listenende des Steuerelements angefügt werden sollen (durch senkrechte Striche getrennt). Um die Liste stattdessen zu ersetzen (überschreiben), fügt einen senkrechten Strich als erstes Zeichen hinzu (z. B. <code>|Rot|Grün|Blau</code>). Mit einem einzelnen senkrechten Strich (|) kann das Steuerelement geleert werden. Damit einer der Einträge vorausgewählt ist, fügt nach ihm zwei senkrechte Striche ein (z. B. <code>Rot|Grün||Blau</code>). Das Trennzeichen zwischen den Feldern muss nicht zwingend ein senkrechter Strich sein. Mit <a href="Gui.htm#Delimiter"><code>Gui +Delimiter`n</code></a> beispielsweise wird es in ein Zeilenumbruchszeichen und mit <code>Gui +DelimiterTab</code> in ein Tabulatorzeichen (`t) umgewandelt.</p>
<p><a href="GuiControls.htm#Tab">Tab-Steuerelemente</a>: Zusätzlich zum oben genannten Verhalten bleiben Untersteuerelemente eines Tabs mit ihren ursprünglichen Tab-Nummern verbunden. Das heißt, dass sie nie dem tatsächlichen Anzeigenamen des Tabs zugeordnet sind. Daher wirkt sich das Umbenennen oder Entfernen eines Tabs nicht auf die Tab-Nummer aus, auf die sich die Unterelemente beziehen. Wenn zum Beispiel der zweite Tab von insgesamt drei Tabs "Rot|Grün|Blau" mit <code>GuiControl,, EigenesTab, |Rot|Blau</code> entfernt wird, werden die Untersteuerelemente, die ursprünglich "Grün" gehörten, nun mit "Blau" verbunden. Aus diesem Grund sollten nur Tabs entfernt werden, die sich am Ende befinden. Tabs, die auf diese Weise entfernt werden, können später wieder hinzugefügt werden, um die ursprünglichen Steuerelemente wiederherzustellen.</p>
<p><a href="ListView.htm">ListView</a> und <a href="TreeView.htm">TreeView</a>: Diese Steuerelemente werden nicht unterstützt, wenn der <em>Unterbefehl</em> leer ist. Verwendet stattdessen die internen Funktionen von <a href="ListView.htm#BuiltIn">ListView</a> und <a href="TreeView.htm#BuiltIn">TreeView</a>.</p>
<p id="Text"><strong>GuiControl, Text</strong>: Verhält sich wie oben, außer bei:<br><a href="GuiControls.htm#Checkbox">Checkbox</a>/<a href="GuiControls.htm#Radio">Radio</a>: <em>Param3</em> wird als neue(r) Text/Bezeichnung angesehen, selbst wenn es -1, 0 oder 1 ist.<br><a href="GuiControls.htm#DateTime">DateTime</a>: <em>Param3</em> wird als neues <a href="GuiControls.htm#DateTimeFormat">Datum/Zeit-Format</a> angesehen, das vom Steuerelement angezeigt wird. Beim Weglassen von Param3 werden alle benutzerdefinierten Formate entfernt und das kurze Datumsformat erwirkt.<br><a href="GuiControls.htm#ComboBox">ComboBox</a>: <em>Param3</em> wird als Text angesehen, der direkt in das Eingabefeld der ComboBox eingefügt wird.</p>
<p id="Move"><strong>GuiControl, Move</strong>: Verschiebt das Steuerelement und/oder ändert dessen Größe. Es können beliebig viele der folgenden Optionsbuchstaben in <em>Param3</em> angegeben werden: X (die X-Koordinate bezieht sich auf den Client-Bereich des GUI-Fensters, ohne Titelleiste, Menüleiste und Rahmen); Y (die Y-Koordinate), W (Breite), H (Höhe). Jede Zahl muss dezimal angegeben werden. Zum Beispiel:</p>
<pre>GuiControl, Move, EigenesEdit, x10 y20 w200 h100
GuiControl, Move, EigenesEdit, % "x" VarX+10 "y" VarY+5 "w" VarW*2 "h" VarH*1.5 <em>; Verwendet ein <a href="../Variables.htm#Expressions">Ausdruck</a> mithilfe des Präfixes "% ".</em></pre>
<p id="MoveDraw"><strong>GuiControl, MoveDraw</strong>: Das Gleiche wie "Move" (oben), jedoch wird zusätzlich der GUI-Fensterbereich beim Setzen des Steuerelements neu gezeichnet. Falls dieser Befehl schnell und mehrmals hintereinander aufgerufen wird, kann es passieren, dass es zu unerwünschtem Flackern kommt. Allerdings ist er in der Lage, entstandene Artefakte beim Zeichnen von bestimmten Steuerelementen wie <a href="GuiControls.htm#GroupBox">GroupBox</a> aufzulösen. Seit v1.0.48.04 kann der letzte Parameter weggelassen werden, um das Steuerelement neu zu zeichnen, ohne es dabei zu verschieben.</p>
<p id="Focus"><strong>GuiControl, Focus</strong>: Setzt den Tastaturfokus auf das Steuerelement. Damit dieser Befehl richtig funktioniert, darf das Fenster des Steuerelements generell nicht minimiert oder versteckt sein.</p>
<p><a id="Enable"></a><a id="Disable"></a><strong>GuiControl, Enable / Disable</strong>: Aktiviert oder deaktiviert ("ergraut") ein Steuerelement. Bei Tab-Steuerelementen werden dabei auch alle Untersteuerelemente aktiviert oder deaktiviert. Beachtet aber, das jedes Untersteuerelement, das direkt mit "GuiControl Disable" deaktiviert wurde, sich diese Einstellung merkt und folglich deaktiviert bleibt, falls das Tab-Steuerelement wieder aktiviert wird. Optional kann nach dem Wort Disabled oder Enable eine 0 oder 1 erfolgen. Eine 0 bewirkt, dass die Wirkung umgekehrt wird. Zum Beispiel wird das Steuerelement sowohl mit <em>Enable</em> als auch mit <em>Enable%VarMitEins%</em> aktiviert, aber mit <em>Enable%VarMitNull%</em> deaktiviert.</p>
<p><a id="Hide"></a><a id="Show"></a><strong>GuiControl, Hide / Show</strong>: Das Steuerelement verstecken oder anzeigen. Bei Tab-Steuerelementen werden dabei auch alle Untersteuerelemente versteckt oder angezeigt. Falls zusätzlich der Bedarf besteht, die Tastenkombination des Steuerelements (unterstrichener Buchstabe) zu unterdrücken, verwendet "GuiControl Disable". Optional kann nach dem Wort Hide oder Show eine 0 oder 1 erfolgen. Eine Null bewirkt, dass die Wirkung umgekehrt wird. Zum Beispiel wird das Steuerelement sowohl mit <em>Show</em> als auch mit <em>Show%VarMitEins%</em> angezeigt, aber mit <em>Show%VarMitNull%</em> versteckt.</p>
<p><strong>GuiControl, Delete (noch nicht implementiert)</strong>: Dieser Unterbefehl ist zurzeit noch nicht vorhanden. Als Übergangslösung kann <strong>Hide</strong> und/oder <strong>Disable</strong> (siehe oben) verwendet werden, oder das ganze Fenster mit <a href="Gui.htm#Destroy">Gui Destroy</a> zerstört und neu erstellt werden.</p>
<p id="Choose"><strong>GuiControl, Choose, SteuerelementID, N</strong>: Setzt die Auswahl auf den N-ten Eintrag in einem ListBox-, ComboBox- oder Tab-Steuerelement. <em>N</em> ist mit der Nummer 1 der erste Eintrag, mit der Nummer 2 der zweite Eintrag und so weiter. Sobald <em>N</em> kein Integer ist, wird stattdessen die unten genannte ChooseString-Methode verwendet. <span class="ver">[v1.1.06+]:</span> Falls <em>N</em> eine 0 ist, wird die aktuelle Auswahl in einem ListBox-, DropDownList- oder ComboBox-Steuerelement aufgehoben.</p>
<p>Im Gegensatz zu <a href="Control.htm">Control Choose</a> wird dieser Unterbefehl keinen <a href="Gui.htm#label">g-Label</a> auslösen, es sei denn, <em>N</em> wird mit einem senkrechten Strich vorangestellt (selbst dann wird das g-Label nur ausgelöst, wenn die neue Auswahl sich von der alten Auswahl unterscheidet, zumindest bei <a href="GuiControls.htm#Tab">Tab-Steuerelementen</a>). Zum Beispiel: <code>GuiControl, Choose, EigeneListBox, <strong>|3</strong></code>.</p>
<p>Damit zudem ein abschließendes Ereignis erfolgen kann (z. B. Doppelklick in einer ListBox), müssen zwei senkrechte Striche anstelle von einem vorangestellt werden (bei Tab-Steuerelementen nicht unterstützt).</p>
<p>Um <u>alle</u> Einträge in einer <a href="GuiControls.htm#ListBoxMulti">ListBox mit Mehrfachauswahl</a> aus- oder abzuwählen, siehe Beispiel:</p>
<pre>Gui +LastFound  <em>; Verhindert, dass der Fenstertitel darunter angegeben werden muss.</em>
<a href="PostMessage.htm">PostMessage</a>, 0x185, 1, -1, ListBox1  <em>; Alle ListBox-Einträge auswählen. 0x185 ist LB_SETSEL.</em>
<a href="PostMessage.htm">PostMessage</a>, 0x185, 0, -1, ListBox1  <em>; Alle ListBox-Einträge abwählen.</em>
GuiControl, Choose, ListBox1, 0  <em>; Alle ListBox-Einträge abwählen (benötigt v1.1.06+).</em></pre>
<p id="ChooseString"><strong>GuiControl, ChooseString, SteuerelementID, String</strong>: Setzt die Auswahl auf den ersten Eintrag in einem ListBox-, ComboBox- und Tab-Steuerelement, dessen führender Teil mit <em>String</em> übereinstimmt. Die Suche ist nicht von der Groß- und Kleinschreibung abhängig. Wenn zum Beispiel das Steuerelement den Eintrag "UNIX-Text" enthält, dann genügt das Wort unix (kleingeschrieben), um es auszuwählen. Als Präfix werden zudem "|" oder "||" unterstützt (siehe "Choose" für Details).</p>
<p id="Font"><strong>GuiControl, Font</strong>: Ändert die Schriftart, Schriftgröße, Schriftstil und/oder Schriftfarbe des Steuerelements. Zum Beispiel:</p>
<pre><a href="Gui.htm#Font">Gui, Font</a>, s18 cRed Bold, Verdana  <em>; Verwendet je nach Bedarf so eine Zeile, um eine neue Standard-Schrift zu setzen.</em>
GuiControl, Font, EigenesEdit  <em>; Setzt die obere Schrift für ein Steuerelement in Kraft.</em></pre>
<p><strong>GuiControl, +/-Option1 +/-Option2 ... </strong>: Hinzufügen oder Entfernen von verschiedenen <a href="GuiControls.htm">steuerelement-spezifischen</a> oder <a href="Gui.htm#OtherOptions">allgemeinen</a> Optionen und Styles. Im folgenden Beispiel wird die <a href="Gui.htm#AltSubmit">AltSubmit</a>-Option aktiviert, aber <a href="Gui.htm#label">g-Label</a> entfernt:</p>
<pre>GuiControl, +AltSubmit -g, EigeneListBox</pre>
<p>Im nächsten Beispiel wird die OK-Schaltfläche zur neuen Standardschaltfläche:</p>
<pre>GuiControl, +Default, OK</pre>
<p>Obwohl <a href="../misc/Styles.htm">Styles</a> und erweiterte Styles auch erkannt werden, können einige von ihnen nicht angewendet oder entfernt werden, nachdem ein Steuerelement erstellt wurde. ErrorLevel wird auf 0 gesetzt, wenn mindestens eine der angegebenen Änderungen erfolgreich durchgeführt wurde. Ansonsten wird es auf 1 gesetzt, um klarzustellen, dass keine einzige Änderung durchführbar war. Es ist möglich, dass das Steuerelement eine Änderung ignoriert, auch wenn diese erfolgreich durchgeführt wurde.</p>
<h3>Bemerkungen</h3>
<p>Um neben dem <a href="Gui.htm#DefaultWin">Standard</a>-Fenster auch andere Fenster bearbeiten zu können, fügt dessen Name oder Nummer (oder seit v1.1.03 dessen <a href="Gui.htm#GuiHwndOutputVar">HWND</a>) gefolgt von einem Doppelpunkt vor dem Unterbefehl wie folgt ein:</p>
<pre>GuiControl, EigenesGui:Show, EigenerButton
GuiControl, EigenesGui:, EigeneListBox, Element1|Element2</pre>
<p>Das ist auch notwendig, wenn <em>SteuerelementID</em> die zugewiesene Variable eines Steuerelements oder ein HWND ist.</p>
<p>Ein <a href="../misc/Threads.htm">GUI-Thread</a> wird wie jeder andere Thread definiert, der aufgrund einer GUI-Aktion gestartet wurde. Zu den GUI-Aktionen gehört beispielsweise das Auswählen eines Menüpunkts oder das Ausführen eines <a href="Gui.htm#label">g-Labels</a> (z. B. beim Drücken einer Schaltfläche).</p>
<p>Der <a href="Gui.htm#DefaultWin">Standardfenstername</a> für einen GUI-Thread ist von dem Fenster, das diesen Thread gestartet hat. Nicht-GUI-Threads verwenden standardmäßig die 1.</p>
<h3>Verwandte Befehle</h3>
<p><a href="Gui.htm">Gui</a>, <a href="GuiControlGet.htm">GuiControlGet</a>, <a href="Control.htm">Control</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">GuiControl,, EigeneListBox, |Rot|Grün|Blau  <em>; Ersetzt die aktuelle Liste mit einer neuen Liste.</em>
GuiControl,, EigenesEdit, Neue Textzeile 1.`nNeue Textzeile 2.
GuiControl,, EigenesRadio2, 1  <em>; Aktiviert das Optionsfeld und deaktiviert alle anderen in dieser Gruppe.</em>
GuiControl, Move, OK, x100 y200  <em>; Verschiebt die OK-Schaltfläche zur neuen Position.</em>
GuiControl, Focus, Nachname  <em>; Setzt den Tastaturfokus auf ein Steuerelement, dessen Variable oder Text "Nachname" ist.</em></pre>
</body>
</html>
