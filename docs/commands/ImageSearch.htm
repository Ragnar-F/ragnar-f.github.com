<!DOCTYPE HTML>
<html>
<head>
<title>ImageSearch</title>
<meta name="keywords" content="Befehl, Bildschirm">
<meta name="description" content="Verwendet ImageSearch in dieser freien Scriptsprache, um ein ICO-, BMP- oder PNG-Bild auf dem Bildschirm zu suchen. Sendet daraufhin Tastatureingaben oder Mausklicks.">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>
<h1>ImageSearch</h1>
<p>Sucht in einem bestimmten Bildschirmbereich nach einem Bild.</p>
<pre class="Syntax">ImageSearch, AusgabeVarX, AusgabeVarY, X1, Y1, X2, Y2, Bilddatei</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td style="width: 15%;">AusgabeVarX/Y</td>
    <td style="width: 85%;">
    <p>Namen der Variablen, in denen die Koordinaten X und Y des oberen linken Pixels gespeichert werden sollen, bei dem das Bild gefunden wurde (wenn das Bild nicht gefunden wird, werden diese Variablen leer gemacht). Die Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu ändern.</p>
    <p>Es kann ein oder beide Parameter leer gelassen werden. In diesem Fall kann mit ErrorLevel (siehe unten) festgestellt werden, ob eine Übereinstimmung gefunden wurde.</p>
    </td>
  </tr>
  <tr>
    <td>X1,Y1</td>
    <td>Die Koordinaten X und Y der oberen linken Ecke des rechteckigen Suchbereichs, die <a href="../Variables.htm#Expressions">Ausdrücke</a> sein können. <strong>Die Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu ändern.</strong></td>
  </tr>
  <tr>
    <td>X2,Y2</td>
    <td>Die Koordinaten X und Y der unteren rechten Ecke des rechteckigen Suchbereichs, die <a href="../Variables.htm#Expressions">Ausdrücke</a> sein können. Die Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu ändern.</td>
  </tr>
  <tr>
    <td>Bilddatei</td>
    <td>
    <p>Der Name des Bildes, das sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis befindet, solange kein absoluter Pfad angegeben ist. Alle Betriebssysteme unterstützen GIF, JPG, BMP, ICO, CUR und ANI (BMP-Bilder müssen 16-Bit oder höher sein). Andere Quellen von Icons können sein: EXE, DLL, CPL, SCR und andere Typen, die Icon-Ressourcen enthalten. In Windows XP (oder höher) werden zusätzliche Bildformate wie PNG, TIF, Exif, WMF und EMF unterstützt. Betriebssysteme älter als XP können unterstützt werden, wenn die freie GDIPlus.dll von Microsoft in den Ordner der AutoHotkey.exe kopiert wird (im Falle eines <a href="../Scripts.htm#ahk2exe">kompilierten Scripts</a> muss die DLL-Datei in den Ordner des Scripts). Die DLL kann mit folgenden Suchbegriffen auf <a href="http://www.microsoft.com">www.microsoft.com</a> gefunden werden: gdi redistributable</p>
    <p><strong>Optionen</strong>: Beliebig viele folgende Strings können vor dem Dateinamen stehen. Die Optionen werden mit einem Leerzeichen oder Tabulator getrennt. Zum Beispiel: <code>*2 *w100 *h-1 C:\Hauptlogo.bmp</code>.</p>
    <p><strong>*IconN</strong>: Um eine beliebige Icon-Gruppe aus einer Datei zu verwenden, kann in den <i>Optionen</i> das Wort <code>*Icon</code> eingefügt werden, gefolgt von der Gruppennummer. Zum Beispiel würde mit <code>*Icon2</code> das Standard-Icon aus der zweiten Icon-Gruppe geladen.</p>
    <p><strong>*n</strong> (Variation): Für <strong>n</strong> kann eine Nummer zwischen 0 und 255 angegeben werden, um den Farbtontoleranzbereich von Rot-, Grün- und Blaukomponenten jeder Pixelfarbe zu bestimmen. Zum Beispiel erlaubt <code>*2</code> zwei Farbtonvarianten. Dieser Parameter ist hilfreich, wenn die Bildfarbe leicht variiert oder die <em>Bilddatei</em> ein Format wie GIF oder JPG benutzt, dass auf dem Bildschirm nicht richtig dargestellt wird. Bei 255 Farbtonvarianten stimmen alle Farben überein. Standard sind 0 Farbtonvarianten.</p>
    <p><strong>*TransN</strong>: Diese Option macht es einfacher, eine Übereinstimmung zu finden, wenn eine Farbe des Bildes angegeben wird, die mit jeder beliebigen Farbe auf dem Bildschirm übereinstimmt. Diese wird häufig bei PNG-, GIF- und TIF-Dateien verwendet, die transparente Bereiche enthalten (Icons benötigen diese Option nicht, weil die Transparenz automatisch unterstützt wird). Bei GIF-Dateien funktioniert meistens <code>*TransWhite</code>. Bei PNG- oder TIF-Dateien eher <code>*TransBlack</code>. Ansonsten kann für <strong>N</strong> ein anderer Farbname oder RGB-Wert angegeben werden (siehe <a href="Progress.htm#colors">Farbtabelle</a> oder verwendet <a href="PixelGetColor.htm">PixelGetColor</a> im RGB-Modus). Beispiele: <code>*TransBlack</code>, <code>*TransFFFFAA</code>, <code>*Trans0xFFFFAA</code>.</p>
    <p><strong>*wn</strong> und <strong>*hn</strong>: Bild auf die angegebene Breite und/oder Höhe skalieren (diese Breite und Höhe bestimmt auch, welches Icon von einer .ICO-Datei mit mehreren Icons geladen wird). Sobald beide Optionen nicht vorhanden sind, werden die geladenen Icons von einer ICO-, DLL- oder EXE-Datei auf die Standardgröße der kleinen Icons skaliert, in der Regel 16x16 (die aktuelle/interne Größe kann mit <code>*w0 *h0</code> erzwungen werden). Bilder, die keine Icons sind, werden in ihrer aktuellen Größe geladen. Um das Bild unter Beibehaltung des Seitenverhältnisses zu verkleinern oder zu vergrößern, verwendet -1 für eine Abmessung und eine positive Zahl für die andere Abmessung. Mit <code>*w200 *h-1</code> beispielsweise wird die Breite des Bildes auf 200 Pixel gesetzt und die Höhe automatisch eingestellt.</p>
    </td>
  </tr>
</table>
<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 0 gesetzt, wenn das Bild im angegebenen Bereich gefunden wird. Ansonsten auf 1, wenn es nicht gefunden wird, oder auf 2, wenn der Befehl daran gehindert wird, die Suche durchzuführen (z. B. die Bilddatei kann nicht geöffnet werden oder eine falsch formatierte Option).</p>
<h3>Bemerkungen</h3>
<p>ImageSearch kann dazu verwendet werden, grafische Objekte auf einem Bildschirm zu erkennen, auf dem Text weder vorhanden ist noch auf einfache Weise ermittelt werden kann. Zum Beispiel ist ImageSearch in der Lage, die Position von Bild-Schaltflächen, Icons, Links von Webseiten oder Spielobjekte zu erkennen. Sobald solche Objekte gefunden werden, können diese mit <a href="Click.htm">Click</a> angeklickt werden.</p>
<p>Manchmal ist es sinnvoll, nur einen kleinen Teil des Bildes zu suchen. Das ist besonders bei Bildern nützlich, die als Ganzes variieren, aber bestimmte Bereiche davon gleich bleiben. Ein Bildausschnitt kann zum Beispiel wie folgt durchgeführt werden:</p>
<ol>
  <li>ALT+DRUCK drücken, während das Bild im aktiven Fenster sichtbar ist. Der Screenshot landet in der Zwischenablage. </li>
  <li>Ein Bildbearbeitungsprogramm wie Paint öffnen.</li>
  <li>Den Inhalt der Zwischenablage einfügen (in diesem Fall der Screenshot).</li>
  <li>Bereich markieren, der nicht variiert und nur einmal im Bild vorkommt.</li>
  <li>Den Bereich kopieren und in einer neuen Bilddatei einfügen.</li>
  <li>Die Datei speichern, damit sie mit ImageSearch verwendet werden kann.</li>
</ol>
<p>Damit eine Übereinstimmung erfolgen kann, muss das Bild auf dem Bildschirm so groß wie das Bild sein, welches mit dem <em>Bilddatei</em>-Parameter und dessen Optionen geladen wurde.</p>
<p>Der Suchbereich muss sichtbar sein. Das heißt, dass es nicht möglich ist, einen Bereich in einem Fenster zu suchen, das hinter einem anderen Fenster liegt. Bilder, die sich unter dem Mauszeiger befinden, werden weiterhin erkannt. Die Ausnahme machen Mauszeiger bei Spielen, weil diese die Sicht auf darunterliegende Bilder behindern.</p>
<p>Die Suche beginnt auf der obersten Zeile des Bereichs und wird nach unten hin fortgesetzt. Bei mehreren Übereinstimmungen wird der oberste Fund bevorzugt.</p>
<p>Bei den Icons ist das so geregelt, dass transparente Farben automatisch mit jeder Farbe auf dem Bildschirm übereinstimmen. Daher spielt die Farbe hinter dem Icon keine Rolle.</p>
<p>ImageSearch unterstützt Bildschirme mit 8-Bit-Farben (256 Farben) oder höher.</p>
<p>Das Suchverhalten ist von der Farbtiefe der Grafikkarte abhängig (besonders bei GIF- und JPG-Dateien). Wenn ein Script daher bei mehreren Farbtiefen ausgeführt wird, ist es sinnvoll, das Script zuerst mit jeder Tiefeneinstellung zu testen. Die Option für Farbtontoleranz (*n) kann dabei helfen, das Verhalten zwischen mehreren Farbtiefen konstant zu machen.</p>
<p>Es ist möglich, dass die Suche mit ImageSearch fehlschlägt, wenn das Bild auf dem Bildschirm durchsichtig ist. Als Übergangslösung kann die Option für Farbtontoleranz (*n) ausprobiert werden oder das Fenster kurzzeitig mit <a href="WinSet.htm#trans"><code>WinSet, Transparent, Off</code></a> undurchsichtig gemacht werden.</p>
<h3>Verwandte Befehle</h3>
<p><a href="PixelSearch.htm">PixelSearch</a>, <a href="PixelGetColor.htm">PixelGetColor</a>, <a href="CoordMode.htm">CoordMode</a>, <a href="MouseGetPos.htm">MouseGetPos</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">ImageSearch, FoundX, FoundY, 40,40, 300, 300, C:\Eigene Bilder\test.bmp

CoordMode Pixel  <em>;  Koordinaten beziehen sich auf dem Bildschirm, anstatt auf das aktive Fenster.</em>
ImageSearch, XPos, YPos, 0, 0, A_ScreenWidth, A_ScreenHeight, *Icon3 %A_ProgramFiles%\BeliebigerOrdner\BeliebigeApp.exe
If ErrorLevel = 2
    MsgBox Die Suche konnte nicht durchgeführt werden.
Else If ErrorLevel = 1
    MsgBox Icon konnte nicht auf dem Bildschirm gefunden werden.
Else
    MsgBox Das Icon wurde bei %XPos%x%YPos% gefunden.</pre>
</body>
</html>
