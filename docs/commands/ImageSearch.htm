<!DOCTYPE HTML>
<html>
<head>
<title>ImageSearch</title>
<meta name="keywords" content="Befehl, Bildschirm">
<meta name="description" content="Verwendet ImageSearch in dieser freien Scriptsprache, um ein ICO-, BMP- oder PNG-Bild auf dem Bildschirm zu suchen. Sendet daraufhin Tastatureingaben oder Mausklicks.">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="../static/html5.js"></script>
<![endif]-->
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <div id="article">
      <h1>ImageSearch</h1>
      <p>Sucht in einem bestimmten Bildschirmbereich nach einem Bild.</p>
      <pre class="Syntax">ImageSearch, AusgabevariableX, AusgabevariableY, X1, Y1, X2, Y2, Bilddatei</pre>
      <h3>Parameter</h3>
      <table class="info">
        <tr>
          <td style="width: 15%;">AusgabevariableX/Y</td>
          <td style="width: 85%;"><p>Die Namen der Variablen, in denen die Koordinaten X und Y des oberen linken Pixels gespeichert werden, bei dem das Bild gefunden wurde (wenn das Bild nicht gefunden wird, werden diese Variablen leer gemacht). Die Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu &auml;ndern.</p>
            <p>Es kann ein oder beide Parameter leer gelassen werden. In diesem Fall kann mit ErrorLevel (siehe unten) festgestellt werden, ob eine &Uuml;bereinstimmung gefunden wurde.</p></td>
        </tr>
        <tr>
          <td>X1,Y1</td>
          <td>Die Koordinaten X und Y der oberen linken Ecke des rechteckigen Suchbereichs, die <a href="../Variables.htm#Expressions">Ausdr&uuml;cke</a> sein k&ouml;nnen. <strong>Die Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu &auml;ndern.</strong></td>
        </tr>
        <tr>
          <td>X2,Y2</td>
          <td>Die Koordinaten X und Y der unteren rechten Ecke des rechteckigen Suchbereichs, die <a href="../Variables.htm#Expressions">Ausdr&uuml;cke</a> sein k&ouml;nnen. Die Koordinaten beziehen sich auf das aktive Fenster, es sei denn, <a href="CoordMode.htm">CoordMode</a> wurde dazu verwendet, dass zu &auml;ndern.</td>
        </tr>
        <tr>
          <td>Bilddatei</td>
          <td><p>Der Name des Bildes, das sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis befindet, solange kein absoluter Pfad angegeben ist. Alle Betriebssysteme unterst&uuml;tzen GIF, JPG, BMP, ICO, CUR und ANI (BMP-Bilder m&uuml;ssen 16-Bit oder h&ouml;her sein). Andere Quellen von Icons k&ouml;nnen sein: EXE, DLL, CPL, SCR und andere Typen, die Icon-Ressourcen enthalten. In Windows XP (oder h&ouml;her) werden zus&auml;tzliche Bildformate wie PNG, TIF, Exif, WMF und EMF unterst&uuml;tzt. Betriebssysteme &auml;lter als XP k&ouml;nnen unterst&uuml;tzt werden, wenn die freie GDIPlus.dll von Microsoft in den Ordner der AutoHotkey.exe kopiert wird (im Falle eines <a href="../Scripts.htm#ahk2exe">kompilierten Scripts</a> muss die DLL-Datei in den Ordner des Scripts). Die DLL kann mit folgenden Suchbegriffen auf <a href="http://www.microsoft.com">www.microsoft.com</a> gefunden werden: gdi redistributable</p>
            <p><strong>Optionen</strong>: Beliebig viele folgende Strings k&ouml;nnen vor dem Dateinamen stehen. Die Optionen werden mit einem Leerzeichen oder Tabulator getrennt. Zum Beispiel: <code>*2 *w100 *h-1 C:\Hauptlogo.bmp</code>.</p>
            <p><strong>*IconN</strong>: Um eine beliebige Icon-Gruppe aus einer Datei zu verwenden, kann in den <i>Optionen</i> das Wort <code>*Icon</code> eingef&uuml;gt werden, gefolgt von der Gruppennummer. Zum Beispiel w&uuml;rde mit <code>*Icon2</code> das Standard-Icon aus der zweiten Icon-Gruppe geladen.</p>
            <p><strong>*n</strong> (Variation): F&uuml;r <strong>n</strong> kann eine Nummer zwischen 0 und 255 angegeben werden, um den Farbtontoleranzbereich von Rot-, Gr&uuml;n- und Blaukomponenten jeder Pixelfarbe zu bestimmen. Zum Beispiel erlaubt <code>*2</code> zwei Farbtonvarianten. Dieser Parameter ist hilfreich, wenn die Bildfarbe leicht variiert oder die <em>Bilddatei</em> ein Format wie GIF oder JPG benutzt, dass auf dem Bildschirm nicht richtig dargestellt wird. Bei 255 Farbtonvarianten stimmen alle Farben &uuml;berein. Standard sind 0 Farbtonvarianten.</p>
            <p><strong>*TransN</strong>: Diese Option macht es einfacher, eine &Uuml;bereinstimmung zu finden, wenn eine Farbe des Bildes angegeben wird, die mit jeder beliebigen Farbe auf dem Bildschirm &uuml;bereinstimmt. Diese wird h&auml;ufig bei PNG-, GIF- und TIF-Dateien verwendet, die transparente Bereiche enthalten (Icons ben&ouml;tigen diese Option nicht, weil die Transparenz automatisch unterst&uuml;tzt wird). Bei GIF-Dateien funktioniert meistens <code>*TransWhite</code>. Bei PNG- oder TIF-Dateien eher <code>*TransBlack</code>. Ansonsten kann f&uuml;r <strong>N</strong> ein anderer Farbname oder RGB-Wert angegeben werden (siehe <a href="Progress.htm#colors">Farbtabelle</a> oder verwendet <a href="PixelGetColor.htm">PixelGetColor</a> im RGB-Modus). Beispiele: <code>*TransBlack</code>, <code>*TransFFFFAA</code>, <code>*Trans0xFFFFAA</code>.</p>
            <p><strong>*wn</strong> und <strong>*hn</strong>: Bild auf die angegebene Breite und/oder H&ouml;he skalieren (diese Breite und H&ouml;he bestimmt auch, welches Icon von einer .ICO-Datei mit mehreren Icons geladen wird). Sobald beide Optionen nicht vorhanden sind, werden die geladenen Icons von einer ICO-, DLL- oder EXE-Datei auf die Standardgr&ouml;&szlig;e der kleinen Icons skaliert, in der Regel 16x16 (die aktuelle/interne Gr&ouml;&szlig;e kann mit <code>*w0 *h0</code> erzwungen werden). Bilder, die keine Icons sind, werden in ihrer aktuellen Gr&ouml;&szlig;e geladen. Um das Bild unter Beibehaltung des Seitenverh&auml;ltnisses zu verkleinern oder zu vergr&ouml;&szlig;ern, verwendet -1 f&uuml;r eine Abmessung und eine positive Zahl f&uuml;r die andere Abmessung. Mit <code>*w200 *h-1</code> beispielsweise wird die Breite des Bildes auf 200 Pixel gesetzt und die H&ouml;he automatisch eingestellt.</p></td>
        </tr>
      </table>
      <h3>ErrorLevel</h3>
      <p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszul&ouml;sen. F&uuml;r mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
      <p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 0 gesetzt, wenn das Bild im angegebenen Bereich gefunden wird. Ansonsten auf 1, wenn es nicht gefunden wird, oder auf 2, wenn der Befehl daran gehindert wird, die Suche durchzuf&uuml;hren (z. B. die Bilddatei kann nicht ge&ouml;ffnet werden oder eine falsch formatierte Option).</p>
      <h3>Bemerkungen</h3>
      <p>ImageSearch kann dazu verwendet werden, grafische Objekte auf einem Bildschirm zu erkennen, auf dem Text weder vorhanden ist noch auf einfache Weise ermittelt werden kann. Zum Beispiel ist ImageSearch in der Lage, die Position von Bild-Schaltfl&auml;chen, Icons, Links von Webseiten oder Spielobjekte zu erkennen. Sobald solche Objekte gefunden werden, k&ouml;nnen diese mit <a href="Click.htm">Click</a> angeklickt werden.</p>
      <p>Manchmal ist es sinnvoll, nur einen kleinen Teil des Bildes zu suchen. Das ist besonders bei Bildern n&uuml;tzlich, die als Ganzes variieren, aber bestimmte Bereiche davon gleich bleiben. Ein Bildausschnitt kann zum Beispiel wie folgt durchgef&uuml;hrt werden:</p>
      <ol>
        <li> Alt+Druck dr&uuml;cken, w&auml;hrend das Bild im aktiven Fenster sichtbar ist. Der Screenshot landet in der Zwischenablage. </li>
        <li> Ein Bildbearbeitungsprogramm wie Paint &ouml;ffnen.</li>
        <li> Den Inhalt der Zwischenablage einf&uuml;gen (in diesem Fall der Screenshot).</li>
        <li> Bereich markieren, der nicht variiert und nur einmal im Bild vorkommt.</li>
        <li> Den Bereich kopieren und in einer neuen Bilddatei einf&uuml;gen.</li>
        <li> Die Datei speichern, damit sie mit ImageSearch verwendet werden kann.</li>
      </ol>
      <p>Damit eine &Uuml;bereinstimmung erfolgen kann, muss das Bild auf dem Bildschirm so gro&szlig; wie das Bild sein, welches mit dem <em>Bilddatei</em>-Parameter und dessen Optionen geladen wurde.</p>
      <p>Der Suchbereich muss sichtbar sein. Das hei&szlig;t, dass es nicht m&ouml;glich ist, einen Bereich in einem Fenster zu suchen, das hinter einem anderen Fenster liegt. Bilder, die sich unter dem Mauszeiger befinden, werden weiterhin erkannt. Die Ausnahme machen Mauszeiger bei Spielen, weil diese die Sicht auf darunterliegende Bilder behindern.</p>
      <p>Die Suche beginnt auf der obersten Zeile des Bereichs und wird nach unten hin fortgesetzt. Bei mehreren &Uuml;bereinstimmungen wird der oberste Fund bevorzugt.</p>
      <p>Bei den Icons ist das so geregelt, dass transparente Farben automatisch mit jeder Farbe auf dem Bildschirm &uuml;bereinstimmen. Daher spielt die Farbe hinter dem Icon keine Rolle.</p>
      <p>ImageSearch unterst&uuml;tzt Bildschirme mit 8-Bit-Farben (256 Farben) oder h&ouml;her.</p>
      <p>Das Suchverhalten ist von der Farbtiefe der Grafikkarte abh&auml;ngig (besonders bei GIF- und JPG-Dateien). Wenn ein Script daher bei mehreren Farbtiefen ausgef&uuml;hrt wird, ist es sinnvoll, das Script zuerst mit jeder Tiefeneinstellung zu testen. Die Option f&uuml;r Farbtontoleranz (*n) kann dabei helfen, das Verhalten zwischen mehreren Farbtiefen konstant zu machen.</p>
      <p>Es ist m&ouml;glich, dass die Suche mit ImageSearch fehlschl&auml;gt, wenn das Bild auf dem Bildschirm durchsichtig ist. Als &Uuml;bergangsl&ouml;sung kann die Option f&uuml;r Farbtontoleranz (*n) ausprobiert werden oder das Fenster kurzzeitig mit <a href="WinSet.htm#trans">WinSet, Transparent, Off</a> undurchsichtig gemacht werden.</p>
      <h3>Verwandte Befehle</h3>
      <p><a href="PixelSearch.htm">PixelSearch</a>, <a href="PixelGetColor.htm">PixelGetColor</a>, <a href="CoordMode.htm">CoordMode</a>, <a href="MouseGetPos.htm">MouseGetPos</a></p>
      <h3>Beispiele</h3>
      <pre class="NoIndent">ImageSearch, FoundX, FoundY, 40,40, 300, 300, C:\Eigene Bilder\test.bmp

CoordMode Pixel  <em>;  Koordinaten beziehen sich auf dem Bildschirm, anstatt auf das aktive Fenster.</em>
ImageSearch, XPos, YPos, 0, 0, A_ScreenWidth, A_ScreenHeight, *Icon3 %A_ProgramFiles%\BeliebigerOrdner\BeliebigeApp.exe
If ErrorLevel = 2
    MsgBox Die Suche konnte nicht durchgef&uuml;hrt werden.
Else If ErrorLevel = 1
    MsgBox Icon konnte nicht auf dem Bildschirm gefunden werden.
Else
    MsgBox Das Icon wurde bei %XPos%x%YPos% gefunden.</pre>
    </div>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>