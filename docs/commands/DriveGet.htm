<!DOCTYPE HTML>
<html>
<head>
<title>DriveGet</title>
<meta name="keywords" content="Befehl, Laufwerk">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <article>
    <h1>DriveGet</h1>
    <p>Ermittelt unterschiedliche Informationen über die Laufwerke eines Computers.</p>
    <pre class="Syntax">DriveGet, AusgabeVar, Befehl [, Wert]</pre>
    <h3>Parameter</h3>
    <table class="info">
      <tr>
        <td style="width: 15%;">AusgabeVar</td>
        <td style="width: 85%;"><p>Name der Variable, in der der Rückgabewert vom <em>Befehl</em> gespeichert werden soll.</p></td>
      </tr>
      <tr>
        <td>Befehl, Wert</td>
        <td>Siehe untere Liste. </td>
      </tr>
    </table>
    <h3>Befehl, Wert</h3>
    <p>Die Parameter <em>Befehl</em> und <em>Wert</em> sind voneinander abhängig und können wie folgt verwendet werden. Bei einem Problem wird <em>AusgabeVar</em> leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
    <p><strong>List [, Typ]</strong>: <em>AusgabeVar</em> enthält die Buchstaben aller verfügbaren Laufwerke. Zum Beispiel: ACDEZ. Sobald der <em>Typ</em> weggelassen wird, werden alle Laufwerksarten abgerufen. Andernfalls sollte der <em>Typ</em> eins der folgenden Wörter sein, um nur eine bestimmte Laufwerksart zu ermitteln: CDROM, REMOVABLE, FIXED, NETWORK, RAMDISK, UNKNOWN.</p>
    <p><strong>Capacity (oder Cap), Pfad</strong>: Ermittelt die Gesamtkapazität vom <em>Pfad</em> (z. B. C:\) in Megabyte. Mithilfe von <a href="DriveSpaceFree.htm">DriveSpaceFree</a> kann der freie Speicherplatz abgerufen werden.</p>
    <p><strong>Filesystem (oder FS), Laufwerk</strong>: Ermittelt das Dateisystem des <em>Laufwerks</em>, wobei im Parameter <em>Laufwerk</em> der Laufwerksbuchstabe, gefolgt von einem Doppelpunkt und einem Backslash, oder ein UNC-Name wie \server1\share1 angegeben werden muss. <em>AusgabeVar</em> wird eins der folgenden Wörter enthalten: FAT, FAT32, NTFS, CDFS (für eine CD), UDF (für eine DVD). <em>AusgabeVar</em> wird leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt, wenn das Laufwerk kein formatiertes Medium enthält.</p>
    <p><strong>Label, Laufwerk</strong>: Ermittelt die Datenträgerbezeichnung des <em>Laufwerks</em>, wobei im Parameter <em>Laufwerk</em> ein Laufwerksbuchstabe, gefolgt von einem Doppelpunkt und einem Backslash, oder ein UNC-Name wie \server1\share1 angegeben werden muss. Die aktuelle Bezeichnung kann wie folgt geändert werden: <code><a href="Drive.htm">Drive</a>, Label, C:, EigenesLabel</code>.</p>
    <p><strong>Serial, Laufwerk</strong>: Ermittelt die Datenträgerseriennummer des <em>Laufwerks</em>, wobei im Parameter <em>Laufwerk</em> ein Laufwerksbuchstabe, gefolgt von einem Doppelpunkt und einem Backslash, oder ein UNC-Name wie \server1\share1 angegeben werden muss. Siehe <a href="SetFormat.htm">SetFormat</a>, wie die Nummer in hexadezimal umgewandelt werden kann.</p>
    <p><strong>Type, Pfad</strong>: Ermittelt den Laufwerkstyp des <em>Pfads</em>: Unknown, Removable, Fixed, Network, CDROM, RAMDisk.</p>
    <p><strong>Status, Pfad</strong>: Ermittelt den Laufwerksstatus des <em>Pfads</em>: Unknown (könnte auf unformatiert/RAW hindeuten), Ready, NotReady (typisch für Wechseldatenträger, die kein Medium enthalten), Invalid (<em>Pfad</em> existiert nicht, ein Netzwerk-Laufwerk ist zurzeit nicht erreichbar, usw.)</p>
    <p><strong>StatusCD [, Laufwerk]</strong>: Ermittelt den Mediumstatus eines CD- oder DVD-Laufwerks, wobei im Parameter <em>Laufwerk</em> der Laufwerksbuchstabe, gefolgt von einem Doppelpunkt, angegeben werden kann (sobald das <em>Laufwerk</em> weggelassen wird, wird das Standard-CD/DVD-Laufwerk verwendet). <em>AusgabeVar</em> wird leer gemacht, wenn der Status nicht ermittelt werden kann. Ansonsten enthält sie einen der folgenden Strings:</p>
    <table class="info">
      <tr>
        <td style="width: 15%;">not ready</td>
        <td style="width: 85%;">Das Laufwerk ist nicht erreichbar, da es vermutlich an einer Schreib-Operation beteiligt ist. Bekannte Einschränkung: "not ready" tritt auch auf, wenn das Laufwerk eine DVD anstelle einer CD enthält.</td>
      </tr>
      <tr>
        <td>open</td>
        <td>Das Laufwerk enthält kein Medium oder ist offen.</td>
      </tr>
      <tr>
        <td>playing</td>
        <td>Das Laufwerk spielt gerade ein Medium ab.</td>
      </tr>
      <tr>
        <td>paused</td>
        <td>Das zuvor abgespielte Audio oder Video ist nun pausiert. </td>
      </tr>
      <tr>
        <td>seeking</td>
        <td>Das Laufwerk ist beim Suchen. </td>
      </tr>
      <tr>
        <td>stopped</td>
        <td>Das Laufwerk enthält eine CD, die jedoch zurzeit nicht verwendet wird.</td>
      </tr>
    </table>
    <p>Dieser Befehl wird wahrscheinlich nicht funktionieren, wenn das Laufwerk sich im Netzwerk befindet oder kein CD/DVD-Laufwerk ist. In solchen oder ähnlichen Fällen wird <em>AusgabeVar</em> leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
    <p>Die Ausführung des Befehls wird möglicherweise hinausgezögert, falls das Laufwerk gerade geschlossen wurde.<br>
    </p>
    <p>Mit dem <a href="Drive.htm">Drive</a>-Befehl kann das Laufwerk aus- oder eingefahren werden.</p>
    <h3>ErrorLevel</h3>
    <p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
    <p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt.</p>
    <h3>Bemerkungen</h3>
    <p>Einige dieser Befehle akzeptieren auch Netzwerkfreigabenamen als <em>Pfad</em> (z. B. \\EigenerServer\EigeneFreigabe\).</p>
    <h3>Verwandte Befehle</h3>
    <p><a href="Drive.htm">Drive</a>, <a href="DriveSpaceFree.htm">DriveSpaceFree</a></p>
    <h3>Beispiel</h3>
    <pre class="NoIndent"><em>; Das ist ein funktionierendes Beispiel-Script.</em>
FileSelectFolder, folder, , 3, Laufwerk zur Überprüfung auswählen:
If folder =
    Return
DriveGet, list, list
DriveGet, cap, capacity, %folder%
DrivespaceFree, free, %folder%
DriveGet, fs, fs, %folder%
DriveGet, label, label, %folder%
DriveGet, serial, serial, %folder%
DriveGet, type, type, %folder%
DriveGet, status, status, %folder%
MsgBox Alle Laufwerke: %list%`nAusgewählt: %folder%`nTyp: %type%`nStatus: %status%`nSpeicherkapazität (in MB): %cap% M`nFreier Speicher (in MB): %free% M`nDateisystem: %fs%`nBezeichnung: %label%`nSeriennummer: %serial%</pre>
  </article>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>