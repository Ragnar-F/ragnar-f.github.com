<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>DriveGet</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>DriveGet</h1>

<p>Ermittelt unterschiedliche Informationen &uuml;ber die Laufwerke eines Computers.</p>

<pre class="Syntax">DriveGet, Ausgabevariable, Befehl [, Wert]</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td width="15%">Ausgabevariable</td>
    <td width="85%"><p>Der Name der Variable, in der der R&uuml;ckgabewert vom <em>Befehl</em> gespeichert wird.</p></td>
  </tr>
  <tr>
    <td>Befehl, Wert</td>
    <td>Siehe untere Liste.
    </td>
  </tr>
</table>

<h3>Befehl, Wert</h3>
<p>Die Parameter <em>Befehl</em> und <em>Wert</em> sind voneinander abh&auml;ngig und k&ouml;nnen wie folgt verwendet werden. Wenn ein Problem auftritt, dann wird <em>Ausgabevariable</em> leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
<p><strong>List [, Typ]</strong>: <em>Ausgabevariable</em> enth&auml;lt die Buchstaben aller verf&uuml;gbaren Laufwerke. Zum Beispiel: ACDEZ. Wenn der <em>Typ</em> nicht vorhanden ist, dann werden alle Laufwerksarten abgerufen. Andernfalls sollte der <em>Typ</em> ein folgendes Wort sein, um nur bestimmte Laufwerksarten zu ermitteln: CDROM, REMOVABLE, FIXED, NETWORK, RAMDISK, UNKNOWN.</p>
<p><strong>Capacity (oder Cap), Pfad</strong>: Ruft die Gesamtkapazit&auml;t vom <em>Pfad</em> (z. B. C:\) in Megabyte ab. Mit <a href="DriveSpaceFree.htm">DriveSpaceFree</a> kann der freie Speicher ermittelt werden.</p>
<p><strong>Filesystem (oder FS), Laufwerk</strong>: Ermittelt das Dateisystem vom <em>Laufwerk</em>, wobei das <em>Laufwerk</em> ein Laufwerksbuchstabe (gefolgt von einem Doppelpunkt und einem Backslash) oder ein UNC-Name (z. B. \server1\share1) ist. <em>Ausgabevariable</em> wird ein folgendes Wort enthalten: FAT, FAT32, NTFS, CDFS (f&uuml;r eine CD), UDF (f&uuml;r eine DVD). <em>Ausgabevariable</em> will wird leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt, wenn das Laufwerk kein formatiertes Medium enth&auml;lt.</p>
<p><strong>Label, Laufwerk</strong>: Ermittelt die Datentr&auml;gerbezeichnung vom <em>Laufwerk</em>, wobei das <em>Laufwerk</em> ein Laufwerksbuchstabe (gefolgt von einem Doppelpunkt und einem Backslash) oder ein UNC-Name (z. B. \server1\share1) ist. Zum &Auml;ndern der aktuellen Bezeichnung, siehe folgendes Beispiel: <a href="Drive.htm">Drive</a>, Label, C:, EigenesLabel</p>
<p><strong>Serial, Laufwerk</strong>: Ermittelt die Datentr&auml;gerseriennummer vom <em>Laufwerk</em>, wobei das <em>Laufwerk</em> ein Laufwerksbuchstabe (gefolgt von einem Doppelpunkt und einem Backslash) oder ein UNC-Name (z. B. \server1\share1) ist. Siehe <a href="SetFormat.htm">SetFormat</a>, wie die Nummer in hexadezimal konvertieren werden kann.</p>
<p><strong>Type, Pfad</strong>: Ermittelt den Typ des Laufwerks im <em>Pfad</em>: Unknown, Removable, Fixed, Network, CDROM, RAMDisk.</p>
<p><strong>Status, Pfad</strong>: Ermittelt den Status des Laufwerks im <em>Pfad</em>: Unknown (k&ouml;nnte auf unformatiert/RAW hindeuten), Ready, NotReady (typisch f&uuml;r Wechseldatentr&auml;ger, die keine Medien enthalten), Invalid (<em>Pfad</em> existiert nicht, ein Netzwerk-Laufwerk ist zurzeit nicht erreichbar, usw.)</p>
<p><strong>StatusCD [, Laufwerk]</strong>: Ermittelt den Medienstatus eines CD- oder DVD-Laufwerks, wobei das <em>Laufwerk</em> ein Laufwerksbuchstabe gefolgt von einem Doppelpunkt ist (wenn das <em>Laufwerk</em> nicht vorhanden ist, dann wird das Standard-CD/DVD-Laufwerk verwendet). <em>Ausgabevariable</em> wird leer gemacht, wenn der Status nicht ermittelt werden kann. Ansonsten enth&auml;lt sie einen folgenden String:</p>
<table class="info">
  <tr>
    <td width="15%">not ready</td>
    <td width="85%">Auf das Laufwerk kann noch nicht zugegriffen werden, da sie vielleicht an einer Schreib-Operation beteiligt ist. Bekannte Einschr&auml;nkung: "not ready" tritt auch auf, wenn das Laufwerk eine DVD anstelle einer CD enth&auml;lt.</td>
  </tr>
  <tr>
    <td>open</td>
    <td>Das Laufwerk enth&auml;lt kein Medium oder ist offen.</td>
  </tr>
  <tr>
    <td>playing</td>
    <td>Das Laufwerk spielt gerade ein Medium ab.</td>
  </tr>
  <tr>
    <td>paused</td>
    <td>Das zuvor abgespielte Audio oder Video ist nun pausiert. </td>
  </tr>
  <tr>
    <td>seeking</td>
    <td>Das Laufwerk ist beim Suchen. </td>
  </tr>
  <tr>
    <td>stopped</td>
    <td>Das Laufwerk enth&auml;lt eine CD, aber es wird zurzeit nicht darauf zugegriffen.</td>
  </tr>
</table>
<p>Dieser Befehl funktioniert wahrscheinlich nicht mit einem Netzwerk- oder CD/DVD-Laufwerk; in solchen F&auml;llen wird die <em>Ausgabevariable</em> leer gemacht und <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
<p>Wenn das Laufwerk vor Kurzem geschlossen wurde, dann kann es eine Verz&ouml;gerung geben, bevor der Befehl ausgef&uuml;hrt wird.</p>
<p>Mit dem Befehl <a href="Drive.htm">Drive</a> kann das Laufwerk ge&ouml;ffnet oder geschlossen werden.</p>
<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszul&ouml;sen. F&uuml;r mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p>Bei Problemen wird <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt, ansonsten enth&auml;lt ErrorLevel eine 0.</p>
<h3>Bemerkungen</h3>
<p>Einige dieser Befehle akzeptieren auch eine Netzwerkfreigabe im <em>Pfad</em> (z. B. \\EigenerServer\EigeneFreigabe\).</p>
<h3>Verwandte Befehle</h3>
<p><a href="Drive.htm">Drive</a>, <a href="DriveSpaceFree.htm">DriveSpaceFree</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent"><em>; Das ist ein funktionierendes Beispiel-Script.</em>
FileSelectFolder, Ordner, , 3, Laufwerk zur &Uuml;berpr&uuml;fung ausw&auml;hlen:
If Ordner =
    Return
DriveGet, list, list
DriveGet, cap, capacity, %folder%
DrivespaceFree, free, %folder%
DriveGet, fs, fs, %folder%
DriveGet, label, label, %folder%
DriveGet, serial, serial, %folder%
DriveGet, type, type, %folder%
DriveGet, status, status, %folder%
MsgBox Alle Laufwerke: %list%`nAusgew&auml;hlt: %folder%`nTyp: %type%`nStatus: %status%`nSpeicherkapazit&auml;t (in MB): %cap% M`nFreier Speicher (in MB): %free% M`nDateisystem: %fs%`nBezeichnung: %label%`nSeriennummer: %serial%</pre>

</body>
</html>