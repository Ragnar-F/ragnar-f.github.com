<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>PostMessage / SendMessage</title>
<meta name="description" content="Send messages to a window with this free macro program. PostMessage puts a message in the window's message queue, but SendMessage waits for a reply.">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link href="../css/default.css" rel="stylesheet" type="text/css">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28224374-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body>
<script src="../../NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
<script language="JavaScript1.2" type="text/javascript">WriteNavLink(2);</script>


<h1>PostMessage / SendMessage</h1>

<p>Sendet eine Nachricht an ein Fenster oder Steuerelement (SendMessage wartet zus&auml;tzlich auf eine Best&auml;tigung).</p>

<pre class="Syntax">PostMessage, Nachricht [, wParam, lParam, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme]
SendMessage, Nachricht [, wParam, lParam, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme]</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td>Nachricht</td>
    <td>Die zu sendende Nummer der Nachricht, die auch ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein kann. Siehe <a href="../misc/SendMessageList.htm">Nachrichtenliste</a>, um die Nummer zu ermitteln. </td>
  </tr>
  <tr>
    <td>wParam</td>
    <td>Die erste Komponente der Nachricht, die auch ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein kann. Wenn leer oder nicht vorhanden, dann wird eine 0 gesendet.</td>
  </tr>
  <tr>
    <td>lParam</td>
    <td>Die zweite Komponente der Nachricht, die auch ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein kann.  Wenn leer oder nicht vorhanden, dann wird eine 0 gesendet.</td>
  </tr>
  <tr>
    <td>Steuerelement</td>
    <td><p>Wenn dieser Parameter leer oder nicht vorhanden ist, dann wird die Nachricht direkt ans Zielfenster gesendet, anstatt ans Steuerelement. M&ouml;glich ist entweder ClassNN (Klassenname und Instanznummer des Steuerelements) oder Name/Text des Steuerelements, die beide mit Windows Spy ermittelt werden k&ouml;nnen. Wenn Name/Text verwendet wird, wird das &Uuml;bereinstimmungsverhalten mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> bestimmt.</p>
    <p>F&uuml;r das HWND eines Steuerelements (Windows Handle) wird der <em>Steuerelement</em>-Parameter leer gelassen und <em>ahk_id %SteuerelementHwnd%</em> im <em>Fenstertitel</em>-Parameter angegeben (funktioniert auch bei versteckten Steuerelementen, selbst wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist). Das HWND eines Steuerelements wird &uuml;blicherweise mittels <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a> oder <a href="DllCall.htm">DllCall</a> abgerufen.</p>
    </td>
  </tr>
  <tr>
    <td width="15%">Fenstertitel</td>
    <td width="85%">Der Titel oder Teiltitel des Fensters (das &Uuml;bereinstimmungsverhalten wird mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> bestimmt). Wenn dieser und die n&auml;chsten 3 Parameter nicht vorhanden sind, dann wird das <a href="../LastFoundWindow.htm">zuletzt gefundene Fenster</a> verwendet. Wenn dieser den Buchstaben A enth&auml;lt und die n&auml;chsten 3 Parameter nicht vorhanden sind, dann wird das aktive Fenster verwendet. Bei Verwendung einer Fensterklasse muss ahk_class ExakterKlassenname angegeben werden (wird von Windows Spy angezeigt). Bei Verwendung einer <a href="Process.htm">Prozess-Kennung (PID)</a> muss ahk_pid %VariableMitPID% angegeben werden. Bei Verwendung einer <a href="GroupAdd.htm">Fenstergruppe</a> muss ahk_group Gruppenname angegeben werden. Bei Verwendung einer <a href="WinGet.htm">eindeutigen ID-Nummer</a> eines Fensters muss ahk_id %VariableMitID% angegeben werden (akzeptiert auch <a href="ControlGet.htm#Hwnd">HWND eines Steuerelements</a>). Die Suche kann durch Angabe <a href="../LastFoundWindow.htm#multi">mehrerer Kriterien</a> eingeschr&auml;nkt werden. Zum Beispiel: <em>Eigene Datei.txt ahk_class Notepad</em></td>
  </tr>
  <tr>
    <td>Fenstertext</td>
    <td>Wenn vorhanden, dann muss dieser Parameter einen Teil der einzelnen Textelemente des Fensters enthalten (wird von Windows Spy angezeigt). Versteckte Textelemente werden erfasst, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</td>
  </tr>
  <tr>
    <td>Titelausnahme</td>
    <td>Fenstertitel mit diesem Wert werden nicht ber&uuml;cksichtigt.</td>
  </tr>
  <tr>
    <td>Textausnahme</td>
    <td>Fenstertexte mit diesem Wert werden nicht ber&uuml;cksichtigt.</td>
  </tr>
</table>

<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszul&ouml;sen. F&uuml;r mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p>PostMessage: <a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, falls ein Problem auftrat, wie das Nichtvorhandensein des Zielfensters oder Steuerelements. Ansonsten auf 0.</p>
<p>SendMessage: <a href="../misc/ErrorLevel.htm">ErrorLevel</a> enth&auml;lt das Wort FAIL, wenn ein Problem auftrat. Ansonsten wird das numerische Ergebnis der Nachricht verwendet, dass manchmal eine "Antwort" je nach Art der Nachricht und des Zielfensters ist. Dieses Ergebnis ist ein Integer-Wert zwischen 0 und 4294967295. Wenn das Ergebnis als signed Integer vorgesehen ist, dann kann eine negative Zahl mit dem folgenden Beispiel offenbart werden: <em>Nachrichtenantwort := ErrorLevel &gt; 0x7FFFFFFF ? -(~ErrorLevel) - 1 : ErrorLevel</em></p>
<h3>Bemerkungen</h3>
<p>Diese Befehle sollten mit Vorsicht verwendet werden, da das Senden einer Nachricht an das falsche Fenster (oder das Senden einer ung&uuml;ltigen Nachricht) zu unerwartetem Verhalten oder sogar zum Absturz der Zielanwendung f&uuml;hren k&ouml;nnte. Denn die meisten Anwendungen sind nicht daf&uuml;r entworfen, um bestimmte Arten von Nachrichten aus externen Quellen zu erwarten.</p>
<p>PostMessage platziert die Nachricht in der Warteschlange, die dem Zielfenster zugeordnet ist. Es wartet nicht auf eine Best&auml;tigung oder Antwort. SendMessage hingegen wartet bis zu 5 Sekunden auf das Zielfenster, um die Nachricht zu verarbeiten. Wenn die Nachricht nicht innerhalb dieser Zeit verarbeitet wird, dann wird der Befehl beendet und ErrorLevel auf FAIL gesetzt.</p>
<p>Die Parameter <em>Nachricht</em>, <em>wParam</em> und <em>lParam</em> sollten Integer-Werte zwischen -2147483648 und 4294967295 (0xFFFFFFFF) enthalten. Wie bei allen Integer-Werten in AutoHotkey kennzeichnet das 0x-Pr&auml;fix einen Hex-Wert. Zum Beispiel entspricht 0xFF der Zahl 255.</p>
<p>Ein String kann mit <em>wParam</em> oder <em>lParam</em> gesendet werden, wenn die Adresse einer Variable angegeben wird. Im folgenden Beispiel wird daf&uuml;r der <a href="../Variables.htm#amp">Adressoperator (&)</a> verwendet:</p>
<pre>SendMessage, 0xC, 0, <strong>&EigeneVar</strong>, ClassNN, Fenstertitel  <em>; 0XC ist WM_SETTEXT</em></pre>
<p>Seit v1.0.43.06 wird ein String in EigeneVar, welcher vom Empf&auml;nger eingef&uuml;gt wurde, wahrscheinlich ohne zus&auml;tzliche Schritte erkannt. Dies funktioniert jedoch nur, wenn das erste Zeichen im Parameter ein kaufm&auml;nnisches Und (&) ist. Zum Beispiel funktioniert <em>5+&EigeneVar</em> nicht, aber <em>&EigeneVar</em> oder <em>&EigeneVar+5</em> funktionieren.</p>
<p>Ein direkt vorhandener String in Anf&uuml;hrungszeichen kann auch wie im folgenden Beispiel gesendet werden (der &-Operator sollte in diesem Fall nicht verwendet werden):</p>
<pre>Run Notepad
WinWaitActive Unbenannt - Editor
SendMessage, 0xC, 0, <strong>"Neuer Editor-Titel"</strong>  <em>; 0XC ist WM_SETTEXT</em></pre>
<p>Um eine Nachricht an alle Fenster zu senden, einschlie&szlig;lich derer, die versteckt oder deaktiviert sind, verwendet <em>ahk_id 0xFFFF</em> in <em>Fenstertitel</em> (0xFFFF ist HWND_BROADCAST). Diese Technik sollte nur f&uuml;r Nachrichten benutzt werden, die als Sammelaufruf gedacht sind, wie im folgenden Beispiel:</p>
<pre>SendMessage, 0x1A,,,, ahk_id 0xFFFF  <em>; 0x1A ist WM_SETTINGCHANGE</em></pre>
<p>Damit ein Script eine Nachricht empf&auml;ngt, verwendet <a href="OnMessage.htm">OnMessage()</a>.</p>
<p>Siehe <a href="../misc/SendMessage.htm">Nachricht-Tutorial</a> f&uuml;r eine Einf&uuml;hrung, wie diese Befehle verwendet werden.</p>
<p>Fenstertitel und -texte sind von der Gro&szlig;- und Kleinschreibung abh&auml;ngig. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>

<h3>Verwandte Befehle</h3>
<p><a href="../misc/SendMessageList.htm">Nachrichtenliste</a>, <a href="../misc/SendMessage.htm">Nachricht-Tutorial</a>, <a href="OnMessage.htm">OnMessage()</a>, <a href="../misc/Winamp.htm">Winamp automatisieren</a>, <a href="DllCall.htm">DllCall</a>, <a href="ControlSend.htm">ControlSend</a>, <a href="WinMenuSelectItem.htm">WinMenuSelectItem</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">#o::  <em>; Hotkey Win+O, der den Monitor ausschaltet.</em>
Sleep 1000  <em>; Erm&ouml;glicht dem Benutzer, die Taste los zulassen (falls dadurch der Monitor wieder aufgeweckt wird).
; Den Monitor ausschalten:</em>
SendMessage, 0x112, 0xF170, 2,, Program Manager  <em>; 0x112 ist WM_SYSCOMMAND, 0xF170 ist SC_MONITORPOWER.
; Beachtet: Verwendet -1 anstelle von 2, um den Monitor einzuschalten.
; Verwendet 1 anstelle von 2, um den Energiesparmodus des Monitors zu aktivieren.</em>
Return

<em>; Startet den ausgew&auml;hlten Bildschirmschoner des Benutzers:</em>
SendMessage, 0x112, 0xF140, 0,, Program Manager  <em>; 0x112 ist WM_SYSCOMMAND und 0xF140 ist SC_SCREENSAVE.</em>

<em>; Eine Zeile nach oben scrollen (f&uuml;r ein Steuerelement mit einer vertikalen Bildlaufleiste):</em>
ControlGetFocus, Steuerelement, A
SendMessage, 0x115, 0, 0, %Steuerelement%, A

<em>; Eine Zeile nach unten scrollen:</em>
ControlGetFocus, Steuerelement, A
SendMessage, 0x115, 1, 0, %Steuerelement%, A

<em>; Schaltet die Tastaturbelegung/Sprache des aktiven Fensters auf Englisch:</em>
PostMessage, 0x50, 0, 0x4090409,, A  <em>; 0x50 ist WM_INPUTLANGCHANGEREQUEST.</em>

<em>; Dieses Beispiel fragt Winamp, welche Track-Nummer zurzeit aktiv ist:</em>
SetTitleMatchMode, 2
SendMessage, 1024, 0, 120, - Winamp
If ErrorLevel &lt;&gt; FAIL
{
    ErrorLevel++  <em>; Die Z&auml;hlung von Winamp beginnt bei "0", also um 1 erh&ouml;hen.</em>
    MsgBox, Track #%ErrorLevel% ist aktiv oder wird abgespielt.
}
<em>; Siehe <a href="../misc/Winamp.htm">Winamp automatisieren</a> f&uuml;r weitere Informationen.</em>

<em>; Um die Prozess-ID eines AHK-Scripts zu finden (eine Alternative zu "<a href="WinGet.htm">WinGet PID</a>"):</em>
SetTitleMatchMode, 2
DetectHiddenWindows, on
SendMessage, 0x44, 0x405, 0, , BeliebigesScript.ahk - AutoHotkey v
MsgBox %ErrorLevel% ist die Prozess-ID.</pre>

</body>
</html>