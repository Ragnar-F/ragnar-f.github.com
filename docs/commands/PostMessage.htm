<!DOCTYPE HTML>
<html>
<head>
<title>PostMessage / SendMessage</title>
<meta name="keywords" content="Befehl, Fenster, Steuerelement">
<meta name="description" content="Sendet mit dieser freien Scriptsprache Nachrichten an ein Fenster. PostMessage f&uuml;gt eine Nachricht zur Nachrichtenwarteschlange des Fensters hinzu, w&auml;hrend SendMessage auf eine Antwort wartet.">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="../static/html5.js"></script>
<![endif]-->
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <div id="article">
      <h1>PostMessage / SendMessage</h1>
      <p>Sendet eine Nachricht an ein Fenster oder Steuerelement (SendMessage wartet zus&auml;tzlich auf eine Best&auml;tigung).</p>
      <pre class="Syntax">PostMessage, Nachricht [, wParam, lParam, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme]
SendMessage, Nachricht [, wParam, lParam, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme]</pre>
      <h3>Parameter</h3>
      <table class="info">
        <tr>
          <td>Nachricht</td>
          <td>Die zu sendende Nachrichtennummer, die auch ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein kann. Siehe <a href="../misc/SendMessageList.htm">Nachrichtenliste</a>, um die Nummer zu ermitteln.</td>
        </tr>
        <tr>
          <td>wParam</td>
          <td>Die erste Komponente der Nachricht, die auch ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein kann. Ist dieser Parameter leer oder nicht vorhanden, wird eine 0 gesendet.</td>
        </tr>
        <tr>
          <td>lParam</td>
          <td>Die zweite Komponente der Nachricht, die auch ein <a href="../Variables.htm#Expressions">Ausdruck</a> sein kann.  Ist dieser Parameter leer oder nicht vorhanden, wird eine 0 gesendet.</td>
        </tr>
        <tr>
          <td>Steuerelement</td>
          <td><p>Ist dieser Parameter leer oder nicht vorhanden, wird die Nachricht direkt zum Zielfenster gesendet, anstatt zu einem Steuerelement. Ansonsten kann dieser Parameter entweder ClassNN (Klassenname und Instanznummer des Steuerelements) oder Name/Text des Steuerelements sein - beide k&ouml;nnen mit Windows Spy ermittelt werden. Bei Name/Text wird das &Uuml;bereinstimmungsverhalten mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> bestimmt.</p>
            <p>Um ein Steuerelement per HWND (Windows Handle) anzusteuern, muss dieser Parameter leer gelassen und <code>ahk_id %SteuerelementHwnd%</code> im <em>Fenstertitel</em>-Parameter angegeben werden (funktioniert auch bei versteckten Steuerelementen, selbst dann, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist). Das HWND eines Steuerelements wird &uuml;blicherweise mit <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a> oder <a href="DllCall.htm">DllCall</a> abgerufen.</p></td>
        </tr>
        <tr>
          <td style="width: 15%;">Fenstertitel</td>
          <td style="width: 85%;">Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</td>
        </tr>
        <tr>
          <td>Fenstertext</td>
          <td>Falls vorhanden, muss dieser Parameter ein Teilstring sein, der in einem Textelement des Zielfensters vorkommt (wie von Windows Spy angezeigt). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</td>
        </tr>
        <tr>
          <td>Titelausnahme</td>
          <td>Ignoriert Fenster, deren Titel diesen Wert enthalten.</td>
        </tr>
        <tr>
          <td>Textausnahme</td>
          <td>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</td>
        </tr>
      </table>
      <h3>ErrorLevel</h3>
      <p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszul&ouml;sen. F&uuml;r mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
      <p>PostMessage: <a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei einem Problem auf 1 gesetzt, z. B. wenn das Zielfenster oder Steuerelement nicht vorhanden ist. Ansonsten wird es auf 0 gesetzt.</p>
      <p>SendMessage: <a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei einem Problem auf FAIL gesetzt. Ansonsten ist das numerische Ergebnis der Nachricht enthalten, das manchmal eine "Antwort" sein kann, je nach Beschaffenheit der Nachricht und dessen Zielfenster. Dieses Ergebnis ist ein Integer zwischen 0 und 4294967295. Falls das Ergebnis als vorzeichenbehafteter Integer vorgesehen ist, kann eine negative Zahl wie folgt offenbart werden:</p>
      <pre>Nachrichtenantwort := ErrorLevel &gt; 0x7FFFFFFF ? -(~ErrorLevel) - 1 : ErrorLevel</pre>
      <h3>Bemerkungen</h3>
      <p>Diese Befehle sollten mit Vorsicht verwendet werden, da das Senden einer Nachricht an das falsche Fenster (oder das Senden einer ung&uuml;ltigen Nachricht) zu unerwartetem Verhalten oder sogar zum Absturz der Zielanwendung f&uuml;hren kann. Das liegt daran, dass die meisten Anwendungen nicht dazu entworfen wurden sind, bestimmte Nachrichtenarten von externen Quellen zu erwarten.</p>
      <p>PostMessage setzt die Nachricht in die Warteschlange des Zielfensters. Es wartet nicht auf eine Best&auml;tigung oder Antwort. SendMessage hingegen wartet bis zu 5 Sekunden auf das Zielfenster, um die Nachricht verarbeiten zu k&ouml;nnen. Wird die Nachricht innerhalb dieser Zeitspanne nicht verarbeitet, wird der Befehl beendet und ErrorLevel auf FAIL gesetzt.</p>
      <p>Die Parameter <em>Nachricht</em>, <em>wParam</em> und <em>lParam</em> sollten Integer zwischen -2147483648 und 4294967295 (0xFFFFFFFF) sein. Wie bei allen Integer-Werten in AutoHotkey kennzeichnet das 0x-Pr&auml;fix einen Hex-Wert. Zum Beispiel ist 0xFF das gleiche wie 255.</p>
      <p>Ein String kann &uuml;ber <em>wParam</em> oder <em>lParam</em> gesendet werden, wenn die Adresse einer Variable angegeben wird. Im folgenden Beispiel wird daf&uuml;r der <a href="../Variables.htm#amp">Adressoperator (&amp;)</a> verwendet:</p>
      <pre>SendMessage, 0xC, 0, <strong>&amp;EigeneVar</strong>, ClassNN, Fenstertitel  <em>; 0XC ist WM_SETTEXT</em></pre>
      <p>Seit v1.0.43.06 wird ein String, der vom Empf&auml;nger in EigeneVar eingef&uuml;gt wurde, wahrscheinlich erkannt, ohne dass zus&auml;tzliche Schritte n&ouml;tig sind. Das funktioniert allerdings nur, wenn das erste Zeichen im Parameter ein Und-Zeichen (&amp;) ist. Zum Beispiel w&uuml;rde <code>5+&amp;EigeneVar</code> nicht funktionieren, aber <code>&amp;EigeneVar</code> oder <code>&amp;EigeneVar+5</code> w&uuml;rde funktionieren.</p>
      <p>Ein direkter/in Anf&uuml;hrungszeichen gesetzter String kann auch wie folgt gesendet werden (in diesem Fall sollte der &amp;-Operator weggelassen werden):</p>
      <pre>Run Notepad
WinWaitActive Unbenannt - Editor
SendMessage, 0xC, 0, <strong>"Neuer Editor-Titel"</strong>  <em>; 0XC ist WM_SETTEXT</em></pre>
      <p>Um eine Nachricht an alle Fenster im Betriebssystem zu senden, einschlie&szlig;lich versteckte oder deaktivierte Fenster, muss <code>ahk_id 0xFFFF</code> in <em>Fenstertitel</em> angegeben werden (0xFFFF ist HWND_BROADCAST). Diese Technik sollte nur f&uuml;r Nachrichten benutzt werden, die f&uuml;r die &Uuml;bertragung gedacht sind, wie z. B. das folgende Beispiel:</p>
      <pre>SendMessage, 0x1A,,,, ahk_id 0xFFFF  <em>; 0x1A ist WM_SETTINGCHANGE</em></pre>
      <p>Mit <a href="OnMessage.htm">OnMessage()</a> kann ein Script eine Nachricht empfangen.</p>
      <p>Um mehr dar&uuml;ber zu erfahren, wie diese Befehle verwendet werden, siehe <a href="../misc/SendMessage.htm">Tutorial zum Senden von Nachrichten</a>.</p>
      <p>Fenstertitel und -texte unterscheiden zwischen Gro&szlig;- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>
      <h3>Verwandte Befehle</h3>
      <p><a href="../misc/SendMessageList.htm">Nachrichtenliste</a>, <a href="../misc/SendMessage.htm">Tutorial zum Senden von Nachrichten</a>, <a href="OnMessage.htm">OnMessage()</a>, <a href="../misc/Winamp.htm">Winamp automatisieren</a>, <a href="DllCall.htm">DllCall</a>, <a href="ControlSend.htm">ControlSend</a>, <a href="WinMenuSelectItem.htm">WinMenuSelectItem</a></p>
      <h3 id="Examples">Beispiele</h3>
      <pre class="NoIndent">#o::  <em>; Hotkey Win+O, der den Monitor ausschaltet.</em>
Sleep 1000  <em>; Gibt dem Benutzer eine Chance, die Tasten loszulassen (falls durch Loslassen dieser Tasten der Monitor wieder aufgeweckt wird).
; Monitor ausschalten:</em>
SendMessage, 0x112, 0xF170, 2,, Program Manager  <em>; 0x112 ist WM_SYSCOMMAND, 0xF170 ist SC_MONITORPOWER.
; Beachtet oben, dass die 2 mit -1 ersetzt werden kann, um den Monitor einzuschalten,
; oder mit 1, um den Energiesparmodus des Monitors zu aktivieren.</em>
Return

<em>; Startet den ausgew&auml;hlten Bildschirmschoner des Benutzers:</em>
SendMessage, 0x112, 0xF140, 0,, Program Manager  <em>; 0x112 ist WM_SYSCOMMAND und 0xF140 ist SC_SCREENSAVE.</em>

<em>; Eine Zeile nach oben scrollen (bei einem Steuerelement mit vertikaler Bildlaufleiste):</em>
ControlGetFocus, Steuerelement, A
SendMessage, 0x115, 0, 0, %Steuerelement%, A

<em>; Eine Zeile nach unten scrollen:</em>
ControlGetFocus, Steuerelement, A
SendMessage, 0x115, 1, 0, %Steuerelement%, A

<em>; Schaltet die Tastaturbelegung/Sprache des aktiven Fensters auf Englisch:</em>
PostMessage, 0x50, 0, 0x4090409,, A  <em>; 0x50 ist WM_INPUTLANGCHANGEREQUEST.</em>

<em>; Dieses Beispiel fragt Winamp, welche Track-Nummer zurzeit aktiv ist:</em>
SetTitleMatchMode, 2
SendMessage, 1024, 0, 120, - Winamp
If ErrorLevel &lt;&gt; FAIL
{
    ErrorLevel++  <em>; Die Z&auml;hlung von Winamp beginnt bei "0", also um 1 erh&ouml;hen.</em>
    MsgBox, Track #%ErrorLevel% ist aktiv oder wird abgespielt.
}
<em>; Siehe <a href="../misc/Winamp.htm">Winamp automatisieren</a> f&uuml;r mehr Informationen.</em>

<em>; Um die Prozess-ID eines AHK-Scripts zu finden (eine Alternative zu "<a href="WinGet.htm">WinGet PID</a>"):</em>
SetTitleMatchMode, 2
DetectHiddenWindows, on
SendMessage, 0x44, 0x405, 0, , BeliebigesScript.ahk - AutoHotkey v
MsgBox %ErrorLevel% ist die Prozess-ID.</pre>
    </div>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>