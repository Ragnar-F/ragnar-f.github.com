<!DOCTYPE HTML>
<html>
<head>
<title>FileSelectFile</title>
<meta name="keywords" content="Befehl, Datei, Dialogfenster, Grafische Benutzeroberfläche">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>
<h1>FileSelectFile</h1>
<p>Zeigt ein Standard-Dialogfenster an, womit der Benutzer eine oder mehrere Dateien öffnen oder speichern kann.</p>
<pre class="Syntax">FileSelectFile, AusgabeVar [, Optionen, Wurzelverzeichnis\Dateiname, Anzeigetext, Filter]</pre>
<h3>Parameter</h3>
<table class="info">
  <tr>
    <td style="width: 15%;">AusgabeVar</td>
    <td style="width: 85%;">Name der Variable, in der ein oder mehrere ausgewählte Dateinamen gespeichert werden sollen. Sie ist leer, falls der Benutzer das Dialogfenster abgebrochen hat (weil er eine Datei nicht auswählen möchte). </td>
  </tr>
  <tr>
    <td>Optionen</td>
    <td>
    <p>Ist dieser Parameter nicht vorhanden, gilt standardmäßig 0. Das heißt, dass keine der unten genannten Option wirksam ist.</p>
    <p><strong>M</strong>: Mehrfachauswahl. Erlaubt dem Benutzer, mehrere Dateien per UMSCHALT+Linksklick, STRG+Linksklick oder anderweitig auszuwählen. Nach <strong>M</strong> kann optional eine der unten genannten Nummern erfolgen (zum Beispiel ist sowohl M als auch M1 gültig). Um einzelne Dateien zu extrahieren, siehe Beispiel unten.</p>
    <p><strong>S</strong>: Speichern. Bewirkt, dass anstelle von Öffnen die Schaltfläche Speichern im Dialogfenster angezeigt wird. Nach <strong>S</strong> kann optional eine der unten genannten Nummern (oder die Summe von mehreren Nummern) erfolgen (zum Beispiel ist sowohl S als auch S24 gültig).</p>
    <p>Die folgenden Nummern können auch dann verwendet werden, falls <strong>M</strong> und <strong>S</strong> fehlen. Um mehrere Optionen gleichzeitig zu aktivieren, müssen die Nummern addiert werden. Benötigt man beispielsweise 8 und 16, muss 24 angegeben werden.</p>
    <p><strong>1</strong>: Datei muss vorhanden sein <br><strong>2:</strong> Pfad muss vorhanden sein <br><strong>8:</strong> Nachfragen, ob eine neue Datei erstellt werden soll <br><strong>16:</strong> Nachfragen, ob die Datei überschrieben werden soll <br><strong>32</strong> <span class="ver">[v1.0.43.09+]:</span> Verknüpfungen (.lnk) werden wie sie sind ausgewählt, anstatt sie in ihre Ziele aufzulösen. Zudem verhindert diese Option, dass eine Ordner-Verknüpfung geöffnet werden kann.</p>
    <p>Verwendet man Option 16 ohne Option 8, enthält das Dialogfenster die Schaltfläche "Speichern", anstatt "Öffnen". Dieses Verhalten ist eine Eigenart von Windows.</p>
    </td>
  </tr>
  <tr>
    <td>Wurzelverzeichnis\Dateiname</td>
    <td>
    <p>Falls vorhanden, enthält dieser Parameter eine oder beide der folgenden Angaben:</p>
    <p><strong>Wurzelverzeichnis</strong>: Das Hauptverzeichnis (Start-), das sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis befindet, solange kein absoluter Pfad angegeben ist. Ist dieser Parameter leer oder nicht vorhanden, gilt standardmäßig das Startverzeichnis, welches vom Betriebssystem vorgegeben ist (in Windows NT/2k/XP oder höher ist es wahrscheinlich das Verzeichnis, das der Benutzer zuletzt per FileSelectFile ausgewählt hatte). Seit v1.0.43.10 kann auch ein <a href="../misc/CLSID-List.htm">CLSID</a>-Wert wie <code>::{20d04fe0-3aea-1069-a2d8-08002b30309d}</code> (d. h. Arbeitsplatz/Computer) angegeben werden. In diesem Fall sollte jedes Unterverzeichnis nach dem CLSID-Wert mit einem Backslash enden (ansonsten wird der Text nach dem letzten Backslash als Dateiname interpretiert).</p>
    <p><strong>Dateiname</strong>: Ein Dateiname, der standardmäßig im Eingabefeld des Dialogfensters angezeigt werden soll. Es wird nur der Dateiname angezeigt (ohne Pfad). Für die korrekte Darstellung des Dialogfensters muss sichergestellt werden, dass keine illegalen Zeichen vorhanden sind (wie /&lt;|:").</p>
    <p>Beispiele:</p>
    <pre><em>; Sowohl <i>Wurzelverzeichnis</i> als auch <i>Dateiname</i> vorhanden:</em>
C:\Eigene Bilder\Standard-Bildname.gif

<em>; Nur <i>Wurzelverzeichnis</i> vorhanden:</em>
C:\Eigene Bilder

<em>; Nur <i>Wurzelverzeichnis</i> vorhanden, und bezieht sich auf das aktuelle Arbeitsverzeichnis:</em>
Eigene Bilder

<em>; Nur <i>Dateiname</i> vorhanden (aber wenn "Eigene Datei" als Ordner existiert,
; wird es als <i>Wurzelverzeichnis</i> behandelt):</em>
Eigene Datei  </pre>
    </td>
  </tr>
  <tr>
    <td>Anzeigetext</td>
    <td>Text, der im Fenster angezeigt werden soll, um den Benutzer Instruktionen zu erteilen, was zutun ist. Ist dieser Parameter leer oder nicht vorhanden, gilt standardmäßig "Select File - %A_SCRIPTNAME%" (der Name des aktuellen Scripts).</td>
  </tr>
  <tr>
    <td>Filter</td>
    <td>
    <p>Kennzeichnet, welche Dateitypen im Dialogfenster angezeigt werden sollen.</p>
    <p>Beispiel: Dokumente (*.txt)<br>Beispiel: Audio (*.wav; *.mp2; *.mp3)</p>
    <p>Ist dieser Parameter nicht vorhanden, verwendet der Filter standardmäßig "Alle Dateien (*.*)". Zusätzlich kann im Menü "Dateitypen" die Option "Text-Dokumente (*.txt)" ausgewählt werden.</p>
    <p>Der Filter verwendet ansonsten den angegebenen String und ermöglicht außerdem die Auswahl der Option "Alle Dateien (*.*)" in der Dateitypen-Liste. Wenn mehr als eine Dateierweiterung in den Filter eingefügt werden soll, müssen diese mit Semikolons getrennt werden, wie es im unteren Beispiel gezeigt wird.</p>
    </td>
  </tr>
</table>
<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 1 gesetzt, wenn der Benutzer das Dialogfenster geschlossen hat, ohne eine Datei ausgewählt zu haben (z. B. durch Drücken der Schaltfläche "Abbrechen"), oder wenn das Betriebssystem sich weigert, das Dialogfenster anzuzeigen (selten). Ansonsten wird es auf 0 gesetzt.</p>
<h3>Bemerkungen</h3>
<p>Hat der Benutzer nichts ausgewählt (weil er Schaltfläche "Abbrechen" gedrückt hat), wird <em>AusgabeVar</em> leer gemacht.</p>
<p>Ist die Mehrfachauswahl nicht aktiv, wird <em>AusgabeVar</em> den vollständigen Pfad und Namen einer einzelnen Datei enthalten, die vom Benutzer ausgewählt worden ist.</p>
<p>Falls die M-Option (Mehrfachauswahl) aktiv ist, wird <em>AusgabeVar</em> eine Liste enthalten, bei der jeder Eintrag, außer dem letzten, mit einem Zeilenumbruchszeichen (`n) endet. Der erste Eintrag in der Liste ist der Pfad, der von allen ausgewählten Dateien verwendet wird (dieser Pfad endet nur mit einem Backslash, wenn es ein Hauptverzeichnis wie C:\ ist). Die anderen Einträge sind die ausgewählten Dateien (ohne Pfad). Zum Beispiel: </p>
<pre>C:\Eigene Dokumente\Neuer Ordner [dieser Pfad gilt für alle folgenden Dateien]
test1.txt [das sind nur die Dateinamen: keine Pfadangabe]
test2.txt
... etc.</pre>
      Das Beispiel ganz unten zeigt, wie diese Dateien einzeln extrahiert werden können.
      <p>Bei aktiver Mehrfachauswahl ist die Gesamtlänge aller ausgewählten Dateinamen auf 64 KB begrenzt. Das sollte ausreichen, um mehrere tausend Dateien speichern zu können. Bei Überschreitung des Maximalwertes wird <em>AusgabeVar</em> leer gemacht.</p>
<p>Ein GUI-Fenster kann per <code>Gui, <a href="Gui.htm#OwnDialogs">+OwnDialogs</a></code> ein modales Dateiauswahlfenster anzeigen. Ein modales Dialogfenster bewirkt, dass der Benutzer erst wieder mit dem GUI-Fenster interagieren kann, wenn das Dialogfenster geschlossen wird.</p>
<p>Bekannte Einschränkung: Ein <a href="SetTimer.htm">Timer</a>, der gestartet wird, während ein Dateiauswahlfenster angezeigt wird, zögert das Klicken des Benutzers im Fenster solange hinaus, bis dieser beendet wird. Wenn das umgangen werden soll, sollten Timer vermieden werden, deren Subroutinen eine lange Zeit zum Beenden brauchen, oder alle Timer angehalten werden, während das Dialogfenster angezeigt wird:</p>
<pre><a href="Thread.htm">Thread</a>, NoTimers
FileSelectFile, AusgabeVar
Thread, NoTimers, false</pre>
<p>Veraltete Option: Seit v1.0.25.06 ist die Mehrfachauswahl-Option "4" veraltet. Allerdings funktioniert diese Option aus Kompatibilitätsgründen mit älteren Scripts weiterhin wie vorgesehen. Das heißt: Wählt der Benutzer nur eine Datei aus, wird <em>AusgabeVar</em> deren kompletten Pfad und Namen enthalten, gefolgt von einem Zeilenumbruch (`n). Wählt der Benutzer mehr als eine Datei aus, gilt das Format von der oben genannten M-Option, außer dass der letzte Eintrag auch mit einem Zeilenumbruchszeichen (`n) endet.</p>
<h3>Verwandte Befehle</h3>
<p><a href="FileSelectFolder.htm">FileSelectFolder</a>, <a href="MsgBox.htm">MsgBox</a>, <a href="InputBox.htm">InputBox</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="Gui.htm">GUI</a>, <a href="../misc/CLSID-List.htm">CLSID-Liste</a>, <a href="LoopParse.htm">Parsing-Schleife</a>, <a href="SplitPath.htm">SplitPath</a></p>
<p>Das Betriebssystem bietet zudem Standard-Dialogfenster, die den Benutzer auffordern können, eine Farbe, eine Schriftart oder ein Icon auszuwählen. Diese Dialogfenster können per <a href="DllCall.htm">DllCall()</a> angezeigt werden, siehe dazu <a href="http://www.autohotkey.com/forum/topic17230.html">www.autohotkey.com/forum/topic17230.html</a>.</p>
<h3>Beispiele</h3>
<pre class="NoIndent">FileSelectFile, AusgewählteDatei, 3, , Datei öffnen, Text-Dokumente (*.txt; *.doc)
If AusgewählteDatei =
    MsgBox, Der Benutzer hat nichts ausgewählt.
Else
    MsgBox, Der Benutzer hat folgendes ausgewählt:`n%AusgewählteDatei%


<a href="../misc/CLSID-List.htm">CLSID</a>-Beispiel:
FileSelectFile, AusgabeVar,, ::{645ff040-5081-101b-9f08-00aa002f954e}  <em>; Papierkorb.</em>

<em>; Mehrfachauswahl-Beispiel:</em>
FileSelectFile, Dateien, M3  <em>; M3 = Mehrfachauswahl vorhandener Dateien.</em>
If Dateien =
{
    MsgBox, Der Benutzer hat die Schaltfläche "Abbrechen" betätigt.
    Return
}
Loop, parse, Dateien, `n
{
    If a_index = 1
        MsgBox, Die ausgewählten Dateien befinden sich alle in %A_LoopField%.
    Else
    {
        MsgBox, 4, , Die nächste Datei ist %A_LoopField%. Weiter?
        IfMsgBox, No, break
    }
}
Return</pre>
</body>
</html>
