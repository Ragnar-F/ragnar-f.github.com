<!DOCTYPE HTML>
<html>
<head>
<title>WinSet</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>WinSet</h1>

<p>Ermöglicht eine Vielzahl von Veränderungen des angegebenen Fensters, wie z. B. "immer im Vordergrund" und Transparenz.</p>

<pre class="Syntax">WinSet, Attribut, Wert [, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme]</pre>
<h3>Parameter</h3>
<dl>

  <dt>Attribut, Wert</dt>
  <dd><p>Siehe untere Liste.</p></dd>

  <dt>Fenstertitel</dt>
  <dd><p>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>In diesem Parameter kann ein Teilstring angegeben werden, der in einem Textelement des Zielfensters vorkommt (abrufbar mit Windows Spy). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>Attribut, Wert</h3>
<p><strong><a name="AlwaysOnTop" id="AlwaysOnTop"></a>AlwaysOnTop, [On|Off|Toggle]</strong>: Bewirkt, dass ein Fenster sich immer vor den anderen Fenstern befindet wird. Mit ON wird die Einstellung aktiviert, mit OFF deaktiviert oder mit TOGGLE jeweils auf dem entgegengesetzten Zustand gesetzt. Ist dieser Parameter nicht vorhanden, gilt standardmäßig TOGGLE. Anstelle von AlwaysOnTop kann das Wort Topmost verwendet werden.</p>
<p><strong>Bottom</strong>: Sendet das Fenster ans untere Ende des Stapels, so dass es unter allen anderen Fenstern liegt. Das Gleiche kann auch mit ALT+ESC erzeugt werden. Zum Beispiel: <code>WinSet, Bottom,, Fenstertitel</code>.</p>
<p><strong>Top</strong>: Sendet das Fenster ans obere Ende des Stapels, ohne es dabei direkt zu <a href="WinActivate.htm">aktivieren</a>. Allerdings bewirken die Standardeinstellungen des Systems, dass das Fenster in den meisten Fällen trotzdem aktiviert wird. Darüber hinaus wird dieser Befehl möglicherweise nicht funktionieren, wenn das Betriebssystem sich gegen Anwendungen schützt, die versuchen wollen, den Fokus vom Benutzer zu stehlen (das zum Beispiel abhängig davon ist, welches Fenster zurzeit aktiv ist und was der Benutzer gerade macht). Als mögliche Übergangslösung könnte die <a href="#AlwaysOnTop">AlwaysOnTop</a>-Eigenschaft des Fensters kurz aktiviert und dann wieder deaktiviert werden.</p>
<p><strong>Disable</strong> oder <strong>Enable</strong>: Deaktiviert oder aktiviert jeweils ein Fenster. Sobald ein Fenster deaktiviert ist, kann der Benutzer das Fenster weder verschieben noch mit dessen Steuerelementen interagieren. Außerdem werden deaktivierte Fenster in der Alt-Tab-Liste weggelassen.</p>
<p><strong><a name="Redraw"></a>Redraw</strong>: Versucht, die Darstellung/Inhalte eines Fensters zu aktualisieren, indem es dem Betriebssystem mitteilt, dass das Fensterrechteck eine Neuzeichnung benötigt. Falls diese Methode bei einem bestimmten Fenster nicht funktioniert, kann <a href="WinMove.htm">WinMove</a> ausprobiert werden. Wenn das auch nicht funktioniert, kann folgendes versucht werden:</p>
<pre><a href="WinHide.htm">WinHide</a>, Fenstertitel
<a href="WinShow.htm">WinShow</a>, Fenstertitel</pre>
<p><strong>Style, N</strong> <u>oder</u> <strong>ExStyle, N</strong>: Ändert jeweils den Style oder Extended Style eines Fensters. Wenn das erste Zeichen von <strong>N</strong> ein Plus- oder Minuszeichen ist, wird einer oder mehrere Styles in <strong>N</strong> jeweils hinzugefügt oder entfernt. Wenn das erste Zeichen von N ein Zirkumflex (^) ist, wird einer oder mehrere Styles jeweils auf den entgegengesetzten Zustand gesetzt. Wenn das erste Zeichen eine Ziffer ist, wird der Style des Fensters komplett mit <strong>N</strong> überschrieben.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt. Ein Fehler tritt auf, wenn das Zielfenster nicht gefunden wird oder der Style nicht angewendet werden darf.</p>
<p>Es ist möglicherweise notwendig, ein Fenster mit <code>WinSet Redraw</code> neu zu zeichnen (siehe unten), das Styles erhalten hat, die sichtbare Änderungen vornehmen. Die <a href="../misc/Styles.htm">Style-Tabelle</a> listet einige der häufig verwendeten Styles auf. Beispiele:</p>
<pre>WinSet, Style, -0xC00000, A  <em>; Entfernt die Titelleiste des aktiven Fensters (WS_CAPTION).</em>
WinSet, ExStyle, ^0x80, Fenstertitel  <em>; Schaltet das WS_EX_TOOLWINDOW-Attribut um, wodurch das Fenster zu/von der Alt-Tab-Liste hinzugefügt/entfernt wird.</em></pre>
<h3 id="region">WinSet, Region [, Optionen, Fenstertitel, ...]</h3>
<p>Bewirkt, dass die Form des Fensters zu einem Rechteck, Polygon oder Ellipse geändert wird. Ist der <em>Optionen</em>-Parameter nicht vorhanden, wird der originale/standardmäßige Anzeigebereich des Fensters wiederhergestellt. Ansonsten können eine oder mehrere der folgenden Optionen angegeben werden, jeweils durch Leerzeichen getrennt:</p>
<p><strong>Wn</strong>: Breite des Rechtecks oder der Ellipse. Zum Beispiel: <code>w200</code>.<br>
<strong>Hn</strong>: Höhe des Rechtecks oder der Ellipse. Zum Beispiel: <code>h300</code>.<br>
<strong>X-Y</strong>: Jeweils ein X-Y-Koordinatenpaar. Bei dem Beispiel <code>200-0</code> ist 200 die X-Koordinate und 0 die Y-Koordinate.<br>
<strong>E</strong>: Macht die Region zu einer Ellipse, anstatt zu einem Rechteck. Diese Option ist nur gültig, wenn <strong>W</strong> und <strong>H</strong> vorhanden sind.<br>
<strong>R[w-h]</strong>: Macht die Region zu einem Rechteck mit abgerundeten Ecken. Zum Beispiel bewirkt <code>R30-30</code> für jede Ecke eine 30x30 Ellipse. Ist <strong>w-h</strong> nicht vorhanden, wird 30-30 verwendet. <strong>R</strong> ist nur gültig, wenn <strong>W</strong> und <strong>H</strong> vorhanden sind.</p>
<p><strong>Rechteck oder Ellipse</strong>: Wenn die Optionen <strong>W</strong> und <strong>H</strong> vorhanden sind, wird der neue Anzeigebereich ein Rechteck, dessen linke obere Ecke vom ersten <strong>X-Y</strong>-Koordinatenpaar (und nur von diesem) bestimmt wird. Ist allerdings auch die <strong>E</strong>-Option vorhanden, wird der neue Anzeigebereich eine Ellipse sein, anstatt ein Rechteck. Zum Beispiel: <code>WinSet, Region, 50-0 W200 H250 E, Fenstertitel</code>.</p>
<p><strong>Polygon</strong>: Sind die Optionen <strong>W</strong> und <strong>H</strong> nicht vorhanden, wird der Anzeigebereich zu einem Polygon (Vieleck), bestehend aus mehreren <strong>X-Y</strong>-Koordinatenpaaren (jedes Koordinatenpaar ist ein Punkt innerhalb des Fensters, relativ zu dessen oberen linken Ecke). Wenn zum Beispiel 3 Koordinaten angegeben sind, wird der neue Anzeigebereich in den meisten Fällen ein Dreieck sein. Die Reihenfolge der Koordinaten zueinander spielt manchmal eine Rolle. Zusätzlich kann das Wort <strong>Wind</strong> in den <em>Optionen</em> angegeben werden, um die Kurvenmethode zur Bestimmung des Polygonbereichs zu verwenden.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt. Fehler treten auf, wenn: 1) das Zielfenster nicht vorhanden ist; 2) eine oder mehrere <em>Optionen</em> ungültig sind; 3) mehr als 2000 Koordinatenpaare angegeben sind; oder 4) die angegebene Region ungültig ist oder nicht auf das Zielfenster angewendet werden kann.</p>
<p>Weiter unten findet man Beispiele, die zeigen, wie dieser Befehl verwendet wird.</p>
<h3 id="trans">WinSet, Transparent, N, Fenstertitel</h3>
<p>Macht ein Fenster halbtransparent. Verwende für <em>N</em> eine Zahl zwischen 0 und 255, um die Transparenzstärke zu kennzeichnen: 0 macht das Fenster unsichtbar, 255 undurchsichtig. Mit dem Wort OFF kann die Transparenz eines Fensters komplett deaktiviert werden. Der Unterschied zu 255 ist, dass dadurch die Performance verbessert und die Systemressourcennutzung verringert werden kann.</p>
<p><a name="TransLimit"></a><strong>Bekannte Einschränkungen für Transparent und <a href="#TransColor">TransColor</a></strong>:</p>
<ul>
  <li>Diese Befehle haben keine Auswirkungen auf ein Fenster, dessen Titelleiste und die <a href="#AlwaysOnTop">AlwaysOnTop</a>-Eigenschaft fehlt. Bei <a href="Gui.htm">GUI-Fenster</a> kann dieses Problem behoben werden, indem die Titelleiste erst entfernt wird, nachdem das Fenster transparent gemacht wurde. Alternativ erlauben folgende Eigenschaften die Transparenz: <code><a href="Gui.htm#Options">Gui -Caption +ToolWindow</a></code>.</li>
  <li>Das Setzen von "Transparent" auf 255 anstatt auf OFF verhindert möglicherweise, dass Probleme beim Neuzeichnen auftreten, wie z. B. ein schwarzer Hintergrund. Falls das Fenster immer noch nicht korrekt gezeichnet wird, siehe <a href="#Redraw">Redraw</a> für eine mögliche Übergangslösung.</li>
  <li>Um eine bereits vorhandene Transparenzfarbe (<a href="#TransColor">TransColor</a>) eines Fensters zu ändern, ist es möglicherweise notwendig, die Transparenz zu deaktivieren, bevor die Änderung durchgeführt wird.</li>
</ul>
<p><strong>Tipp</strong>: Um die Taskleiste transparent zu machen, verwende <code>WinSet, Transparent, 150, ahk_class Shell_TrayWnd</code>. Das Startmenü kann wie folgt ebenso transparent gemacht werden:</p>
<pre>DetectHiddenWindows, on
WinSet, Transparent, 150, ahk_class BaseBar  <em>; Um auch die Untermenüs des Startmenüs transparent zu machen, füge das untere Script hinzu.</em></pre>
<p>Um alle oder bestimmte Menüs im gesamten System transparent zu machen, könnte ein Script wie folgt am Laufen gehalten werden. Beachte, dass obwohl so ein Script seine eigenen Menüs nicht transparent machen kann, Menüs von anderen Scripts transparent machen kann:</p>
<pre>#Persistent
SetTimer, WatchForMenu, 5
Return  <em>; Ende des automatischen Ausführungsbereichs.</em>

WatchForMenu:
DetectHiddenWindows, on  <em>; Damit können Menüs eher erkannt werden.</em>
IfWinExist, ahk_class #32768
    WinSet, Transparent, 150  <em>; Verwendet das gefundene Fenster von der darüberliegenden Zeile.</em>
Return</pre>
<h3 id="TransColor">WinSet, TransColor, Farbe [N], Fenstertitel</h3>
<p>Macht alle Pixel der ausgewählten Farbe innerhalb des Zielfensters unsichtbar, so dass der Inhalt hinter dem Fenster durchscheint. Ein Mausklick auf einen unsichtbaren Pixel wirkt sich auf den Inhalt dahinter aus. Ansonsten kann für <em>Farbe</em> ein Farbname oder RGB-Wert angegeben werden (siehe <a href="Progress.htm#colors">Farbtabelle</a> oder verwende <a href="PixelGetColor.htm">PixelGetColor</a> im RGB-Modus). Um zusätzlich einen sichtbaren Fensterbereich teilweise transparent zu machen, sollte ein Leerzeichen (kein Komma) gefolgt von der Transparenzstufe (0-255) angefügt werden. Zum Beispiel: <code>WinSet, TransColor, EEAA99 150, Fenstertitel</code>.</p>
<p>TransColor wird oft verwendet, um Bildschirmanzeigen (OSD) und andere visuelle Effekte zu erzeugen. Ein Beispiel dazu befindet sich <a href="Gui.htm#OSD">am Ende der GUI-Seite</a>.</p>
<p>Es ist möglich, das Wort OFF anzugeben, um die Transparenz eines Fensters komplett zu deaktivieren. Die folgenden Zeilen haben die gleiche Funktion:</p>
<pre>WinSet, Transparent, Off, Fenstertitel
WinSet, TransColor, Off, Fenstertitel</pre>
<p>Bekannte Einschränkungen: Siehe <a href="#TransLimit">obere</a> Liste.</p>
<h3>Bemerkungen</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird von diesem Befehl nicht geändert, wenn nicht anders angegeben.</p>
<p>Obwohl Transparenz in Windows 2000/XP oder höher unterstützt wird, können die Transparenzeinstellungen eines Fensters nur in Windows XP oder höher abgerufen werden (per <a href="WinGet.htm">WinGet</a>).</p>
<p>Die AlwaysOnTop-Eigenschaft eines <a href="SplashTextOn.htm">SplashText</a>-Fensters kann wie folgt aufgehoben werden:</p>
<pre>WinSet, AlwaysOnTop, Off, Mein Splash-Fenstertitel</pre>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>

<h3>Siehe auch</h3>
<p><a href="WinGet.htm">WinGet</a>, <a href="WinHide.htm">WinHide</a>, <a href="WinSetTitle.htm">WinSetTitle</a>, <a href="WinMove.htm">WinMove</a>, <a href="WinActivate.htm">WinActivate</a>, <a href="Control.htm">Control</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent">WinSet, Transparent, 200, Unbenannt - Editor <em>; Macht das Fenster ein wenig transparent.</em>
WinSet, TransColor, White, Unbenannt - Editor <em>; Macht alle weißen Pixel unsichtbar.</em>
WinSet, AlwaysOnTop, toggle, Rechner <em>; Schaltet den "Immer im Vordergrund"-Zustand des Rechners um.</em>

<em>; Längeres Beispiel:
; Hier sind einige Hotkeys, die den Effekt von "Transparent" und
; "TransColor" veranschaulichen.  HINWEIS: Drückt der Benutzer einen Hotkey, während sich der Mauszeiger
; über einen unsichtbar gemachten Pixel befindet, wird
; stattdessen das Fenster, das sich hinter dem Pixel befindet, berücksichtigt!  Außerdem wird WIN+G
; nur ab Windows XP funktionieren, weil das Abrufen von Transparenzeinstellungen
; in Windows 2000 nicht unterstützt wird:</em>

#t::  <em>; Drücke WIN+T, um die Farbe unter dem Mauszeiger unsichtbar zu machen.</em>
MouseGetPos, MausX, MausY, MausWin
PixelGetColor, MausRGB, %MausX%, %MausY%, RGB
<em>; Scheinbar ist es notwendig, zuerst jede vorhandene Transparenz zu deaktivieren:</em>
WinSet, TransColor, Off, ahk_id %MausWin%
WinSet, TransColor, %MausRGB% 220, ahk_id %MausWin%
Return

#o::  <em>; Drücke WIN+O, um die Transparenz des Fensters unter der Maus zu deaktivieren.</em>
MouseGetPos,,, MausWin
WinSet, TransColor, Off, ahk_id %MausWin%
Return

#g::  <em>; Drücke WIN+G, um die aktuellen Einstellungen des Fensters unter der Maus anzuzeigen.</em>
MouseGetPos,,, MausWin
WinGet, Transparent, Transparent, ahk_id %MausWin%
WinGet, TransColor, TransColor, ahk_id %MausWin%
ToolTip Durchsichtigkeit:`t%Transparent%`nTransparenzfarbe:`t%TransColor%
Return

<em>; Beispiele für "WinSet Region":</em>
WinSet, Region, 50-0 W200 H250, Fenstertitel <em>; Macht alle Fensterbereiche außerhalb dieses Rechtecks unsichtbar.</em>
WinSet, Region, 50-0 W200 H250 R40-40, Fenstertitel <em>; Das gleiche wie oben, aber mit abgerundeten Ecken.</em>
WinSet, Region, 50-0 W200 H250 E, Fenstertitel <em>; Eine Ellipse anstelle eines Rechtecks.</em>
WinSet, Region, 50-0 250-0 150-250, Fenstertitel <em>; Ein nach unten gerichtetes Dreieck.</em>
WinSet, Region,, Fenstertitel <em>; Stellt den originalen/standardmäßigen Anzeigebereich des Fensters wieder her.</em>

<em>; Hier ist eine Region mit einem komplexeren Bereich. Es erstellt ein durchsichtiges rechteckiges Loch innerhalb eines Fensters.
; Es sind zwei Rechtecke unten angegeben: ein Äußeres und ein Inneres.  Jedes Rechteck besteht aus 5 X/Y-Koordinatenpaaren, weil das erste Koordinatenpaar zum Schluss nochmal verwendet wird, um das Rechteck wieder zu schließen.</em>
WinSet, Region, 0-0 300-0 300-300 0-300 0-0   100-100 200-100 200-200 100-200 100-100, Fenstertitel</pre>

</body>
</html>
