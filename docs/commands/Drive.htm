<!DOCTYPE HTML>
<html>
<head>
<title>Drive</title>
<meta name="keywords" content="Befehl, Laufwerk">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <article>
    <h1>Drive</h1>
    <p>Öffnet/Schließt einen CD- oder DVD-Laufwerk oder ändert die Laufwerksbezeichnung.</p>
    <pre class="Syntax">Drive, Unterbefehl [, Laufwerk, Wert]</pre>
    <p>Die Parameter <i>Unterbefehl</i>, <i>Laufwerk</i> und <i>Wert</i> sind voneinander abhängig und können wie folgt verwendet werden.</p>
    <p><strong>Label, Laufwerk [, NeueBezeichnung]</strong>: Ändert die Bezeichnung des <em>Laufwerks</em> (sobald <em>NeueBezeichnung</em> weggelassen wird, ist das Laufwerk ohne Namen). Der Parameter <em>Laufwerk</em> enthält den Laufwerkbuchstaben, gefolgt von einem Doppelpunkt und einem optionalen Backslash (funktioniert auch mit Netzwerkpfaden und zugeordneten Laufwerken). Zum Beispiel: <code>Drive, Label, C:, Seagate200</code>.</p>
    <p>Die aktuelle Bezeichnung eines Laufwerks kann wie folgt abgerufen werden: <code><a href="DriveGet.htm">DriveGet</a>, AusgabeVar, Label, C:</code>.</p>
    <br>
    <p><strong>Lock, Laufwerk</strong>: Verhindert, dass ein Laufwerk ausgefahren werden kann. Zum Beispiel: <code>Drive, Lock, D:</code>. Die meisten bereits ausgefahrenen Laufwerke können nicht gesperrt werden. Die Sperrung eines offenen Laufwerks führt dazu, dass es erst gesperrt wird, wenn es wieder eingefahren ist. Dieser Befehl funktioniert nicht bei Laufwerken, die eine Sperrung nicht zulassen (meistens bei Read-Only-Laufwerken) oder in Windows 95/98/Me keine IDE-Laufwerke sind. Ein vom Script gesperrtes Laufwerk bleibt auch nach Beendigung des Scripts gesperrt, bis ein anderes Script oder Programm die Sperrung aufhebt oder das System neu gestartet wird. Wenn das angegebene Laufwerk nicht vorhanden ist oder die Sperrfunktion nicht unterstützt, wird ErrorLevel auf 1 gesetzt. Ansonsten auf 0.</p>
    <br>
    <p><strong>Unlock, Laufwerk</strong>: Bewirkt, dass die Sperrung aufgehoben wird. In Windows NT/2000/XP oder höher muss <em>Unlock</em> mehrmals ausgeführt werden, falls das Laufwerk mehrmals gesperrt wurde (zumindest bei einigen Laufwerken). Wurde zum Beispiel <code>Drive, Lock, D:</code> dreimal ausgeführt, muss dreimal <code>Drive, Unlock, D:</code> ausgeführt werden, um die Sperre wieder aufzuheben. Aufgrund dieser Gegebenheit und der Tatsache, dass nicht festgestellt werden kann, ob ein Laufwerk zurzeit gesperrt ist, ist es oft nützlich, den Sperrstatus in eine <a href="../Variables.htm">Variable</a> zu hinterlegen.</p>
    <br>
    <p><strong>Eject [, Laufwerk, 1]</strong>: Bewirkt, dass ein CD- oder DVD-Laufwerk aus- oder eingefahren wird (um andere Medien- oder Gerätetypen auszufahren, siehe unteres Beispiel, das DllCall verwendet).</p>
    <p>Ist <em>Laufwerk</em> nicht vorhanden, wird das Standard-CD/DVD-Laufwerk verwendet. Das Laufwerk wird ausgefahren, wenn der letzte Parameter weggelassen wird. Enthält dieser Parameter eine 1, wird das Laufwerk eingefahren. Zum Beispiel: <code>Drive, Eject, D:, 1</code>.</p>
    <p>Das Script wird erst fortgesetzt, wenn <em>Drive Eject</em> das Laufwerk erfolgreich aus- oder eingefahren hat. Falls das Laufwerk bereits in richtiger Position ist (geöffnet oder geschlossen), wird <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 0 gesetzt.</p>
    <p><em>Drive Eject</em> wird wahrscheinlich nicht funktionieren, wenn das Laufwerk sich im Netzwerk befindet oder kein CD/DVD-Laufwerk ist. In solchen oder ähnlichen Fällen wird <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
    <p>Es ist möglich, den vorherigen Status des Laufwerks zu ermitteln, wenn die Ausführungsdauer des Befehls gemessen wird. Der Hotkey im folgenden Beispiel schaltet das Laufwerk in den entgegengesetzten Zustand (öffnen oder schließen):</p>
    <pre>#c::
Drive, Eject
<em>; Falls der Befehl schnell ausgeführt wird, war das Laufwerk wahrscheinlich bereits offen.
; In diesem Fall soll das Laufwerk eingefahren werden:</em>
If A_TimeSinceThisHotkey &lt; 1000  <em>; Zeit je nach Bedarf anpassen.</em>
    Drive, Eject,, 1
Return</pre>
    <p>Um den Medienstatus eines CD- oder DVD-Laufwerks zu ermitteln (wird gerade abgespielt, angehalten, offen usw.), siehe <a href="DriveGet.htm">DriveGet</a>.</p>
    <h3>ErrorLevel</h3>
    <p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Für mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
    <p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt.</p>
    <h3>Bemerkungen</h3>
    <p>Das folgende Beispiel ist eine alternative Methode, um ungewöhnliche Medien-/Gerätetypen auszufahren:</p>
    <pre><em>; Passt den folgenden Laufwerksbuchstaben je nach Bedarf an (alle anderen Zeilen können ignoriert werden).</em>
Laufwerksbuchstabe = I:

hVolume := DllCall("CreateFile"
    , Str, "\\.\" . Laufwerksbuchstabe
    , UInt, 0x80000000 | 0x40000000  <em>; GENERIC_READ | GENERIC_WRITE</em>
    , UInt, 0x1 | 0x2  <em>; FILE_SHARE_READ | FILE_SHARE_WRITE</em>
    , UInt, 0
    , UInt, 0x3  <em>; OPEN_EXISTING</em>
    , UInt, 0, UInt, 0)
If hVolume &lt;&gt; -1
{
    DllCall("DeviceIoControl"
        , UInt, hVolume
        , UInt, 0x2D4808   <em>; IOCTL_STORAGE_EJECT_MEDIA</em>
        , UInt, 0, UInt, 0, UInt, 0, UInt, 0
        , UIntP, dwBytesReturned  <em>; Unbenutzt.</em>
        , UInt, 0)
    DllCall("CloseHandle", UInt, hVolume)
}</pre>
    <h3>Verwandte Befehle</h3>
    <p><a href="DriveGet.htm">DriveGet</a>, <a href="DriveSpaceFree.htm">DriveSpaceFree</a></p>
    <h3>Beispiel</h3>
    <pre class="NoIndent">Drive, Label, D:, BackupDrive
Drive, Eject,, 1 <em>; Bewirkt, dass das Standard-CD/DVD-Laufwerk eingefahren (geschlossen) wird.</em></pre>
  </article>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>