<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Drive</title>
<meta name="keywords" content="Befehl, Laufwerk">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28224374-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body>
<script src="../../NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
<script language="JavaScript1.2" type="text/javascript">WriteNavLink(2);</script>


<h1>Drive</h1>

<p>&Ouml;ffnet/Schlie&szlig;t einen CD- oder DVD-Laufwerk oder &auml;ndert die Laufwerksbezeichnung.</p>

<pre class="Syntax">Drive, Unterbefehl [, Laufwerk, Wert]</pre>
<p>Die Parameter <i>Unterbefehl</i>, <i>Laufwerk</i> und <i>Wert</i> sind voneinander abh&auml;ngig und k&ouml;nnen wie folgt verwendet werden.</p>
<p><strong>Label, Laufwerk [, NeueBezeichnung]</strong>: &Auml;ndert die Bezeichnung des <em>Laufwerks</em> (sobald <em>NeueBezeichnung</em> weggelassen wird, ist das Laufwerk ohne Namen). Der Parameter <em>Laufwerk</em> enth&auml;lt den Laufwerkbuchstaben, gefolgt von einem Doppelpunkt und einem optionalen Backslash (funktioniert auch mit Netzwerkpfaden und zugeordneten Laufwerken). Zum Beispiel: <code>Drive, Label, C:, Seagate200</code>.</p>
  <p>Die aktuelle Bezeichnung eines Laufwerks kann wie folgt abgerufen werden: <code><a href="DriveGet.htm">DriveGet</a>, Ausgabevariable, Label, C:</code>.</p>
<p><strong><br> Lock, Laufwerk</strong>: Verhindert, dass ein Laufwerk ausgefahren werden kann. Zum Beispiel: <code>Drive, Lock, D:</code>. Die meisten Laufwerke k&ouml;nnen nicht gesperrt werden, wenn sie bereits ausgefahren sind. Die Sperrung eines offenen Laufwerks f&uuml;hrt dazu, dass es erst gesperrt wird, wenn es wieder eingefahren ist . Dieser Befehl hat keine Auswirkung auf Laufwerke, die sich weder sperren lassen (meistens bei Read-Only-Laufwerken), noch Nicht-IDE-Laufwerke in Windows 95/98/Me sind. Wenn ein Laufwerk gesperrt und das verantwortliche Script beendet wird, bleibt das Laufwerk solange gesperrt, bis ein anderes Script oder Programm die Sperrung aufhebt oder das System neu gestartet wird. Wenn das angegebene Laufwerk nicht vorhanden ist oder die Sperrfunktion nicht unterst&uuml;tzt, wird ErrorLevel auf 1 gesetzt. Ansonsten auf 0.</p>
<p><br> <strong>Unlock, Laufwerk</strong>: Bewirkt, dass die Sperrung aufgehoben wird. In Windows NT/2000/XP oder h&ouml;her muss <em>Unlock</em> mehrmals ausgef&uuml;hrt werden, falls das Laufwerk mehrmals gesperrt wurde (zumindest bei einigen Laufwerken). Wurde zum Beispiel <code>Drive, Lock, D:</code> dreimal ausgef&uuml;hrt, dann ist dreimal <code>Drive, Unlock, D:</code> notwendig, um die Sperre wieder aufzuheben. Aus diesem Grund ist es ratsam, den Sperrstatus in eine <a href="../Variables.htm">Variable</a> zu hinterlegen, da nicht festgestellt werden kann, ob ein Laufwerk gerade gesperrt ist.</p>
<p><strong><br> Eject [, Laufwerk, 1]</strong>: Bewirkt, dass ein CD- oder DVD-Laufwerk aus- oder eingefahren wird (um andere Medien- oder Ger&auml;tetypen auszufahren, siehe unteres Beispiel, das DllCall verwendet).</p>
<p>Wenn <em>Laufwerk</em> weggelassen wird, wird das Standard-CD/DVD-Laufwerk verwendet. Wird der letzte Parameter weggelassen oder enth&auml;lt er eine 0, wird das Laufwerk ausgefahren. Enth&auml;lt dieser Parameter eine 1, wird das Laufwerk eingefahren. Zum Beispiel: <code>Drive, Eject, D:, 1</code>.</p>
<p>Das Script wird erst fortgesetzt, wenn <em>Drive Eject</em> das Laufwerk erfolgreich aus- oder eingefahren hat. Falls das Laufwerk bereits in richtiger Position ist (ge&ouml;ffnet oder geschlossen), wird <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 0 gesetzt.</p>
<p><em>Drive Eject</em> wird wahrscheinlich nicht funktionieren, wenn das Laufwerk sich im Netzwerk befindet oder kein CD/DVD-Laufwerk ist. In solchen oder &auml;hnlichen F&auml;llen wird <a href="../misc/ErrorLevel.htm">ErrorLevel</a> auf 1 gesetzt.</p>
<p>Es ist m&ouml;glich, den vorherigen Status des Laufwerks zu erkennen, wenn die Ausf&uuml;hrungszeit des Befehls gemessen wird. Der Hotkey im folgenden Beispiel schaltet das Laufwerk in den entgegengesetzten Zustand (&ouml;ffnen oder schlie&szlig;en):</p>
<pre>#c::
Drive, Eject
<em>; Falls der Befehl schnell ausgef&uuml;hrt wird, war das Laufwerk wahrscheinlich bereits offen.
; In diesem Fall soll das Laufwerk eingefahren werden:</em>
If A_TimeSinceThisHotkey &lt; 1000  <em>; Zeit je nach Bedarf anpassen.</em>
    Drive, Eject,, 1
Return</pre>
<p>Um den Medienstatus eines CD- oder DVD-Laufwerks zu ermitteln (wird gerade abgespielt, angehalten, offen usw.), siehe <a href="DriveGet.htm">DriveGet</a>.</p>
<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span> Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszul&ouml;sen. F&uuml;r mehr Informationen, siehe <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt.</p>
<h3>Bemerkungen</h3>
<p>Das folgende Beispiel ist eine alternative Methode, um ungew&ouml;hnliche Medien-/Ger&auml;tetypen auszufahren:</p>
<pre><em>; Passt den folgenden Laufwerksbuchstaben je nach Bedarf an (alle anderen Zeilen k&ouml;nnen ignoriert werden).</em>
Laufwerksbuchstabe = I:

hVolume := DllCall("CreateFile"
    , Str, "\\.\" . Laufwerksbuchstabe
    , UInt, 0x80000000 | 0x40000000  <em>; GENERIC_READ | GENERIC_WRITE</em>
    , UInt, 0x1 | 0x2  <em>; FILE_SHARE_READ | FILE_SHARE_WRITE</em>
    , UInt, 0
    , UInt, 0x3  <em>; OPEN_EXISTING</em>
    , UInt, 0, UInt, 0)
If hVolume &lt;&gt; -1
{
    DllCall("DeviceIoControl"
        , UInt, hVolume
        , UInt, 0x2D4808   <em>; IOCTL_STORAGE_EJECT_MEDIA</em>
        , UInt, 0, UInt, 0, UInt, 0, UInt, 0
        , UIntP, dwBytesReturned  <em>; Unbenutzt.</em>
        , UInt, 0)
    DllCall("CloseHandle", UInt, hVolume)
}</pre>
<h3>Verwandte Befehle</h3>
<p><a href="DriveGet.htm">DriveGet</a>, <a href="DriveSpaceFree.htm">DriveSpaceFree</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">Drive, Label, D:, BackupDrive
Drive, Eject,, 1 <em>; Bewirkt, dass das Standard-CD/DVD-Laufwerk eingefahren (geschlossen) wird.</em></pre>
</body></html>