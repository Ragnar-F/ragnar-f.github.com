<!DOCTYPE HTML>
<html>
<head>
<title>ComObjConnect()</title>
<meta name="keywords" content="Befehl, Funktion, COM, Objekt">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="../static/html5.js"></script>
<![endif]-->
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <div id="article">
    <h1>ComObjConnect() <span class="ver">[AHK_L 53+]</span></h1>
    <p>Verbindet die Ereignisquellen eines COM-Objekts mit Funktionen, die einen vorgegeben Pr&auml;fix enthalten.</p>
    <pre class="Syntax">ComObjConnect(ComObject [, Pr&auml;fix])</pre>
    <h3>Parameter</h3>
    <table class="info">
      <tr>
        <td>ComObject</td>
        <td>Ein Objekt, das Ereignisse ausl&ouml;st.</td>
      </tr>
      <tr>
        <td>Pr&auml;fix</td>
        <td><p>Ein Pr&auml;fix f&uuml;r den Ereignisnamen, um festzustellen, welche Funktion bei einem Ereignis aufgerufen werden soll.</p>
          <p>Ist dieser Parameter nicht vorhanden, wird das Objekt "getrennt"; das hei&szlig;t, dass das Script nicht l&auml;nger Benachrichtigungen von seinen Ereignissen erh&auml;lt.</p>
          <p><span class="ver">[v1.1.01+]:</span> Dieser Parameter kann ein Objekt sein, das vom Script definiert wurde. Beim Ausl&ouml;sen eines Ereignisses wird die entsprechende Methode aufgerufen. Der erste Parameter, der &uuml;blicherweise der versteckte <code>this</code>-Parameter ist, verweist auf das script-definierte Objekt, nicht auf das COM-Objekt. Mit einer <a href="../Objects.htm#Meta_Functions">__Call-Meta-Funktion</a> k&ouml;nnen alle Ereignisse abgefangen werden, ohne dass f&uuml;r jedes Ereignis eine Methode definiert werden muss.</p></td>
      </tr>
    </table>
    <h3 id="Usage">Verwendung</h3>
    <p>Zur effektiven Nutzung von ComObjConnect m&uuml;ssen zuerst Funktionen in das Script geschrieben werden, um relevante Ereignisse zu bearbeiten. Solche Funktionen, auch "Event-Handler" genannt, haben folgende Struktur:</p>
    <pre class="Syntax Short NoIndent"><i>Pr&auml;fix</i><b>Ereignisname</b>([<i>Parameter...</i>, ComObject])
{
    <i class="dull">... Ereignis-behandelnder Code ...</i>
    Return <i>R&uuml;ckgabewert</i>
}</pre>
    <p>F&uuml;r <i>Pr&auml;fix</i> kann ein beliebiger Pr&auml;fix angegeben werden, w&auml;hrend der <b>Ereignisname</b> der Name des Ereignisses ist, das von der Funktion behandelt werden soll.</p>
    <p><i>Parameter</i> entspricht den Parametern, die das Ereignis hat. Hat das Ereignis keine Parameter, sollte <i>Parameter</i> ganz weggelassen werden. <i>ComObject</i> ist optional und kann nur verwendet werden, wenn die korrekte Anzahl an <i>Parameter</i> definiert ist. Es enth&auml;lt einen Verweis auf das originale Wrapper-Objekt, das an ComObjConnect &uuml;bergeben wurde. "ComObject" sollte mit einem Namen ersetzt werden, der eher dem Kontext des Scripts entspricht.</p>
    <p>Beachte, dass die Event-Handler R&uuml;ckgabewerte haben k&ouml;nnen. Mit <a href="ComObjActive.htm#param">ComObjParameter</a> kann ein COM-spezifischer Wertetyp zur&uuml;ckgegeben werden, das auch als <code>ComObjRetVal(Typ, Wert)</code> oder einfach als <code>ComObj(Typ, Wert)</code> geschrieben werden kann.</p>
    <p>Mit <code>ComObjConnect(BeliebigesObjekt, "<i>Pr&auml;fix</i>")</code> kann die Ereignisbehandlung aktiviert werden.</p>
    <p>Mit <code>ComObjConnect(BeliebigesObjekt)</code> kann das Objekt getrennt werden (stoppt die Ereignisbehandlung).</p>
    <p>Ist die Anzahl der Parameter unbekannt, kann eine <a href="../Functions.htm#Variadic">variadische Funktion</a> verwendet werden.</p>
    <h3>Verwandte Befehle</h3>
    <p><a href="ComObjCreate.htm">ComObjCreate</a>, <a href="ComObjGet.htm">ComObjGet</a>, <a href="ComObjActive.htm">ComObjActive</a>, <a href="ComObjError.htm">ComObjError</a>, <a href="http://msdn.microsoft.com/en-us/library/ccxe1xe6.aspx">WScript.ConnectObject (MSDN)</a></p>
    <h3 id="Examples">Beispiele</h3>
    <pre class="NoIndent">
ie := ComObjCreate("<a href="http://msdn.microsoft.com/en-us/library/aa752084.aspx">InternetExplorer.Application</a>")

<em>; Verbindet Ereignisse mit entsprechenden Script-Funktionen, die den Pr&auml;fix "IE_" haben.</em>
<b>ComObjConnect</b>(ie, "IE_")

ie.Visible := true  <em>; Funktioniert bekanntlich nicht mit IE7.</em>
ie.Navigate("http://l.autohotkey.net/")
#Persistent

<b>IE_<a href="http://msdn.microsoft.com/en-us/library/aa768329.aspx">DocumentComplete</a></b>(ieEventParam, url, ieFinalParam) {
    global ie
    If (ie != ieEventParam)
        s .= <em>"Erster Parameter ist ein neues Wrapper-Objekt.`n"</em>
    If (ie == ieFinalParam)
        s .= <em>"Letzter Parameter ist das originale Wrapper-Objekt.`n"</em>
    If ((disp1:=<a href="ComObjActive.htm#enwrap">ComObjUnwrap</a>(ieEventParam)) == (disp2:=ComObjUnwrap(ieFinalParam)))
        s .= <em>"Beide Wrapper-Objekte verweisen auf die gleiche IDispatch-Instanz.`n"</em>
    <a href="ObjAddRef.htm">ObjRelease</a>(disp1), ObjRelease(disp2)
    MsgBox % s . "Das Laden von " ie.Document.title " @ " url " wurde abgeschlossen."
    ie.Quit()
    ExitApp
}

</pre>
  </div>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>