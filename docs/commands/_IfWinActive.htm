<!DOCTYPE HTML>
<html>
<head>
<title>#IfWinActive / #IfWinExist</title>
<meta name="keywords" content="Befehl, Direktive, Fenster, Hotkey, Hotstring">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<!--[if lt IE 9]>
<script src="../static/html5.js"></script>
<![endif]-->
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <div id="article">
      <h1>#IfWinActive / #IfWinExist</h1>
      <p>Erstellt kontextabh&auml;ngige <a href="../Hotkeys.htm">Hotkeys</a> und <a href="../Hotstrings.htm">Hotstrings</a>. Solche Hotkeys f&uuml;hren eine andere Aktion aus (oder gar keine), abh&auml;ngig vom Typ des aktiven oder vorhandenen Fensters.</p>
      <pre class="Syntax">#IfWinActive [, Fenstertitel, Fenstertext]
#IfWinExist [, Fenstertitel, Fenstertext]
#IfWinNotActive [, Fenstertitel, Fenstertext]
#IfWinNotExist [, Fenstertitel, Fenstertext]
<a href="_If.htm">#If [, Ausdruck]</a></pre>
      <h3>Parameter</h3>
      <table class="info">
        <tr>
          <td style="width: 15%;">Fenstertitel</td>
          <td style="width: 85%;"><p>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</p>
            <p>Das &Uuml;bereinstimmungsverhalten wird mit <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a> im <a href="../Scripts.htm#auto">automatischen Ausf&uuml;hrungsbereich</a> bestimmt.</p>
            <p>Wie bei den meisten anderen Direktiven werden Variablen nicht unterst&uuml;tzt. Obwohl <a href="../misc/WinTitle.htm#ahk_pid">ahk_pid</a> und <a href="../misc/WinTitle.htm#ahk_id">ahk_id</a> mit einem hartcodierten Prozess oder mit einer Fenster-ID verwendet werden k&ouml;nnen, ist es bei #IfWin &uuml;blicher, diese  indirekt per <a href="GroupAdd.htm">GroupAdd</a> oder <a href="Hotkey.htm">Hotkey IfWin</a> zu verwenden.</p></td>
        </tr>
        <tr>
          <td>Fenstertext</td>
          <td>In diesem Parameter kann ein Teilstring angegeben werden, der in einem Textelement des Zielfensters vorkommt (werden mit Windows Spy angezeigt). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</td>
        </tr>
        <tr>
          <td>Titelausnahme<br>
            Textausnahme</td>
          <td>Obwohl diese Parameter <strong>nicht</strong> unterst&uuml;tzt werden, k&ouml;nnen sie indirekt &uuml;ber <em>ahk_group EigeneGruppe</em> im <em>Fenstertitel</em> verwendet werden (hierbei ist <em>EigeneGruppe</em> eine Gruppe, die per <a href="GroupAdd.htm">GroupAdd</a> erstellt wurde, das Titel- und Textausnahme unterst&uuml;tzt).</td>
        </tr>
      </table>
      <h3>Grundlagen zur Bedienung</h3>
      <p>Mit #IfWin-Direktiven k&ouml;nnen auf einfache Weise kontextabh&auml;ngige <a href="../Hotkeys.htm">Hotkeys</a> und <a href="../Hotstrings.htm">Hotstrings</a> erstellt werden. Zum Beispiel:</p>
      <pre>#IfWinActive ahk_class Notepad
#space::MsgBox Du hast Win+Leerzeichen im Editor gedr&uuml;ckt.</pre>
      <p>Die #IfWin-Direktiven sind von der Position abh&auml;ngig: sie haben nur Einfluss auf Hotkeys und Hotstrings, die sich im Script physisch darunter befinden. Zudem schlie&szlig;en sie sich gegenseitig aus; das hei&szlig;t, dass nur die aktuellste Direktive wirksam sein wird.</p>
      <p>Um die Kontextabh&auml;ngigkeit zu deaktivieren, muss eine #IfWin-Direktive ohne Parameter angegeben werden. Zum Beispiel:</p>
      <pre>#IfWinActive</pre>
      <p>Falls #IfWin deaktiviert ist (oder nie in einem Script verwendet wird), gelten <a href="../Hotkeys.htm">Hotkeys</a> und <a href="../Hotstrings.htm">Hotstrings</a> f&uuml;r alle Fenster (sofern sie nicht per <a href="Suspend.htm">Suspend</a> oder <a href="Hotkey.htm">Hotkey</a> deaktiviert wurden).</p>
      <p>Ein Maus- oder Tastatur-Hotkey, der mittels #IfWin deaktiviert wurde, f&uuml;hrt seine urspr&uuml;ngliche Funktion aus; das hei&szlig;t, dass die Eingabe an das aktive Fenster gesendet wird, ohne dass die Hotkeys beachtet werden. Es gibt zwei Ausnahmen:</p>
      <ul>
        <li>Windows 95/98/Me: Das Dr&uuml;cken eines IfWin-deaktivierten Hotkeys wird nicht funktionieren (auch nicht dessen urspr&uuml;ngliche Funktion).</li>
        <li>Joystick-Hotkeys: obwohl #IfWin-Direktiven bei solchen Hotkeys funktionieren, kann nicht verhindert werden, dass andere Programme das Dr&uuml;cken einer Joystick-Taste erkennen.</li>
      </ul>
      <p>#IfWin kann auch dazu verwendet werden, das Verhalten einer gew&ouml;hnlichen Taste wie Enter oder Leertaste zu &auml;ndern. Das ist bei bestimmten Fenstern n&uuml;tzlich, die diese Taste ignorieren oder Aktionen ausf&uuml;hren, die unerw&uuml;nscht sind. Zum Beispiel:</p>
      <pre>#IfWinActive Erinnerung ahk_class #32770  <em>; Das Erinnerungsfenster in Outlook.</em>
Enter::Send !o  <em>; Bringt die Enter-Taste dazu, die markierte Erinnerung zu &ouml;ffnen, anstatt erneut daran zu erinnern.</em>
#IfWinActive</pre>
      <h3 id="variant">Hotkey-Varianten (-duplikate)</h3>
      <p>Es ist m&ouml;glich, dass ein bestimmter <a href="../Hotkeys.htm">Hotkey</a> oder <a href="../Hotstrings.htm">Hotstring</a> mehr als einmal im Script vorkommen kann, wenn denen verschiedene IfWin-Kriterien zugeordnet werden. Diese werden als <em>Hotkey-Varianten</em> bezeichnet. Zum Beispiel:</p>
      <pre>#IfWinActive ahk_class Notepad
^!c::MsgBox Du hast Strg+Alt+C im Editor gedr&uuml;ckt.
#IfWinActive ahk_class WordPadClass
^!c::MsgBox Du hast Strg+Alt+C in WordPad gedr&uuml;ckt.
#IfWinActive
^!c::MsgBox Du hast Strg+Alt+C in einem beliebigen Fenster gedr&uuml;ckt (au&szlig;er Editor/WordPad).</pre>
      <p>Bei mehreren zum Ausf&uuml;hren berechtige Varianten wird nur die Variante ausgef&uuml;hrt, die ganz oben im Script vorkommt. Ausgenommen davon ist die globale Variante (ohne #IfWin-Kriterien), da sie immer die niedrigste Priorit&auml;t hat. Das hei&szlig;t, dass sie nur ausgef&uuml;hrt wird, wenn keine andere Variante dazu berechtigt ist (diese Ausnahme gilt nicht f&uuml;r <a href="../Hotstrings.htm">Hotstrings</a>).</p>
      <p>Beim Erstellen von Hotkeyduplikaten spielt die Reihenfolge der <a href="../Hotkeys.htm#Symbols">Modifikatorzeichen</a> (z.B. ^!+#) keine Rolle. Zum Beispiel ist ^!c das gleiche wie !^c. Allerdings m&uuml;ssen die Tasten konsequent ausgeschrieben werden. Zum Beispiel ist <em>Esc</em> in diesem Fall nicht das gleiche wie <em>Escape</em> (auch wenn Gro&szlig;- und Kleinschreibung keine Rolle spielt). Au&szlig;erdem werden Hotkeys mit <a href="../Hotkeys.htm#wildcard">Platzhalter-Pr&auml;fix (*)</a> und Hotkeys ohne Platzhalter getrennt behandelt; zum Beispiel haben F1 und *F1 jeweils ihre eigenen Varianten.</p>
      <p>Damit eine Hotkey-Subroutine von mehreren Varianten ausgef&uuml;hrt wird, ist es am einfachsten, eine Reihe von identischen Hotkeys zu erstellen, die jeweils eine andere #IfWin-Direktive dar&uuml;ber haben. Zum Beispiel:</p>
      <pre>#IfWinActive ahk_class Notepad
#z::
#IfWinActive ahk_class WordPadClass
#z::
MsgBox Du hast Win+Z entweder im Editor oder in WordPad gedr&uuml;ckt.
Return</pre>
      <p>Alternativ kann eine <a href="GroupAdd.htm">Fenstergruppe</a> per <code>#IfWinActive ahk_group EigeneGruppe</code> verwendet werden.</p>
      <p>Um Hotkey-Varianten dynamisch zu erstellen (w&auml;hrend das Script ausgef&uuml;hrt wird), siehe <a href="Hotkey.htm#IfWin">"Hotkey IfWin"</a>.</p>
      <h3 id="gen">Allgemeine Bemerkungen</h3>
      <p>#IfWin kann gegebenenfalls auch die urspr&uuml;ngliche Funktion der Pr&auml;fixtasten wiederherstellen (eine <a href="../Hotkeys.htm#prefix">Pr&auml;fixtaste</a> ist zum Beispiel die Taste "a" bei einem Hotkey wie "a & b"). Dies geschieht immer dann, wenn kein einziger Hotkey f&uuml;r ein bestimmtes Pr&auml;fix vorhanden ist.</p>
      <p>Falls der Gosub- oder Goto-Befehl zum Anspringen von Hotkey- oder Hotstring-Labels verwendet wird, springt dieser zu der Variante, die ganz oben im Script vorkommt.</p>
      <p>Die Tastatur- oder Maustaste eines Hotkeys, der mit #IfWin deaktiviert wurde, erscheint in der Type-Spalte von <a href="KeyHistory.htm">KeyHistory</a> mit einem "#"-Zeichen. Das kann dabei helfen, ein Script zu debuggen.</p>
      <p>Variablenverweise wie %Var% werden zurzeit nicht unterst&uuml;tzt. Folglich m&uuml;ssen Prozentzeichen mit einem <a href="_EscapeChar.htm">Schutzzeichen</a> vorangestellt werden (`%), damit diese auch in Zukunft funktionieren. Im Vergleich dazu m&uuml;ssen direkte Kommas gesch&uuml;tzt werden (`,), um zu gew&auml;hrleisten, dass zus&auml;tzliche Parameter in Zukunft hinzugef&uuml;gt werden k&ouml;nnen. Um diese Einschr&auml;nkung zu umgehen, verwende <a href="GroupAdd.htm">GroupAdd</a> und <a href="../misc/WinTitle.htm#ahk_group">ahk_group</a>.</p>
      <p>Ein Label, dem ein Hotkey mit dem <a href="Hotkey.htm">Hotkey-Befehl</a> zugewiesen worden ist, wird von #IfWin  nicht direkt beeinflusst. Stattdessen wird das oberste #IfWin im Script (falls vorhanden) f&uuml;r alle Hotkeys wirksam, die mit dem Hotkey-Befehl erstellt wurden (sofern "<a href="Hotkey.htm#IfWin">Hotkey IfWin</a>" nicht verwendet wurde, um das zu &auml;ndern).</p>
      <p><a href="../Hotkeys.htm#alttab">Alt-Tab-Hotkeys</a> werden von #IfWin nicht beeinflusst: sie sind bei allen Fenstern wirksam.</p>
      <p>Das <a href="../misc/WinTitle.htm#LastFoundWindow">zuletzt gefundene Fenster</a> wird von #IfWinActive/Exist gesetzt (aber nicht von IfWin<em>Not</em>Active/<em>Not</em>Exist). Zum Beispiel:</p>
      <pre>#IfWinExist ahk_class Notepad
#n::WinActivate  <em>; Aktiviert das gefundene Fenster von #IfWin.</em></pre>
      <p>Es k&ouml;nnen die <a href="_EscapeChar.htm">Schutzsequenzen</a> `s und `t verwendet werden, wenn Leer-/Tabulatorzeichen am Anfang oder Ende eines #IfWin-Parameters ben&ouml;tigt werden.</p>
      <p>Aus Performancegr&uuml;nden &uuml;berwacht #IfWin nicht st&auml;ndig, ob das angegebene Fenster aktiviert oder vorhanden ist. Stattdessen wird die Direktive &uuml;bereinstimmende Fenster nur &uuml;berpr&uuml;fen, wenn der Benutzer ein Hotkey dr&uuml;ckt oder Hotstring eingibt. Falls kein &uuml;bereinstimmendes Fenster vorhanden ist, d&uuml;rfen Tastatureingaben oder Mausklicks des Benutzers unver&auml;ndert an das aktive Fenster &uuml;bergeben werden (au&szlig;er in Windows 95/98/Me).</p>
      <p>Windows 95/98/Me: Hat die erste Variante des Hotkeys ein $-Pr&auml;fix, k&ouml;nnen sich alle Varianten "selbst senden". Dadurch hat ein Hotkey die M&ouml;glichkeit, seine urspr&uuml;ngliche Funktion durchzuf&uuml;hren, anstatt &uuml;berhaupt nichts zu machen. Zum Beispiel:</p>
      <pre>$^a::Send ^a  <em>; Die erste Variante muss ein $-Pr&auml;fix haben, damit sie sich in Windows 9x "selbst senden" kann.</em>
#IfWinActive ahk_class Notepad
^a::MsgBox Du hast Strg+A gedr&uuml;ckt, w&auml;hrend der Editor aktiv war.</pre>
      <p>Fenstertitel und -texte unterscheiden zwischen Gro&szlig;- und Kleinschreibung. Versteckte Textelemente werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenText</a> im automatischen Ausf&uuml;hrungsbereich aktiviert ist (der oberste Bereich des Scripts).</p>
      <h3>Verwandte Befehle</h3>
      <p><a href="_If.htm">#If <i>Ausdruck</i></a>, <a href="Hotkey.htm">Hotkey-Befehl</a>, <a href="../Hotkeys.htm">Hotkeys</a>, <a href="../Hotstrings.htm">Hotstrings</a>, <a href="Suspend.htm">Suspend</a>, <a href="IfWinActive.htm">IfWinActive</a>, <a href="IfWinExist.htm">IfWinExist</a>, <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>, <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a></p>
      <h3>Beispiele</h3>
      <pre class="NoIndent">#IfWinActive ahk_class Notepad
^!a::MsgBox Du hast Strg+Alt+A gedr&uuml;ckt, w&auml;hrend der Editor aktiv war.  <em>; Dieser Hotkey wird nicht funktionieren, wenn er in einem anderen Fenster gedr&uuml;ckt wird.</em>
#c::MsgBox Du hast Win+C gedr&uuml;ckt, w&auml;hrend der Editor aktiv war.
::btw::Dieser Ersatztext f&uuml;r "btw" erscheint nur im Editor.
#IfWinActive
#c::MsgBox Du hast Win+C in einem Fenster gedr&uuml;ckt, das nicht der Editor war.</pre>
    </div>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>