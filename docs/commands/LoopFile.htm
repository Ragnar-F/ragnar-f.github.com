<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="robots" content="noindex">

<title>Loop (Dateien &amp; Ordner) (AutoHotkey 2)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="../css/default.css" rel="stylesheet" type="text/css">
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28224374-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body>
<script src="../../NavScript.js" language="JavaScript1.2" type="text/javascript"></script>
<script language="JavaScript1.2" type="text/javascript">WriteNavLink(2);</script>


<h1>Loop (Dateien &amp; Ordner)</h1>

<p>Ermittelt nacheinander die angegebenen Dateien oder Ordner.</p>

<pre class="Syntax">Loop, Files, Dateimuster [, Modus] </pre>
<h3>Parameter</h3>
<dl>
  
    <dt>Files</dt>
    <dd><p>Dieser Parameter muss das Wort FILES sein, das weder ein Ausdruck noch ein Variablenverweis sein kann.</p></dd>
  
    <dt>Dateimuster</dt>
    <dd><p>Der Name einer Datei, eines Ordners oder einer musterbasierten Suche wie C:\Temp\*.tmp. Das <em>Dateimuster</em> befindet sich im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis, solange kein absoluter Pfad angegeben ist.</p>
    <p>Sowohl Sternchen als auch Fragezeichen werden als Platzhalter unterst&uuml;tzt. Eine &Uuml;bereinstimmung erfolgt, wenn das Muster mit dem langen/normalen oder <a href="#LoopFileShortName">8.3-kurzen</a> Dateinamen &uuml;bereinstimmt.</p>
    <p>Wenn dieser Parameter eine Datei oder einen Ordner enth&auml;lt (also ohne Platzhalter) und <em>Rekursiv</em> auf 1 gesetzt ist, dann werden mehrere &Uuml;bereinstimmungen gefunden, sobald der angegebene Dateiname in mehreren Ordnern vorkommt.</p></dd>
 
    <dt>Modus</dt>
    <dd><p>Eins oder mehrere der folgenden Zeichen (unabh&auml;ngig von der Gro&szlig;- und Kleinschreibung), die durch Leer- oder Tabulatorzeichen getrennt werden k&ouml;nnen:</p>
    <p><strong>F</strong>: Ermittelt <em>Dateien</em>, die der musterbasierten Suche entsprechen. Das ist der Standardwert, wenn "D" nicht angegeben wird.<br> <strong>D</strong>: Ermittelt Ordner (<em>Verzeichnisse</em>), die der musterbasierten Suche entsprechen.<br> <strong>R</strong>: Unterordner werden rekursiv behandelt, damit die enthaltenen Dateien und Unterordner ermittelt werden, wenn sie mit dem <em>Dateimuster</em> &uuml;bereinstimmen. Alle Unterordner werden rekursiv behandelt, nicht nur solche, die mit dem <em>Dateimuster</em> &uuml;bereinstimmen.</p></dd>

</dl>

<h3>Besondere Variablen innerhalb einer dateilesenden Schleife</h3>
<p>Die folgenden Variablen gibt es innerhalb jeder dateilesenden Schleife. Wenn eine innere dateilesende Schleife durch eine &auml;u&szlig;ere dateilesende Schleife eingeschlossen ist, dann hat die Datei innerhalb der Schleife Vorrang.</p>
<table class="info">
  <tbody>
<tr>
    <td>A_LoopFileName</td>
    <td><a name="LoopFileName" id="LoopFileName"></a>Der Name der Datei oder des Ordners, welche(r) zurzeit abgerufen wird (ohne den Pfad).</td>
  </tr>
  <tr>
    <td><a name="LoopFileExt"></a>A_LoopFileExt</td>
    <td>Die Dateierweiterung (z. B. TXT, DOC oder EXE). Der Punkt (.) ist nicht inbegriffen.</td>
  </tr>
  <tr>
    <td>A_LoopFilePath</td>
    <td><a name="LoopFilePath"></a>Der Pfad und Name der Datei/des Ordners, welche(r) zurzeit abgerufen wird. Wenn der <em>Dateimuster</em> einen relativen anstelle eines absoluten Pfads enth&auml;lt, dann ist dieser Pfad hier auch relativ. Dar&uuml;ber hinaus sind kurze (8.3) Ordnernamen im <em>Dateimuster</em> immer noch kurz (siehe n&auml;chsten Punkt, um die lange Version zu erhalten). </td>
  </tr>
  <tr>
    <td>A_LoopFileFullPath</td>
    <td><a name="LoopFileFullPath"></a>Diese Variable unterscheidet sich von A_LoopFilePath wie folgt: 1) Es enth&auml;lt immer den absoluten/kompletten Pfad der Datei, selbst wenn das <em>Dateimuster</em> einen relativen Pfad enth&auml;lt; 2) Jeder kurze (8.3) Ordnername im <em>Dateimuster</em> wird in einem langen Namen umgewandelt; 3) Zeichen im <em>Dateimuster</em> werden in Gro&szlig;- oder Kleinbuchstaben umgewandelt, damit sie mit den Zeichen im Dateisystem &uuml;bereinstimmen. Das ist f&uuml;r die Umwandlung von Dateinamen (die beispielsweise mittels Befehlszeilenparameter an das Script &uuml;bergeben werden) in ihre exakte Pfadnamen n&uuml;tzlich, wie sie vom Explorer angezeigt werden.</td>
  </tr>
  <tr>
    <td>A_LoopFileShortPath</td>
    <td>
<p><a name="LoopFileShortPath"></a>Der kurze Pfad (8.3) und Name der/des aktuell abgerufenen Ordners/Datei. Zum Beispiel: C:\MYDOCU~1\ADDRES~1.txt. Wenn der <em>Dateimuster</em> allerdings einen relativen anstelle eines absoluten Pfads enth&auml;lt, dann ist dieser Pfad hier auch relativ.</p>
      <p>Um den kompletten 8.3-Pfad und Namen einer Datei oder eines Ordners abzurufen, verwendet folgenden Namen im <em>Dateimuster</em>:</p>
<pre>Loop, Files, C:\Eigene Dokumente\Addressliste.txt
    KurzerPfad := A_LoopFileShortPath</pre>
        <p>HINWEIS: Diese Variable ist <strong>leer</strong>, wenn die Datei keinen kurzen Namen hat, dass in Betriebssystemen passieren kann, die NtfsDisable8dot3NameCreation in der Registrierung aktiv haben. Sie ist auch leer, wenn das Dateimuster einen relativen Pfad enth&auml;lt und der Schleifenk&ouml;rper <a href="SetWorkingDir.htm">SetWorkingDir</a> verwendet, um vom eigentlichen Arbeitsverzeichnis der Schleife selbst weg zuschalten.</p></td>
  </tr>
  <tr>
    <td>A_LoopFileShortName</td>
    <td><a name="LoopFileShortName"></a>Der 8.3-Kurzname oder alternative Name der Datei. Wenn die Datei keinen Kurznamen hat (falls der lange Name k&uuml;rzer als der 8.3-Name ist oder die Kurznamengenerierung auf einem NTFS-Dateisystem deaktiviert ist), dann wird stattdessen <em>A_LoopFileName</em> abgerufen. </td>
  </tr>
  <tr>
    <td>A_LoopFileDir</td>
    <td><a name="LoopFileDir"></a>Der vollst&auml;ndige Pfad des Verzeichnisses, in der sich <em>A_LoopFileName</em> befindet. Wenn der <em>Dateimuster</em> allerdings einen relativen anstelle eines absoluten Pfads enth&auml;lt, dann ist dieser Pfad hier auch relativ. Ein Hauptverzeichnis wird keinen nachfolgenden Backslash enthalten. Zum Beispiel: C:</td>
  </tr>
  <tr>
    <td>A_LoopFileTimeModified</td>
    <td><a name="LoopFileTimeModified"></a>Wann die Datei bearbeitet wurde. <a href="FileSetTime.htm">YYYYMMDDHH24MISS</a>-Format.</td>
  </tr>
  <tr>
    <td>A_LoopFileTimeCreated</td>
    <td><a name="LoopFileTimeCreated"></a>Wann die Datei erstellt wurde. <a href="FileSetTime.htm">YYYYMMDDHH24MISS</a>-Format.</td>
  </tr>
  <tr>
    <td>A_LoopFileTimeAccessed</td>
    <td><a name="LoopFileTimeAccessed"></a>Wann die Datei aufgerufen wurde. <a href="FileSetTime.htm">YYYYMMDDHH24MISS</a>-Format.</td>
  </tr>
  <tr>
    <td>A_LoopFileAttrib</td>
    <td><a name="LoopFileAttrib"></a>Die <a href="FileGetAttrib.htm">Attribute</a> der Datei, welche zurzeit abgerufen wird.</td>
  </tr>
  <tr>
    <td>A_LoopFileSize</td>
    <td><a name="LoopFileSize"></a>Die Byte-Gr&ouml;&szlig;e der Datei, welche zurzeit abgerufen wird. Dateien gr&ouml;&szlig;er als 4 Gigabyte werden ebenfalls unterst&uuml;tzt.</td>
  </tr>
  <tr>
    <td>A_LoopFileSizeKB</td>
    <td><a name="LoopFileSizeKB"></a>Die KB-Gr&ouml;&szlig;e der Datei, welche zurzeit abgerufen wird, abgerundet auf dem n&auml;chsten Integer-Wert. </td>
  </tr>
  <tr>
    <td>A_LoopFileSizeMB</td>
    <td><a name="LoopFileSizeMB"></a>Die MB-Gr&ouml;&szlig;e der Datei, welche zurzeit abgerufen wird, abgerundet auf dem n&auml;chsten Integer-Wert. </td>
  </tr>
</tbody></table>
<h3>Bemerkungen</h3>
<p>Eine dateilesende Schleife ist n&uuml;tzlich, wenn der Benutzer eine Sammlung von Dateien und/oder Ordner bearbeiten will.</p>
<p>Alle &uuml;bereinstimmenden Dateien werden ermittelt, einschlie&szlig;lich versteckte Dateien. OS-Funktionen wie der DIR-Befehl lassen hingegen versteckte Dateien standardm&auml;&szlig;ig weg. Um die Bearbeitung von versteckten, schreibgesch&uuml;tzten und/oder System-Dateien zu vermeiden, verwendet beispielsweise Folgendes in der Schleife:</p>
<pre>If A_LoopFileAttrib contains H,R,S  <em>; Jede Datei &uuml;berspringen, die H (versteckt), R (schreibgesch&uuml;tzt) oder S (vom System) ist. Hinweis: Keine Leerzeichen in "H,R,S".</em>
    continue  <em>; Diese Datei &uuml;berspringen und zur N&auml;chsten gehen</em></pre>
<p>Um die relativen anstelle der absoluten Pfade von Dateien w&auml;hrend einer rekursiven Suche zu ermitteln, &auml;ndert mit <a href="SetWorkingDir.htm">SetWorkingDir</a> den Grundordner vor der Schleife und lasst dann den Pfad in der Schleife weg (z. B. Loop, *.*, 0, 1). Dadurch enth&auml;lt <a href="#LoopFilePath">A_LoopFilePath</a> den relativen Pfad im Grundordner der Datei.</p>
<p>Eine dateilesende Schleife kann sich selbst unterbrechen, wenn sie Dateien oder Ordner innerhalb der eigenen Zust&auml;ndigkeit erstellt oder umbenennt. Wenn sie zum Beispiel Dateien mittels <a href="FileMove.htm">FileMove</a> umbenennt, dann wird jede dieser Datei zweimal gefunden: einmal mit dem alten Namen und nochmal mit dem neuen Namen. Als &Uuml;bergangsl&ouml;sung sollten die Dateien nur umbenannt werden, nachdem eine Liste von ihnen erstellt wurde. Zum Beispiel:</p>
<pre>Dateiliste := ""
Loop Files, *.jpg
   Dateiliste .= A_LoopFileName "`n"
Loop Parse, %Dateiliste%, `n
   FileMove, %A_LoopField%, unbenannt_%A_LoopField%</pre>
<p>Dateien in einem NTFS-Dateisystem werden wahrscheinlich immer in alphabetischer Reihenfolge abgerufen. Dateien in anderen Dateisystemen werden in keiner bestimmten Reihenfolge abgerufen. Um eine bestimmte Reihenfolge sicherzustellen, verwendet den Befehl <a href="Sort.htm">Sort</a>, wie unten im Abschnitt "Beispiele" gezeigt.</p>
<p>Dateien und Ordner mit einem kompletten Pfad l&auml;nger als 259 Zeichen werden ignoriert, als w&uuml;rde sie nicht existieren. Solche Dateien sind selten, weil normalerweise das Betriebssystem das Erstellen solcher Dateien verbietet.</p>
<p>Siehe <a href="Loop.htm">Loop</a> f&uuml;r Informationen &uuml;ber <a href="Block.htm">Blocks</a>, <a href="Break.htm">Break</a>, <a href="Continue.htm">Continue</a> und A_Index (die gibt es in jeder Schleifenvariante).</p>
<h3>Verwandte Befehle</h3>
<p><a href="Loop.htm">Loop</a>, <a href="Break.htm">Break</a>, <a href="Continue.htm">Continue</a>, <a href="Block.htm">Blocks</a>, <a href="SplitPath.htm">SplitPath</a>, <a href="FileSetAttrib.htm">FileSetAttrib</a>, <a href="FileSetTime.htm">FileSetTime</a></p>
<h3>Beispiele</h3>
<pre class="NoIndent"><em>; Beispiel #1:</em>
Loop, Files, %A_ProgramFiles%\*.txt, R  <em>; Rekursiv in Unterordner.</em>
{
    MsgBox, 4, , Dateiname = %A_LoopFilePath%`n`nFortfahren?
    If A_MsgBoxResult = "No"
        break
}</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; Beispiel #2: Berechnet die Gr&ouml;&szlig;e des Ordners, einschlie&szlig;lich seine Dateien und Unterordner:</em>
OrdnerGr&ouml;&szlig;eKB := 0
FileSelectFolder, Ordner  <em>; Fordert den Benutzer auf, einen Ordner auszuw&auml;hlen.</em>
Loop, Files, %Ordner%\*.*, R
    OrdnerGr&ouml;&szlig;eKB += A_LoopFileSizeKB
MsgBox Der Ordner %Ordner% hat eine Gr&ouml;&szlig;e von %OrdnerGr&ouml;&szlig;eKB% KB.</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; Beispiel #3: Ruft Dateinamen ab, die nach Namen sortiert sind (siehe n&auml;chstes Beispiel, um nach Datum zu sortieren):</em>
Dateiliste := ""  <em>; Leere Variable initialisieren.</em>
Loop, Files, C:\*.*
    Dateiliste .= A_LoopFileName "`n"
Sort, Dateiliste, %Dateiliste%, R  <em>; Die R-Option sortiert in umgekehrter Richtung. Siehe <a href="Sort.htm">Sort</a> f&uuml;r andere Optionen.</em>
Loop, Parse, %Dateiliste%, `n
{
    If A_LoopField = ""  <em>; Ignoriert das leere Element am Ende der Liste.</em>
        continue
    MsgBox, 4,, Dateinummer %A_Index% ist %A_LoopField%.  Weiter?
    If A_MsgBoxResult = "No"
        break
}</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; Beispiel #4: Ruft Dateinamen ab, die nach Erstellungsdatum sortiert sind:</em>
Dateiliste := ""
Loop, Files, %A_MyDocuments%\Fotos\*.*, FD  <em>; einschlie&szlig;lich Dateien und Verzeichnisse.</em>
    Dateiliste .= A_LoopFileTimeModified "`t" A_LoopFileName "`n"
Sort, Dateiliste, %Dateiliste%  <em>; Nach Datum sortieren.</em>
Loop, Parse, %Dateiliste%, `n
{
    If A_LoopField = ""  <em>; L&auml;sst das letzte LF-Zeichen (leeres Element) am Ende der Liste weg.</em>
        continue
    Dateielement := StrSplit(A_LoopField, A_Tab)  <em>; In zwei Teile aufteilen.</em>
    MsgBox, 4,, % "Die n&auml;chste Datei ist (modifiziert am " Dateielement[1] "):`n" Dateielement[2] "`n`nWeiter?"
    If A_MsgBoxResult = "No"
        break
}</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; Beispiel #5: Kopiert nur Quelldateien ins Ziel, die neuer als ihr Gegenst&uuml;ck sind:</em>
KopierenWennNeuer:
<em>; Die Variablen KopieQuellmuster und KopieZiel wurden vorher gesetzt.</em>
Loop, Files, %KopieQuellmuster%
{
    kopieren := false
    If !FileExist(KopieZiel "\ "A_LoopFileName)  <em>; Immer kopieren, wenn die Zieldatei noch nicht existiert.</em>
        kopieren := true
    Else
    {
        FileGetTime, Zeitstempel, %KopieZiel%\%A_LoopFileName%
        Zeitstempel := DateDiff(A_Now, A_LoopFileTimeModified, "Seconds")  <em>; Subtrahiert die Zeit der Quelldatei mit der Zeit der Zieldatei.</em>
        If Zeitstempel &lt; 0  <em>; Quelldatei ist neuer als Zieldatei.</em>
            kopieren := true
    }
    If kopieren
    {
        FileCopy, %A_LoopFilePath%, %KopieZiel%\%A_LoopFileName%, 1   <em>; Kopieren und &uuml;berschreiben.</em>
        If ErrorLevel
            MsgBox, "%A_LoopFilePath%" konnte nicht nach "%KopieZiel%\%A_LoopFileName%" kopiert werden.
    }
}
Return</pre>
<p>&nbsp;</p>
<pre class="NoIndent"><em>; Beispiel #6: Konvertiert Dateinamen, die mittels Kommandozeilen-Parameter &uuml;bergeben wurden, in lange Namen,
; vervollst&auml;ndigt den Pfad und korrigiert die Gro&szlig;- und Kleinbuchstaben, wie sie im Dateisystem gespeichert sind.</em>
Loop Args.MaxIndex()  <em>; F&uuml;r jeden Parameter (oder Datei, die auf ein Script abgelegt wurde).</em>
{
    Pfadangabe := Args[A_Index]
    Loop Files, %Pfadangabe%, FD  <em>; einschlie&szlig;lich Dateien und Verzeichnisse.</em>
        LangerPfad := A_LoopFileLongPath
    MsgBox Der zeichengenaue lange Pfadname der Datei `n%Pfadangabe%`n ist:`n%LangerPfad%
}</pre>
</body></html>