<!DOCTYPE HTML>
<html>
<head>
<title>Joystick als Maus verwenden</title>
<meta name="keywords" content="Script">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<link href="../static/font.css" rel="stylesheet" type="text/css" />
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../navbar/NavScript.js" type="text/javascript"></script>
</head>
<body>
<script type="text/javascript">WriteHeader(1);</script>
<div id="content">
  <section>
    <article>
    <h1>Joystick als Maus verwenden</h1>
    <p>Dieses Script wandelt einen Joystick in eine Maus mit drei Tasten um.  Dadurch verhält sich jede Joystick-Taste wie eine Maustaste und verbraucht kaum CPU-Zeit. Außerdem ist die Zeigergeschwindigkeit abhängig davon, wie weit der Joystick vom Zentrum gedrückt wird. Verschiedene Einstellungen können auch im oberen Bereich des Scripts angepasst werden. </p>
    <p><a href="JoystickMouse.ahk">Dieses Script herunterladen</a> &nbsp;| &nbsp;<a href="index.htm">Andere Beispiel-Scripts</a> &nbsp;| &nbsp;<a href="../index.htm">Home</a></p>
    <pre class="NoIndent"><em>; Den folgenden Wert erhöhen, damit der Mauszeiger sich schneller bewegt:</em>
JoyMultiplier = 0.30

<em>; Den folgenden Wert verringern, damit weniger Weg vom Zentrum benötigt wird,
; um die Maus zu bewegen.  Allerdings muss möglicherweise erst der aktuelle Joystick kalibriert werden,
; damit er richtig zentriert ist, um einen Drift des Mauszeigers zu verhindern. Ein absolut straffer
; und zentrierter Joystick kann eine 1 verwenden:</em>
JoyThreshold = 3

<em>; Für die Invertierung der Y-Achsen kann die folgende Variable auf True gesetzt werden, wodurch
; die sich Maus vertikal in die entgegengesetzte Richtung des Sticks bewegt:</em>
InvertYAxis := false

<em>; Diese Werte können geändert werden, um beliebige Joystick-Tastennummern für
; die linke, rechte und mittlere Maustaste zu verwenden.  Zahlen von 1 bis 32 sind verfügbar.
; Verwendet das Joystick-Test-Script, um die aktuellen Joystick-Nummern einfach herauszufinden.</em>
ButtonLeft = 1
ButtonRight = 2
ButtonMiddle = 3

<em>; Falls der aktuelle Joystick einen Rundblickschalter (POV) hat, dann kann dieser als Mausrad verwendet werden.  Der
; folgende Wert ist die Anzahl der Millisekunden zwischen den Drehungen des Rades.
; Wird der Wert verringert, dreht sich das Rad schneller:</em>
WheelDelay = 250

<em>; Falls mehr als ein Joystick vorhanden ist, erhöht diesen Wert, um einen beliebigen Joystick
; zu verwenden:</em>
JoystickNumber = 1

<em>; ENDE DES KONFIGURATIONSBEREICHS -- Hier danach keine Änderungen durchführen,
; es sei denn, die allgemeine Funktionalität des Scripts soll geändert werden.</em>

#SingleInstance

JoystickPrefix = %JoystickNumber%Joy
Hotkey, %JoystickPrefix%%ButtonLeft%, ButtonLeft
Hotkey, %JoystickPrefix%%ButtonRight%, ButtonRight
Hotkey, %JoystickPrefix%%ButtonMiddle%, ButtonMiddle

<em>; Benötigte Achsenabstände berechnen, um den Mauszeiger bewegen zu können:</em>
JoyThresholdUpper := 50 + JoyThreshold
JoyThresholdLower := 50 - JoyThreshold
if InvertYAxis
    YAxisMultiplier = -1
else
    YAxisMultiplier = 1

SetTimer, WatchJoystick, 10  <em>; Joystick-Bewegung überwachen.</em>

GetKeyState, JoyInfo, %JoystickNumber%JoyInfo
IfInString, JoyInfo, P  <em>; Joystick hat einen Rundblickschalter (POV), also als Mausrad verwenden.</em>
    SetTimer, MouseWheel, %WheelDelay%

return  <em>; Ende des automatischen Ausführungsbereichs.</em>


<em>; Die unteren Subroutinen verwenden nicht KeyWait, weil ansonsten der
; WatchJoystick-Quasi-Thread unter dem Warten-auf-Tastendruck-Thread eingefangen wird,
; wodurch das Maus-Ziehen mit dem Joystick unterdrückt wird.</em>

ButtonLeft:
SetMouseDelay, -1  <em>; Flüssigerer Bewegungsablauf.</em>
MouseClick, left,,, 1, 0, D  <em>; Hält die linke Maustaste gedrückt.</em>
SetTimer, WaitForLeftButtonUp, 10
return

ButtonRight:
SetMouseDelay, -1  <em>; Flüssigerer Bewegungsablauf.</em>
MouseClick, right,,, 1, 0, D  <em>; Hält die rechte Maustaste gedrückt.</em>
SetTimer, WaitForRightButtonUp, 10
return

ButtonMiddle:
SetMouseDelay, -1  <em>; Flüssigerer Bewegungsablauf.</em>
MouseClick, middle,,, 1, 0, D  <em>; Hält die mittlere Maustaste gedrückt.</em>
SetTimer, WaitForMiddleButtonUp, 10
return

WaitForLeftButtonUp:
if GetKeyState(JoystickPrefix . ButtonLeft)
    return  <em>; Falls die Taste weiterhin gedrückt gehalten wird, warten.
; Ansonsten wurde die Taste losgelassen.</em>
SetTimer, WaitForLeftButtonUp, off
SetMouseDelay, -1  <em>; Flüssigerer Bewegungsablauf.</em>
MouseClick, left,,, 1, 0, U  <em>; Lässt die Maustaste los.</em>
return

WaitForRightButtonUp:
if GetKeyState(JoystickPrefix . ButtonRight)
    return  <em>; Falls die Taste weiterhin gedrückt gehalten wird, warten.
; Ansonsten wurde die Taste losgelassen.</em>
SetTimer, WaitForRightButtonUp, off
MouseClick, right,,, 1, 0, U  <em>; Lässt die Maustaste los.</em>
return

WaitForMiddleButtonUp:
if GetKeyState(JoystickPrefix . ButtonMiddle)
    return  <em>; Falls die Taste weiterhin gedrückt gehalten wird, warten.
; Ansonsten wurde die Taste losgelassen.</em>
SetTimer, WaitForMiddleButtonUp, off
MouseClick, middle,,, 1, 0, U  <em>; Lässt die Maustaste los.</em>
return

WatchJoystick:
MouseNeedsToBeMoved := false  <em>; Standardwert setzen.</em>
SetFormat, float, 03
GetKeyState, joyx, %JoystickNumber%JoyX
GetKeyState, joyy, %JoystickNumber%JoyY
if joyx > %JoyThresholdUpper%
{
    MouseNeedsToBeMoved := true
    DeltaX := joyx - JoyThresholdUpper
}
else if joyx &lt; %JoyThresholdLower%
{
    MouseNeedsToBeMoved := true
    DeltaX := joyx - JoyThresholdLower
}
else
    DeltaX = 0
if joyy > %JoyThresholdUpper%
{
    MouseNeedsToBeMoved := true
    DeltaY := joyy - JoyThresholdUpper
}
else if joyy &lt; %JoyThresholdLower%
{
    MouseNeedsToBeMoved := true
    DeltaY := joyy - JoyThresholdLower
}
else
    DeltaY = 0
if MouseNeedsToBeMoved
{
    SetMouseDelay, -1  <em>; Flüssigerer Bewegungsablauf.</em>
    MouseMove, DeltaX * JoyMultiplier, DeltaY * JoyMultiplier * YAxisMultiplier, 0, R
}
return

MouseWheel:
GetKeyState, JoyPOV, %JoystickNumber%JoyPOV
if JoyPOV = -1  <em>; Kein Winkel.</em>
    return
if (JoyPOV > 31500 or JoyPOV &lt; 4500)  <em>; Nach vorne</em>
    Send {WheelUp}
else if JoyPOV between 13500 and 22500  <em>; Nach hinten</em>
    Send {WheelDown}
return

</pre>
  </article>
  </section>
</div>
<script type="text/javascript">WriteFooter(1);</script>
</body>
</html>